
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sparknlp_jsl.annotator &#8212; Spark NLP 3.3.0 documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../static/css/custom.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../../" id="documentation_options" src="../../static/documentation_options.js"></script>
    <script src="../../static/jquery.js"></script>
    <script src="../../static/underscore.js"></script>
    <script src="../../static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../static/doctools.js"></script>
    <script src="../../static/toggleprompt.js"></script>
    <link rel="shortcut icon" href="../../static/fav.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    <img src="../../static/logo.png" class="logo__image only-light" alt="Logo image">
    <img src="../../static/logo.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../getting_started/index.html">
  Getting Started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../reference/index.html">
  API Reference
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <h1>Source code for sparknlp_jsl.annotator</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Module containing all available Annotators of Spark NLP Healthcare and their baseclasses.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sparknlp.annotator</span>
<span class="kn">from</span> <span class="nn">sparknlp.annotator</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sparknlp.internal</span> <span class="kn">import</span> <span class="n">ExtendedJavaWrapper</span>
<span class="kn">from</span> <span class="nn">pyspark.ml</span> <span class="kn">import</span> <span class="n">Estimator</span><span class="p">,</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">pyspark.ml.util</span> <span class="kn">import</span> <span class="n">DefaultParamsWritable</span><span class="p">,</span> <span class="n">DefaultParamsReadable</span>
<span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">functions</span> <span class="k">as</span> <span class="n">F</span>

<span class="c1"># Do NOT delete. Looks redundant but this is key work around for python 2 support.</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">sparknlp.base</span> <span class="kn">import</span> <span class="n">DocumentAssembler</span><span class="p">,</span> <span class="n">Finisher</span><span class="p">,</span> <span class="n">TokenAssembler</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">com.johnsnowlabs.nlp</span>

<span class="n">sparknlp</span><span class="o">.</span><span class="n">annotator</span><span class="o">.</span><span class="n">assertion</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">sparknlp</span><span class="o">.</span><span class="n">annotator</span><span class="o">.</span><span class="n">assertion</span><span class="o">.</span><span class="n">dl</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">sparknlp</span><span class="o">.</span><span class="n">annotator</span><span class="o">.</span><span class="n">assertion</span><span class="o">.</span><span class="n">logreg</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">sparknlp</span><span class="o">.</span><span class="n">annotator</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">sparknlp</span><span class="o">.</span><span class="n">annotator</span><span class="o">.</span><span class="n">classification</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">sparknlp</span><span class="o">.</span><span class="n">annotator</span><span class="o">.</span><span class="n">deid</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">sparknlp</span><span class="o">.</span><span class="n">annotator</span><span class="o">.</span><span class="n">disambiguation</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">sparknlp</span><span class="o">.</span><span class="n">annotator</span><span class="o">.</span><span class="n">keyword</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">sparknlp</span><span class="o">.</span><span class="n">annotator</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">sparknlp</span><span class="o">.</span><span class="n">annotator</span><span class="o">.</span><span class="n">merge</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">sparknlp</span><span class="o">.</span><span class="n">annotator</span><span class="o">.</span><span class="n">ner</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">sparknlp</span><span class="o">.</span><span class="n">annotator</span><span class="o">.</span><span class="n">generic_classifier</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">sparknlp</span><span class="o">.</span><span class="n">annotator</span><span class="o">.</span><span class="n">re</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">sparknlp</span><span class="o">.</span><span class="n">annotator</span><span class="o">.</span><span class="n">chunker</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>

<span class="n">keyword</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">assertion</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">assertion</span><span class="o">.</span><span class="n">dl</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">assertion</span><span class="o">.</span><span class="n">logreg</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">resolution</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">classification</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">deid</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">context</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">merge</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">ner</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">generic_classifier</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">re</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="n">chunker</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>


<div class="viewcode-block" id="AssertionLogRegApproach"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionLogRegApproach.html#sparknlp_jsl.annotator.AssertionLogRegApproach">[docs]</a><span class="k">class</span> <span class="nc">AssertionLogRegApproach</span><span class="p">(</span><span class="n">AnnotatorApproach</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Train a Assertion algorithm using a regression log model.</span>

<span class="sd">    Excluding the label, this can be done with for example:</span>
<span class="sd">    - a :class: SentenceDetector,</span>
<span class="sd">    - a :class: Chunk,</span>
<span class="sd">    - a :class: WordEmbeddingsModel.</span>

<span class="sd">    ========================================= ======================</span>
<span class="sd">    Input Annotation types                    Output Annotation type</span>
<span class="sd">    ========================================= ======================</span>
<span class="sd">    ``DOCUMENT, CHUNK, WORD_EMBEDDINGS``      ``ASSERTION``</span>
<span class="sd">    ========================================= ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    label</span>
<span class="sd">        Column with label per each token</span>
<span class="sd">    maxIter</span>
<span class="sd">        Max number of iterations for algorithm</span>
<span class="sd">    regParam</span>
<span class="sd">        Regularization parameter</span>
<span class="sd">    eNetParam</span>
<span class="sd">        Elastic net parameter</span>
<span class="sd">    beforeParam</span>
<span class="sd">        Length of the context before the target</span>
<span class="sd">    afterParam</span>
<span class="sd">        Length of the context after the target</span>
<span class="sd">    startCol</span>
<span class="sd">        Column that contains the token number for the start of the target&quot;</span>
<span class="sd">    externalFeatures</span>
<span class="sd">        Additional dictionaries paths to use as a features</span>
<span class="sd">    endCol</span>
<span class="sd">        Column that contains the token number for the end of the target</span>
<span class="sd">    nerCol</span>
<span class="sd">        Column with NER type annotation output, use either nerCol or startCol and endCol</span>
<span class="sd">    targetNerLabels</span>
<span class="sd">        List of NER labels to mark as target for assertion, must match NER output</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; document_assembler = DocumentAssembler() \\</span>
<span class="sd">    ...    .setInputCol(&quot;text&quot;) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; sentence_detector = SentenceDetector() \\</span>
<span class="sd">    ...    .setInputCol(&quot;document&quot;) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \\</span>
<span class="sd">    ...    .setInputCols([&quot;sentence&quot;]) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;token&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; glove = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...    .setInputCols([&quot;sentence&quot;, &quot;token&quot;]) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;word_embeddings&quot;) \</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; chunk = Chunker() \\</span>
<span class="sd">    ...    .setInputCols([sentence]) \\</span>
<span class="sd">    ...    .setChunkCol(&quot;chunk&quot;) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;chunk&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    Then the AssertionLogRegApproach model is defined. Label column is needed in the dataset for training.</span>
<span class="sd">    &gt;&gt;&gt; assertion = AssertionLogRegApproach() \\</span>
<span class="sd">    ...    .setLabelCol(&quot;label&quot;) \\</span>
<span class="sd">    ...    .setInputCols([&quot;document&quot;, &quot;chunk&quot;, &quot;word_embeddings&quot;]) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;assertion&quot;) \\</span>
<span class="sd">    ...    .setReg(0.01) \\</span>
<span class="sd">    ...    .setBefore(11) \\</span>
<span class="sd">    ...    .setAfter(13) \\</span>
<span class="sd">    ...    .setStartCol(&quot;start&quot;) \\</span>
<span class="sd">    ...    .setEndCol(&quot;end&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; assertionPipeline = Pipeline(stages=[</span>
<span class="sd">    ...    document_assembler,</span>
<span class="sd">    ...    sentence_detector,</span>
<span class="sd">    ...    tokenizer,</span>
<span class="sd">    ...    glove,</span>
<span class="sd">    ...    chunk,</span>
<span class="sd">    ...    assertion</span>
<span class="sd">    ...])</span>

<span class="sd">    &gt;&gt;&gt; assertionModel = assertionPipeline.fit(dataset)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">label</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="s2">&quot;Column with one label per document&quot;</span><span class="p">,</span> <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">maxIter</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;maxIter&quot;</span><span class="p">,</span> <span class="s2">&quot;Max number of iterations for algorithm&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">regParam</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;regParam&quot;</span><span class="p">,</span> <span class="s2">&quot;Regularization parameter&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>
    <span class="n">eNetParam</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;eNetParam&quot;</span><span class="p">,</span> <span class="s2">&quot;Elastic net parameter&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>
    <span class="n">beforeParam</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;beforeParam&quot;</span><span class="p">,</span> <span class="s2">&quot;Length of the context before the target&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">afterParam</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;afterParam&quot;</span><span class="p">,</span> <span class="s2">&quot;Length of the context after the target&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">startCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;startCol&quot;</span><span class="p">,</span> <span class="s2">&quot;Column that contains the token number for the start of the target&quot;</span><span class="p">,</span>
                     <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">endCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;endCol&quot;</span><span class="p">,</span> <span class="s2">&quot;Column that contains the token number for the end of the target&quot;</span><span class="p">,</span>
                   <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">nerCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;nerCol&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;Column with NER type annotation output, use either nerCol or startCol and endCol&quot;</span><span class="p">,</span>
                   <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">targetNerLabels</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;targetNerLabels&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;List of NER labels to mark as target for assertion, must match NER output&quot;</span><span class="p">,</span>
                            <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setLabelCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setMaxIter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">maxIter</span><span class="o">=</span><span class="n">maxiter</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setReg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lamda</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">regParam</span><span class="o">=</span><span class="n">lamda</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setEnet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enet</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">eNetParam</span><span class="o">=</span><span class="n">enet</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setBefore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">before</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">beforeParam</span><span class="o">=</span><span class="n">before</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setAfter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">after</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">afterParam</span><span class="o">=</span><span class="n">after</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setStartCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">startCol</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setEndCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">endCol</span><span class="o">=</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setNerCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">nerCol</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setTargetNerLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">targetNerLabels</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">AssertionLogRegModel</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span><span class="p">)</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AssertionLogRegApproach</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.assertion.logreg.AssertionLogRegApproach&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">beforeParam</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">afterParam</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span></div>


<div class="viewcode-block" id="AssertionLogRegModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionLogRegModel.html#sparknlp_jsl.annotator.AssertionLogRegModel">[docs]</a><span class="k">class</span> <span class="nc">AssertionLogRegModel</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">,</span> <span class="n">HasStorageRef</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is a main class in AssertionLogReg family. Logarithmic Regression is used to extract Assertion Status</span>
<span class="sd">        from extracted entities and text. AssertionLogRegModel requires DOCUMENT, CHUNK and WORD_EMBEDDINGS type</span>
<span class="sd">        annotator inputs, which can be obtained by e.g a</span>

<span class="sd">    Excluding the label, this can be done with for example:</span>

<span class="sd">    - a :class:`.SentenceDetector`,</span>
<span class="sd">    - a :class:`Chunk`,</span>
<span class="sd">    - a :class:`.WordEmbeddingsModel`.</span>


<span class="sd">    ========================================= ======================</span>
<span class="sd">    Input Annotation types                    Output Annotation type</span>
<span class="sd">    ========================================= ======================</span>
<span class="sd">    ``DOCUMENT, CHUNK, WORD_EMBEDDINGS``      ``ASSERTION``</span>
<span class="sd">    ========================================= ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    beforeParam</span>
<span class="sd">        Length of the context before the target</span>
<span class="sd">    afterParam</span>
<span class="sd">        Length of the context after the target</span>
<span class="sd">    startCol</span>
<span class="sd">        Column that contains the token number for the start of the target&quot;</span>
<span class="sd">    endCol</span>
<span class="sd">        Column that contains the token number for the end of the target</span>
<span class="sd">    nerCol</span>
<span class="sd">        Column with NER type annotation output, use either nerCol or startCol and endCol</span>
<span class="sd">    targetNerLabels</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>

<span class="sd">    &gt;&gt;&gt; document_assembler = DocumentAssembler() \\</span>
<span class="sd">    ...    .setInputCol(&quot;text&quot;) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; sentence_detector = SentenceDetector() \\</span>
<span class="sd">    ...    .setInputCol(&quot;document&quot;) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \\</span>
<span class="sd">    ...    .setInputCols([&quot;sentence&quot;]) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;token&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; embeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...    .setInputCols([&quot;sentence&quot;, &quot;token&quot;]) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;word_embeddings&quot;) \</span>
<span class="sd">    ...    .setCaseSensitive(False)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; chunk = Chunker() \\</span>
<span class="sd">    ...    .setInputCols([sentence]) \\</span>
<span class="sd">    ...    .setChunkCol(&quot;chunk&quot;) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;chunk&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    Then the AssertionLogRegApproach model is defined. Label column is needed in the dataset for training.</span>
<span class="sd">    &gt;&gt;&gt; assertion = AssertionLogRegModel().pretrained() \\</span>
<span class="sd">    ...    .setLabelCol(&quot;label&quot;) \\</span>
<span class="sd">    ...    .setInputCols([&quot;document&quot;, &quot;chunk&quot;, &quot;word_embeddings&quot;]) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;assertion&quot;) \\</span>
<span class="sd">    ...</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; assertionPipeline = Pipeline(stages=[</span>
<span class="sd">    ...    document_assembler,</span>
<span class="sd">    ...    sentence_detector,</span>
<span class="sd">    ...    tokenizer,</span>
<span class="sd">    ...    embeddings,</span>
<span class="sd">    ...    chunk,</span>
<span class="sd">    ...    assertion</span>
<span class="sd">    &gt;&gt;&gt;])</span>

<span class="sd">    &gt;&gt;&gt; assertionModel = assertionPipeline.fit(dataset)</span>
<span class="sd">    &gt;&gt;&gt; assertionPretrained = assertionModel.transform(dataset)</span>
<span class="sd">&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;AssertionLogRegModel&quot;</span>

    <span class="n">beforeParam</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;beforeParam&quot;</span><span class="p">,</span> <span class="s2">&quot;Length of the context before the target&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">afterParam</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;afterParam&quot;</span><span class="p">,</span> <span class="s2">&quot;Length of the context after the target&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">startCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;startCol&quot;</span><span class="p">,</span> <span class="s2">&quot;Column that contains the token number for the start of the target&quot;</span><span class="p">,</span>
                     <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">endCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;endCol&quot;</span><span class="p">,</span> <span class="s2">&quot;Column that contains the token number for the end of the target&quot;</span><span class="p">,</span>
                   <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">nerCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;nerCol&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;Column with NER type annotation output, use either nerCol or startCol and endCol&quot;</span><span class="p">,</span>
                   <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">targetNerLabels</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;targetNerLabels&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;List of NER labels to mark as target for assertion, must match NER output&quot;</span><span class="p">,</span>
                            <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.assertion.logreg.AssertionLogRegModel&quot;</span><span class="p">,</span>
                 <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AssertionLogRegModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.pretrained</span> <span class="kn">import</span> <span class="n">InternalResourceDownloader</span>
        <span class="k">return</span> <span class="n">InternalResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">AssertionLogRegModel</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="NerChunker"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerChunker.html#sparknlp_jsl.annotator.NerChunker">[docs]</a><span class="k">class</span> <span class="nc">NerChunker</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extracts phrases that fits into a known pattern using the NER tags. Useful for entity groups with neighboring tokens</span>
<span class="sd">       when there is no pretrained NER model to address certain issues. A Regex needs to be provided to extract the tokens</span>
<span class="sd">       between entities.</span>

<span class="sd">    ========================================= ======================</span>
<span class="sd">    Input Annotation types                    Output Annotation type</span>
<span class="sd">    ========================================= ======================</span>
<span class="sd">    ``DOCUMENT, CHUNK``                       ``NAMED_ENTITY``</span>
<span class="sd">    ========================================= ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    setRegexParsers</span>
<span class="sd">        A list of regex patterns to match chunks, for example: [“‹DT›?‹JJ›*‹NN”]</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>

<span class="sd">    &gt;&gt;&gt; document_assembler = DocumentAssembler() \\</span>
<span class="sd">    ...    .setInputCol(&quot;text&quot;) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; sentence_detector = SentenceDetector() \\</span>
<span class="sd">    ...    .setInputCol(&quot;document&quot;) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \\</span>
<span class="sd">    ...    .setInputCols([&quot;sentence&quot;]) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;token&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; embeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...    .setInputCols([&quot;sentence&quot;, &quot;token&quot;]) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;embeddings&quot;) \</span>
<span class="sd">    ...    .setCaseSensitive(False)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; ner = MedicalNerModel.pretrained(&quot;ner_radiology&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...    .setInputCols([&quot;sentence&quot;, &quot;token&quot;,&quot;embeddings&quot;]) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;ner&quot;) \</span>
<span class="sd">    ...    .setCaseSensitive(False)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; chunker = NerChunker() \\</span>
<span class="sd">    ...    .setInputCols([&quot;sentence&quot;,&quot;ner&quot;]) \\</span>
<span class="sd">    ...    .setChunkCol(&quot;ner_chunk&quot;) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;chunk&quot;)</span>
<span class="sd">    ...    .setRegexParsers(Array(&quot;&lt;ImagingFindings&gt;.*&lt;BodyPart&gt;&quot;))</span>
<span class="sd">    ...</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline(stages=[</span>
<span class="sd">    ...    document_assembler,</span>
<span class="sd">    ...    sentence_detector,</span>
<span class="sd">    ...    tokenizer,</span>
<span class="sd">    ...    embeddings,</span>
<span class="sd">    ...    ner,</span>
<span class="sd">    ...    chunker</span>
<span class="sd">    ...])</span>
<span class="sd">    &gt;&gt;&gt; result = pipeline.fit.fit(dataset).transform(dataset)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;NerChunker&quot;</span>

    <span class="n">regexParsers</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;regexParsers&quot;</span><span class="p">,</span> <span class="s2">&quot;an array of grammar based chunk parsers&quot;</span><span class="p">,</span>
                         <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.ner.NerChunker&quot;</span><span class="p">,</span>
                 <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NerChunker</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>

<div class="viewcode-block" id="NerChunker.setRegexParsers"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerChunker.html#sparknlp_jsl.annotator.NerChunker.setRegexParsers">[docs]</a>    <span class="k">def</span> <span class="nf">setRegexParsers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets list of regex patterns to match chunks, for example: Array(“‹DT›?‹JJ›*‹NN›”</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : List[String]</span>
<span class="sd">             list of regex patterns to match chunks, for example: Array(“‹DT›?‹JJ›*‹NN›”</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">regexParsers</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="AssertionDLApproach"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach">[docs]</a><span class="k">class</span> <span class="nc">AssertionDLApproach</span><span class="p">(</span><span class="n">AnnotatorApproach</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Train a Assertion Model algorithm using deep learning.</span>
<span class="sd">    from extracted entities and text. AssertionLogRegModel requires DOCUMENT, CHUNK and WORD_EMBEDDINGS type</span>
<span class="sd">    annotator inputs, which can be obtained by e.g a</span>

<span class="sd">    The training data should have annotations columns of type ``DOCUMENT``, ``CHUNK``, ``WORD_EMBEDDINGS``, the ``label`` column</span>
<span class="sd">    (The assertion status that you want to predict), the ``start`` (the start index for the term that has the assertion status),</span>
<span class="sd">    the ``end`` column (the end index for the term that has the assertion status).This model use a deep learning to predict the entity.</span>

<span class="sd">    ========================================= ======================</span>
<span class="sd">    Input Annotation types                    Output Annotation type</span>
<span class="sd">    ========================================= ======================</span>
<span class="sd">    ``DOCUMENT, CHUNK, WORD_EMBEDDINGS``      ``ASSERTION``</span>
<span class="sd">    ========================================= ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    label</span>
<span class="sd">        Column with one label per document. Example of possible values: “present”, “absent”, “hypothetical”, “conditional”, “associated_with_other_person”, etc.</span>
<span class="sd">    startCol</span>
<span class="sd">        Column that contains the token number for the start of the target</span>
<span class="sd">    endCol</span>
<span class="sd">        olumn that contains the token number for the end of the target</span>
<span class="sd">    batchSize</span>
<span class="sd">        Size for each batch in the optimization process</span>
<span class="sd">    epochs</span>
<span class="sd">        Number of epochs for the optimization process</span>
<span class="sd">    learningRate</span>
<span class="sd">        Learning rate for the optimization process</span>
<span class="sd">    dropout</span>
<span class="sd">        dropout&quot;, &quot;Dropout at the output of each layer</span>
<span class="sd">    maxSentLen</span>
<span class="sd">        Max length for an input sentence.</span>
<span class="sd">    graphFolder</span>
<span class="sd">        Folder path that contain external graph files</span>
<span class="sd">    graphFile</span>
<span class="sd">        Graph file name to use</span>
<span class="sd">    configProtoBytes</span>
<span class="sd">        ConfigProto from tensorflow, serialized into byte array. Get with config_proto.SerializeToString()</span>
<span class="sd">    validationSplit</span>
<span class="sd">        Choose the proportion of training dataset to be validated against the model on each Epoch. The value should be between 0.0 and 1.0 and by default it is 0.0 and off.</span>
<span class="sd">    evaluationLogExtended</span>
<span class="sd">       Select if you want to have mode eval.</span>
<span class="sd">    testDataset</span>
<span class="sd">        Path to test dataset. If set used to calculate statistic on it during training.</span>
<span class="sd">    includeConfidence</span>
<span class="sd">        whether to include confidence scores in annotation metadata</span>
<span class="sd">    enableOutputLogs</span>
<span class="sd">        whether or not to output logs</span>
<span class="sd">    outputLogsPath</span>
<span class="sd">        Folder path to save training logs</span>
<span class="sd">    verbose</span>
<span class="sd">        Level of verbosity during training</span>
<span class="sd">    scopeWindow</span>
<span class="sd">        The scope window of the assertion expression</span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; document_assembler = DocumentAssembler() \\</span>
<span class="sd">    ...    .setInputCol(&quot;text&quot;) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentence_detector = SentenceDetector() \\</span>
<span class="sd">    ...    .setInputCol(&quot;document&quot;) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \\</span>
<span class="sd">    ...    .setInputCols([&quot;sentence&quot;]) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;token&quot;)</span>
<span class="sd">    &gt;&gt;&gt; embeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...    .setInputCols([&quot;sentence&quot;, &quot;token&quot;]) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;word_embeddings&quot;) \\</span>
<span class="sd">    ...    .setCaseSensitive(False)</span>
<span class="sd">    &gt;&gt;&gt; chunk = Chunker() \\</span>
<span class="sd">    ...    .setInputCols([sentence]) \\</span>
<span class="sd">    ...    .setChunkCol(&quot;chunk&quot;) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;chunk&quot;)</span>
<span class="sd">    &gt;&gt;&gt; assertion = AssertionDLApproach() \\</span>
<span class="sd">    ...    .setLabelCol(&quot;label&quot;) \\</span>
<span class="sd">    ...    .setInputCols([&quot;document&quot;, &quot;chunk&quot;, &quot;word_embeddings&quot;]) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;assertion&quot;) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;assertion&quot;) \\</span>
<span class="sd">    ...    .setBatchSize(128) \\</span>
<span class="sd">    ...    .setDropout(0.012) \\</span>
<span class="sd">    ...    .setLearningRate(0.015) \\</span>
<span class="sd">    ...    .setEpochs(1) \\</span>
<span class="sd">    ...    .setStartCol(&quot;start&quot;) \\</span>
<span class="sd">    ...    .setScopeWindow([3, 4]) \\</span>
<span class="sd">    ...    .setEndCol(&quot;end&quot;) \\</span>
<span class="sd">    ...    .setMaxSentLen(250)</span>
<span class="sd">    &gt;&gt;&gt; assertionPipeline = Pipeline(stages=[</span>
<span class="sd">    ...    document_assembler,</span>
<span class="sd">    ...    sentence_detector,</span>
<span class="sd">    ...    tokenizer,</span>
<span class="sd">    ...    embeddings,</span>
<span class="sd">    ...    chunk,</span>
<span class="sd">    ...    assertion])</span>
<span class="sd">    &gt;&gt;&gt; assertionModel = assertionPipeline.fit(dataset)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">label</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="s2">&quot;Column with one label per document&quot;</span><span class="p">,</span> <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">startCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;startCol&quot;</span><span class="p">,</span> <span class="s2">&quot;Column that contains the token number for the start of the target&quot;</span><span class="p">,</span>
                     <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">endCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;endCol&quot;</span><span class="p">,</span> <span class="s2">&quot;Column that contains the token number for the end of the target&quot;</span><span class="p">,</span>
                   <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">batchSize</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;batchSize&quot;</span><span class="p">,</span> <span class="s2">&quot;Size for each batch in the optimization process&quot;</span><span class="p">,</span>
                      <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">epochs</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;epochs&quot;</span><span class="p">,</span> <span class="s2">&quot;Number of epochs for the optimization process&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">learningRate</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;learningRate&quot;</span><span class="p">,</span> <span class="s2">&quot;Learning rate for the optimization process&quot;</span><span class="p">,</span>
                         <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>
    <span class="n">dropout</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;dropout&quot;</span><span class="p">,</span> <span class="s2">&quot;Dropout at the output of each layer&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>

    <span class="n">maxSentLen</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;maxSentLen&quot;</span><span class="p">,</span> <span class="s2">&quot;Max length for an input sentence.&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">graphFolder</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;graphFolder&quot;</span><span class="p">,</span> <span class="s2">&quot;Folder path that contain external graph files&quot;</span><span class="p">,</span>
                        <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">graphFile</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;graphFile&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Path that contains the external graph file. When specified, the provided file will be used, and no graph search will happen.&quot;</span><span class="p">,</span>
                      <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">configProtoBytes</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;configProtoBytes&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;ConfigProto from tensorflow, serialized into byte array. Get with config_proto.SerializeToString()&quot;</span><span class="p">,</span>
                             <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

    <span class="n">validationSplit</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;validationSplit&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;Choose the proportion of training dataset to be validated against the model on each Epoch. The value should be between 0.0 and 1.0 and by default it is 0.0 and off.&quot;</span><span class="p">,</span>
                            <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>

    <span class="n">evaluationLogExtended</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;evaluationLogExtended&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;&quot;</span><span class="p">,</span>
                                  <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">testDataset</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;testDataset&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Path to test dataset. If set used to calculate statistic on it during training.&quot;</span><span class="p">,</span>
                        <span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

    <span class="n">includeConfidence</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;includeConfidence&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;whether to include confidence scores in annotation metadata&quot;</span><span class="p">,</span>
                              <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">enableOutputLogs</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;enableOutputLogs&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;whether or not to output logs&quot;</span><span class="p">,</span>
                             <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">outputLogsPath</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;outputLogsPath&quot;</span><span class="p">,</span> <span class="s2">&quot;Folder path to save training logs&quot;</span><span class="p">,</span>
                           <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">verbose</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;verbose&quot;</span><span class="p">,</span> <span class="s2">&quot;Level of verbosity during training&quot;</span><span class="p">,</span>
                    <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">scopeWindow</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;scopeWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;The scope window of the assertion expression&quot;</span><span class="p">,</span>
                        <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListInt</span><span class="p">)</span>

<div class="viewcode-block" id="AssertionDLApproach.setGraphFolder"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setGraphFolder">[docs]</a>    <span class="k">def</span> <span class="nf">setGraphFolder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets folder path that contain external graph files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p : srt</span>
<span class="sd">            Folder path that contain external graph files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">graphFolder</span><span class="o">=</span><span class="n">p</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setGraphFile"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setGraphFile">[docs]</a>    <span class="k">def</span> <span class="nf">setGraphFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets path that contains the external graph file. When specified, the provided file will be used, and no graph search will happen.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : str</span>
<span class="sd">            Path that contains the external graph file. When specified, the provided file will be used, and no graph search will happen.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">graphFile</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setConfigProtoBytes"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setConfigProtoBytes">[docs]</a>    <span class="k">def</span> <span class="nf">setConfigProtoBytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets  ConfigProto from tensorflow, serialized into byte array. Get with config_proto.SerializeToString()`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : bytes</span>
<span class="sd">           ConfigProto from tensorflow, serialized into byte array. Get with config_proto.SerializeToString()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">configProtoBytes</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setLabelCol"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setLabelCol">[docs]</a>    <span class="k">def</span> <span class="nf">setLabelCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set a column with one label per document. Example of possible values: “present”, “absent”, “hypothetical”, “conditional”, “associated_with_other_person”, etc.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            label. Column with one label per document. Example of possible values: “present”, “absent”, “hypothetical”, “conditional”, “associated_with_other_person”, etc.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setStartCol"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setStartCol">[docs]</a>    <span class="k">def</span> <span class="nf">setStartCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set a column that contains the token number for the start of the target</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : str</span>
<span class="sd">           Column that contains the token number for the start of the target</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">startCol</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setEndCol"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setEndCol">[docs]</a>    <span class="k">def</span> <span class="nf">setEndCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set column that contains the token number for the end of the target.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        row : str</span>
<span class="sd">            Column that contains the token number for the end of the target</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">endCol</span><span class="o">=</span><span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setBatchSize"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setBatchSize">[docs]</a>    <span class="k">def</span> <span class="nf">setBatchSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Size for each batch in the optimization process.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : int</span>
<span class="sd">            Size for each batch in the optimization process</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">batchSize</span><span class="o">=</span><span class="n">size</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setEpochs"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setEpochs">[docs]</a>    <span class="k">def</span> <span class="nf">setEpochs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets number of epochs for the optimization process</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        number : int</span>
<span class="sd">           Number of epochs for the optimization process</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">epochs</span><span class="o">=</span><span class="n">number</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setLearningRate"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setLearningRate">[docs]</a>    <span class="k">def</span> <span class="nf">setLearningRate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lamda</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set a learning rate for the optimization process</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lamda : float</span>
<span class="sd">            Learning rate for the optimization process.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Annotation</span>
<span class="sd">            The new Annotation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">learningRate</span><span class="o">=</span><span class="n">lamda</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setDropout"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setDropout">[docs]</a>    <span class="k">def</span> <span class="nf">setDropout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rate</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set a dropout at the output of each layer</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rate : float</span>
<span class="sd">           Dropout at the output of each layer</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">dropout</span><span class="o">=</span><span class="n">rate</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setMaxSentLen"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setMaxSentLen">[docs]</a>    <span class="k">def</span> <span class="nf">setMaxSentLen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the max length for an input sentence.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        length : int</span>
<span class="sd">            Max length for an input sentence.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">maxSentLen</span><span class="o">=</span><span class="n">length</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setValidationSplit"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setValidationSplit">[docs]</a>    <span class="k">def</span> <span class="nf">setValidationSplit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Choose the proportion of training dataset to be validated against the model on each Epoch.</span>
<span class="sd">            The value should be between 0.0 and 1.0 and by default it is 0.0 and off.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v : float</span>
<span class="sd">            Choose the proportion of training dataset to be validated against the model on each Epoch.</span>
<span class="sd">            The value should be between 0.0 and 1.0 and by default it is 0.0 and off.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">validationSplit</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setEvaluationLogExtended"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setEvaluationLogExtended">[docs]</a>    <span class="k">def</span> <span class="nf">setEvaluationLogExtended</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a Annotation from a Spark `Row`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v : bool</span>
<span class="sd">            Evaluation log extended.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">evaluationLogExtended</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setTestDataset"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setTestDataset">[docs]</a>    <span class="k">def</span> <span class="nf">setTestDataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">read_as</span><span class="o">=</span><span class="n">ReadAs</span><span class="o">.</span><span class="n">SPARK</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets path to test dataset. If set used to calculate statistic on it during training.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : srt</span>
<span class="sd">            Path to test dataset. If set used to calculate statistic on it during training.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;parquet&quot;</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">testDataset</span><span class="o">=</span><span class="n">ExternalResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">read_as</span><span class="p">,</span> <span class="n">options</span><span class="o">.</span><span class="n">copy</span><span class="p">()))</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setIncludeConfidence"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setIncludeConfidence">[docs]</a>    <span class="k">def</span> <span class="nf">setIncludeConfidence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets if you waht to include confidence scores in annotation metadata.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            p : bool</span>
<span class="sd">            Value that selects if you want to use confidence scores in annotation metadata</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">includeConfidence</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setEnableOutputLogs"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setEnableOutputLogs">[docs]</a>    <span class="k">def</span> <span class="nf">setEnableOutputLogs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets if you enable to output to annotators log folder.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : srt</span>
<span class="sd">            Folder path that contain external graph files.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">enableOutputLogs</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setOutputLogsPath"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setOutputLogsPath">[docs]</a>    <span class="k">def</span> <span class="nf">setOutputLogsPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets folder path that contain external graph files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : srt</span>
<span class="sd">                Folder path that contain external graph files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">outputLogsPath</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setVerbose"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setVerbose">[docs]</a>    <span class="k">def</span> <span class="nf">setVerbose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets level of verbosity during training.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">            Level of verbosity during training.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionDLApproach.setScopeWindow"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLApproach.html#sparknlp_jsl.annotator.AssertionDLApproach.setScopeWindow">[docs]</a>    <span class="k">def</span> <span class="nf">setScopeWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the scope of the window of the assertion expression</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : [int, int]</span>
<span class="sd">            Left and right offset if the scope window. Offsets must be non-negative values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">scopeWindow</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">AssertionDLModel</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span><span class="p">)</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AssertionDLApproach</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.assertion.dl.AssertionDLApproach&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">batchSize</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">learningRate</span><span class="o">=</span><span class="mf">0.0012</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">maxSentLen</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
                         <span class="n">includeConfidence</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scopeWindow</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span></div>


<div class="viewcode-block" id="AssertionDLModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLModel.html#sparknlp_jsl.annotator.AssertionDLModel">[docs]</a><span class="k">class</span> <span class="nc">AssertionDLModel</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">,</span> <span class="n">HasStorageRef</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;AssertionDL is a deep Learning based approach used to extract Assertion Status</span>
<span class="sd">    from extracted entities and text. AssertionDLModel requires DOCUMENT, CHUNK and WORD_EMBEDDINGS type</span>
<span class="sd">    annotator inputs, which can be obtained by e.g a</span>


<span class="sd">    ========================================= ======================</span>
<span class="sd">    Input Annotation types                    Output Annotation type</span>
<span class="sd">    ========================================= ======================</span>
<span class="sd">    ``DOCUMENT, CHUNK, WORD_EMBEDDINGS``      ``ASSERTION``</span>
<span class="sd">    ========================================= ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    maxSentLen</span>
<span class="sd">        Max length for an input sentence.</span>
<span class="sd">    targetNerLabels</span>
<span class="sd">        List of NER labels to mark as target for assertion, must match NER output.</span>
<span class="sd">    configProtoBytes</span>
<span class="sd">        ConfigProto from tensorflow, serialized into byte array.</span>
<span class="sd">    classes</span>
<span class="sd">        Tags used to trained this AssertionDLModel</span>
<span class="sd">    scopeWindow</span>
<span class="sd">        The scope window of the assertion expression</span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;Patient with severe fever and sore throat&quot;],[&quot;Patient shows no stomach pain&quot;],[&quot;She was maintained on an epidural and PCA for pain control.&quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler().setInputCol(&quot;text&quot;).setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentenceDetector = SentenceDetector().setInputCols([&quot;document&quot;]).setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer().setInputCols([&quot;sentence&quot;]).setOutputCol(&quot;token&quot;)</span>
<span class="sd">    &gt;&gt;&gt; embeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...  .setOutputCol(&quot;embeddings&quot;)</span>
<span class="sd">    &gt;&gt;&gt; nerModel = MedicalNerModel.pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...  .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;]).setOutputCol(&quot;ner&quot;)</span>
<span class="sd">    &gt;&gt;&gt; nerConverter = NerConverter().setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;]).setOutputCol(&quot;ner_chunk&quot;)</span>
<span class="sd">    &gt;&gt;&gt; clinicalAssertion = AssertionDLModel.pretrained(&quot;assertion_dl&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...  .setInputCols([&quot;sentence&quot;, &quot;ner_chunk&quot;, &quot;embeddings&quot;]) \\</span>
<span class="sd">    ...  .setOutputCol(&quot;assertion&quot;)</span>
<span class="sd">    &gt;&gt;&gt; assertionPipeline = Pipeline(stages=[</span>
<span class="sd">    ...  documentAssembler,</span>
<span class="sd">    ...  sentenceDetector,</span>
<span class="sd">    ...  tokenizer,</span>
<span class="sd">    ...  embeddings,</span>
<span class="sd">    ...  nerModel,</span>
<span class="sd">    ...  nerConverter,</span>
<span class="sd">    ...  clinicalAssertion</span>
<span class="sd">    ... ])</span>

<span class="sd">    &gt;&gt;&gt; assertionModel = assertionPipeline.fit(data)</span>


<span class="sd">    &gt;&gt;&gt; result = assertionModel.transform(data)</span>
<span class="sd">    &gt;&gt;&gt; result.selectExpr(&quot;ner_chunk.result as ner&quot;, &quot;assertion.result&quot;).show(3, truncate=False)</span>
<span class="sd">    +--------------------------------+--------------------------------+</span>
<span class="sd">    |ner                             |result                          |</span>
<span class="sd">    +--------------------------------+--------------------------------+</span>
<span class="sd">    |[severe fever, sore throat]     |[present, present]              |</span>
<span class="sd">    |[stomach pain]                  |[absent]                        |</span>
<span class="sd">    |[an epidural, PCA, pain control]|[present, present, hypothetical]|</span>
<span class="sd">    +--------------------------------+--------------------------------+</span>



<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;AssertionDLModel&quot;</span>

    <span class="n">maxSentLen</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;maxSentLen&quot;</span><span class="p">,</span> <span class="s2">&quot;Max length for an input sentence.&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">targetNerLabels</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;targetNerLabels&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;List of NER labels to mark as target for assertion, must match NER output&quot;</span><span class="p">,</span>
                            <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>
    <span class="n">configProtoBytes</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;configProtoBytes&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;ConfigProto from tensorflow, serialized into byte array. Get with config_proto.SerializeToString()&quot;</span><span class="p">,</span>
                             <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

    <span class="n">classes</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;classes&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;get the tags used to trained this AssertionDLModel&quot;</span><span class="p">,</span>
                    <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

    <span class="n">scopeWindow</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;scopeWindow&quot;</span><span class="p">,</span> <span class="s2">&quot;The scope window of the assertion expression&quot;</span><span class="p">,</span>
                        <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListInt</span><span class="p">)</span>

    <span class="n">includeConfidence</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;includeConfidence&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;whether to include confidence scores in annotation metadata&quot;</span><span class="p">,</span>
                              <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setConfigProtoBytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">configProtoBytes</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>


<div class="viewcode-block" id="AssertionDLModel.setIncludeConfidence"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLModel.html#sparknlp_jsl.annotator.AssertionDLModel.setIncludeConfidence">[docs]</a>    <span class="k">def</span> <span class="nf">setIncludeConfidence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets if you waht to include confidence scores in annotation metadata.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            p : bool</span>
<span class="sd">            Value that selects if you want to use confidence scores in annotation metadata</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">includeConfidence</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.assertion.dl.AssertionDLModel&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AssertionDLModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>

<div class="viewcode-block" id="AssertionDLModel.setScopeWindow"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionDLModel.html#sparknlp_jsl.annotator.AssertionDLModel.setScopeWindow">[docs]</a>    <span class="k">def</span> <span class="nf">setScopeWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the scope of the window of the assertion expression</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : [int, int]</span>
<span class="sd">            Left and right offset if the scope window. Offsets must be non-negative values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">scopeWindow</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.pretrained</span> <span class="kn">import</span> <span class="n">InternalResourceDownloader</span>
        <span class="k">return</span> <span class="n">InternalResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">AssertionDLModel</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div>


<span class="c1"># TODO this class is not used</span>
<div class="viewcode-block" id="CommonResolverParams"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams">[docs]</a><span class="k">class</span> <span class="nc">CommonResolverParams</span><span class="p">(</span><span class="n">HasCaseSensitiveProperties</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class used to have a common interface Entity Resolver family.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    distanceFunction</span>
<span class="sd">        What distance function to use for WMD: &#39;EUCLIDEAN&#39; or &#39;COSINE&#39;.</span>
<span class="sd">    neighbours</span>
<span class="sd">        Number of neighbours to consider in the KNN query to calculate WMD</span>
<span class="sd">    alternatives</span>
<span class="sd">        Number of results to return in the metadata after sorting by last distance calculated</span>
<span class="sd">    extramassPenalty</span>
<span class="sd">        Penalty for extra words in the knowledge base match</span>
<span class="sd">    threshold</span>
<span class="sd">        Threshold value for the last distance calculated.</span>
<span class="sd">    enableWmd</span>
<span class="sd">        Whether or not to use WMD token distance.</span>
<span class="sd">    enableTfidf</span>
<span class="sd">        Whether or not to use TFIDF token distance.</span>
<span class="sd">    enableJaccard</span>
<span class="sd">        Whether or not to use Jaccard token distance.</span>
<span class="sd">    enableSorensenDice</span>
<span class="sd">        Whether or not to use Sorensen-Dice token distance.</span>
<span class="sd">    enableJaroWinkler =</span>
<span class="sd">        Whether or not to use Jaro-Winkler character distance.</span>
<span class="sd">    enableLevenshtein</span>
<span class="sd">        Whether or not to use Levenshtein character distance.</span>
<span class="sd">    distanceWeights</span>
<span class="sd">        Distance weights to apply before pooling: [WMD, TFIDF, Jaccard, SorensenDice, JaroWinkler, Levenshtein].</span>
<span class="sd">    poolingStrategy</span>
<span class="sd">        Pooling strategy to aggregate distances: AVERAGE, MIN or MAX.</span>
<span class="sd">    confidenceFunction</span>
<span class="sd">        What function to use to calculate confidence: INVERSE or SOFTMAX.</span>
<span class="sd">    allDistancesMetadata</span>
<span class="sd">        Whether or not to return an all distance values in the metadata. Default: False.</span>
<span class="sd">    missAsEmpty</span>
<span class="sd">        Whether or not to return an empty annotation on unmatched chunks.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">distanceFunction</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;distanceFunction&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;What distance function to use for WMD: &#39;EUCLIDEAN&#39; or &#39;COSINE&#39;&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">neighbours</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;neighbours&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Number of neighbours to consider in the KNN query to calculate WMD&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">alternatives</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;alternatives&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;Number of results to return in the metadata after sorting by last distance calculated&quot;</span><span class="p">,</span>
                         <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">extramassPenalty</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;extramassPenalty&quot;</span><span class="p">,</span> <span class="s2">&quot;Penalty for extra words in the knowledge base match&quot;</span><span class="p">,</span>
                             <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>
    <span class="n">threshold</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;threshold&quot;</span><span class="p">,</span> <span class="s2">&quot;Threshold value for the last distance calculated&quot;</span><span class="p">,</span>
                      <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>
    <span class="n">enableWmd</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;enableWmd&quot;</span><span class="p">,</span> <span class="s2">&quot;whether or not to use WMD token distance&quot;</span><span class="p">,</span>
                      <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">enableTfidf</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;enableTfidf&quot;</span><span class="p">,</span> <span class="s2">&quot;whether or not to use TFIDF token distance&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">enableJaccard</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;enableJaccard&quot;</span><span class="p">,</span> <span class="s2">&quot;whether or not to use Jaccard token distance&quot;</span><span class="p">,</span>
                          <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">enableSorensenDice</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;enableSorensenDice&quot;</span><span class="p">,</span>
                               <span class="s2">&quot;whether or not to use Sorensen-Dice token distance&quot;</span><span class="p">,</span>
                               <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">enableJaroWinkler</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;enableJaroWinkler&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;whether or not to use Jaro-Winkler character distance&quot;</span><span class="p">,</span>
                              <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">enableLevenshtein</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;enableLevenshtein&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;whether or not to use Levenshtein character distance&quot;</span><span class="p">,</span>
                              <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">distanceWeights</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;distanceWeights&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;distance weights to apply before pooling: [WMD, TFIDF, Jaccard, SorensenDice, JaroWinkler, Levenshtein]&quot;</span><span class="p">,</span>
                            <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListFloat</span><span class="p">)</span>
    <span class="n">poolingStrategy</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;poolingStrategy&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;pooling strategy to aggregate distances: AVERAGE, MIN or MAX&quot;</span><span class="p">,</span>
                            <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">confidenceFunction</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;confidenceFunction&quot;</span><span class="p">,</span>
                               <span class="s2">&quot;what function to use to calculate confidence: INVERSE or SOFTMAX&quot;</span><span class="p">,</span>
                               <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">allDistancesMetadata</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;allDistancesMetadata&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;whether or not to return an all distance values in the metadata. Default: False&quot;</span><span class="p">,</span>
                                 <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">missAsEmpty</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;missAsEmpty&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;whether or not to return an empty annotation on unmatched chunks&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

<div class="viewcode-block" id="CommonResolverParams.setDistanceFunction"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams.setDistanceFunction">[docs]</a>    <span class="k">def</span> <span class="nf">setDistanceFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets distance function to use for WMD: &#39;EUCLIDEAN&#39; or &#39;COSINE&#39;.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dist : str</span>
<span class="sd">            Value that selects what distance function to use for WMD: &#39;EUCLIDEAN&#39; or &#39;COSINE&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">distanceFunction</span><span class="o">=</span><span class="n">dist</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommonResolverParams.setNeighbours"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams.setNeighbours">[docs]</a>    <span class="k">def</span> <span class="nf">setNeighbours</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets number of neighbours to consider in the KNN query to calculate WMD.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        k : int</span>
<span class="sd">            Number of neighbours to consider in the KNN query to calculate WMD.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">neighbours</span><span class="o">=</span><span class="n">k</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommonResolverParams.setAlternatives"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams.setAlternatives">[docs]</a>    <span class="k">def</span> <span class="nf">setAlternatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets number of results to return in the metadata after sorting by last distance calculated.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        a : int</span>
<span class="sd">            Number of results to return in the metadata after sorting by last distance calculated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">alternatives</span><span class="o">=</span><span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommonResolverParams.setExtramassPenalty"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams.setExtramassPenalty">[docs]</a>    <span class="k">def</span> <span class="nf">setExtramassPenalty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets penalty for extra words in the knowledge base match.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        emp : float</span>
<span class="sd">             Penalty for extra words in the knowledge base match.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">extramassPenalty</span><span class="o">=</span><span class="n">emp</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommonResolverParams.setThreshold"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams.setThreshold">[docs]</a>    <span class="k">def</span> <span class="nf">setThreshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thres</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets Threshold value for the last distance calculated.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        thres : float</span>
<span class="sd">            Threshold value for the last distance calculated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="n">thres</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommonResolverParams.setEnableWmd"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams.setEnableWmd">[docs]</a>    <span class="k">def</span> <span class="nf">setEnableWmd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether or not to use WMD token distance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        e : bool</span>
<span class="sd">            Whether or not to use WMD token distance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">enableWmd</span><span class="o">=</span><span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommonResolverParams.setEnableTfidf"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams.setEnableTfidf">[docs]</a>    <span class="k">def</span> <span class="nf">setEnableTfidf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether or not to use TFIDF token distance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p : bool</span>
<span class="sd">            Whether or not to use TFIDF token distance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">enableTfidf</span><span class="o">=</span><span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommonResolverParams.setEnableJaccard"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams.setEnableJaccard">[docs]</a>    <span class="k">def</span> <span class="nf">setEnableJaccard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether or not to use Jaccard token distance.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            e : bool</span>
<span class="sd">            Whether or not to use Jaccard token distance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">enableJaccard</span><span class="o">=</span><span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommonResolverParams.setEnableSorensenDice"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams.setEnableSorensenDice">[docs]</a>    <span class="k">def</span> <span class="nf">setEnableSorensenDice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether or not to use Sorensen-Dice token distance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        e : bool</span>
<span class="sd">            Whether or not to use Sorensen-Dice token distance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">enableSorensenDice</span><span class="o">=</span><span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommonResolverParams.setEnableJaroWinkler"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams.setEnableJaroWinkler">[docs]</a>    <span class="k">def</span> <span class="nf">setEnableJaroWinkler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Whether or not to use Jaro-Winkler token distance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        e : bool</span>
<span class="sd">            Whether or not to use Jaro-Winkler token distance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">enableJaroWinkler</span><span class="o">=</span><span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommonResolverParams.setEnableLevenshtein"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams.setEnableLevenshtein">[docs]</a>    <span class="k">def</span> <span class="nf">setEnableLevenshtein</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether or not to use Levenshtein token distance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        e : bool</span>
<span class="sd">            Whether or not to use Levenshtein token distance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">enableLevenshtein</span><span class="o">=</span><span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommonResolverParams.setDistanceWeights"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams.setDistanceWeights">[docs]</a>    <span class="k">def</span> <span class="nf">setDistanceWeights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets distance weights to apply before pooling: [WMD, TFIDF, Jaccard, SorensenDice, JaroWinkler, Levenshtein].</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        l : str</span>
<span class="sd">            Whether or not to use Jaro-Winkler token distance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">distanceWeights</span><span class="o">=</span><span class="n">l</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommonResolverParams.setPoolingStrategy"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams.setPoolingStrategy">[docs]</a>    <span class="k">def</span> <span class="nf">setPoolingStrategy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets pooling strategy to aggregate distances: AVERAGE, MIN or MAX.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : str</span>
<span class="sd">            Pooling strategy to aggregate distances: AVERAGE, MIN or MAX.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">poolingStrategy</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommonResolverParams.setConfidenceFunction"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams.setConfidenceFunction">[docs]</a>    <span class="k">def</span> <span class="nf">setConfidenceFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;What function to use to calculate confidence: INVERSE or SOFTMAX.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : str</span>
<span class="sd">            What function to use to calculate confidence: INVERSE or SOFTMAX.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">confidenceFunction</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommonResolverParams.setAllDistancesMetadata"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams.setAllDistancesMetadata">[docs]</a>    <span class="k">def</span> <span class="nf">setAllDistancesMetadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether or not to return an all distance values in the metadata. Default: False.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : bool</span>
<span class="sd">            whether or not to return an all distance values in the metadata. Default: False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">allDistancesMetadata</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommonResolverParams.setMissAsEmpty"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.CommonResolverParams.html#sparknlp_jsl.annotator.CommonResolverParams.setMissAsEmpty">[docs]</a>    <span class="k">def</span> <span class="nf">setMissAsEmpty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether or not to return an empty annotation on unmatched chunks</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : bool</span>
<span class="sd">            whether or not to return an empty annotation on unmatched chunks</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">missAsEmpty</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SentenceResolverParams"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.SentenceResolverParams.html#sparknlp_jsl.annotator.SentenceResolverParams">[docs]</a><span class="k">class</span> <span class="nc">SentenceResolverParams</span><span class="p">(</span><span class="n">HasCaseSensitiveProperties</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class used to have a common interface Sentence Resolver family.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    distanceFunction</span>
<span class="sd">        What distance function to use for WMD: &#39;EUCLIDEAN&#39; or &#39;COSINE&#39;.</span>
<span class="sd">    neighbours</span>
<span class="sd">        Number of neighbours to consider in the KNN query to calculate WMD</span>
<span class="sd">    threshold</span>
<span class="sd">        Threshold value for the last distance calculated.</span>
<span class="sd">    confidenceFunction</span>
<span class="sd">        What function to use to calculate confidence: INVERSE or SOFTMAX.</span>
<span class="sd">    missAsEmpty</span>
<span class="sd">        Whether or not to return an empty annotation on unmatched chunks.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">distanceFunction</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;distanceFunction&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;What distance function to use for WMD: &#39;EUCLIDEAN&#39; or &#39;COSINE&#39;&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">neighbours</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;neighbours&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Number of neighbours to consider in the KNN query to calculate WMD&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">threshold</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;threshold&quot;</span><span class="p">,</span> <span class="s2">&quot;Threshold value for the last distance calculated&quot;</span><span class="p">,</span>
                      <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>
    <span class="n">confidenceFunction</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;confidenceFunction&quot;</span><span class="p">,</span>
                               <span class="s2">&quot;what function to use to calculate confidence: INVERSE or SOFTMAX&quot;</span><span class="p">,</span>
                               <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">missAsEmpty</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;missAsEmpty&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;whether or not to return an empty annotation on unmatched chunks&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

<div class="viewcode-block" id="SentenceResolverParams.setDistanceFunction"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.SentenceResolverParams.html#sparknlp_jsl.annotator.SentenceResolverParams.setDistanceFunction">[docs]</a>    <span class="k">def</span> <span class="nf">setDistanceFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets distance function to use for WMD: &#39;EUCLIDEAN&#39; or &#39;COSINE&#39;.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dist : str</span>
<span class="sd">            Value that selects what distance function to use for WMD: &#39;EUCLIDEAN&#39; or &#39;COSINE&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">distanceFunction</span><span class="o">=</span><span class="n">dist</span><span class="p">)</span></div>

<div class="viewcode-block" id="SentenceResolverParams.setNeighbours"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.SentenceResolverParams.html#sparknlp_jsl.annotator.SentenceResolverParams.setNeighbours">[docs]</a>    <span class="k">def</span> <span class="nf">setNeighbours</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets number of neighbours to consider in the KNN query to calculate WMD.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        k : int</span>
<span class="sd">            Number of neighbours to consider in the KNN query to calculate WMD.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">neighbours</span><span class="o">=</span><span class="n">k</span><span class="p">)</span></div>

<div class="viewcode-block" id="SentenceResolverParams.setThreshold"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.SentenceResolverParams.html#sparknlp_jsl.annotator.SentenceResolverParams.setThreshold">[docs]</a>    <span class="k">def</span> <span class="nf">setThreshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thres</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets Threshold value for the last distance calculated.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        thres : float</span>
<span class="sd">            Threshold value for the last distance calculated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="n">thres</span><span class="p">)</span></div>

<div class="viewcode-block" id="SentenceResolverParams.setConfidenceFunction"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.SentenceResolverParams.html#sparknlp_jsl.annotator.SentenceResolverParams.setConfidenceFunction">[docs]</a>    <span class="k">def</span> <span class="nf">setConfidenceFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;What function to use to calculate confidence: INVERSE or SOFTMAX.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : str</span>
<span class="sd">            What function to use to calculate confidence: INVERSE or SOFTMAX.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">confidenceFunction</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="SentenceResolverParams.setMissAsEmpty"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.SentenceResolverParams.html#sparknlp_jsl.annotator.SentenceResolverParams.setMissAsEmpty">[docs]</a>    <span class="k">def</span> <span class="nf">setMissAsEmpty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether or not to return an empty annotation on unmatched chunks.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            whether or not to return an empty annotation on unmatched chunks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">missAsEmpty</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SentenceEntityResolverApproach"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.SentenceEntityResolverApproach.html#sparknlp_jsl.annotator.SentenceEntityResolverApproach">[docs]</a><span class="k">class</span> <span class="nc">SentenceEntityResolverApproach</span><span class="p">(</span><span class="n">AnnotatorApproach</span><span class="p">,</span> <span class="n">SentenceResolverParams</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Thius class contains all the parameters and methods to train a SentenceEntityResolverModel.</span>
<span class="sd">       The model transforms a dataset with Input Annotation type SENTENCE_EMBEDDINGS, coming from e.g.</span>
<span class="sd">       [BertSentenceEmbeddings](/docs/en/transformers#bertsentenceembeddings)</span>
<span class="sd">       and returns the normalized entity for a particular trained ontology / curated dataset.</span>
<span class="sd">       (e.g. ICD-10, RxNorm, SNOMED etc.)</span>

<span class="sd">       ========================================= ======================</span>
<span class="sd">       Input Annotation types                    Output Annotation type</span>
<span class="sd">       ========================================= ======================</span>
<span class="sd">       ``SENTENCE_EMBEDDINGS``                    ``ENTITY``</span>
<span class="sd">       ========================================= ======================</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       labelCol</span>
<span class="sd">            Column name for the value we are trying to resolve</span>
<span class="sd">       normalizedCol</span>
<span class="sd">            Column name for the original, normalized description</span>
<span class="sd">       pretrainedModelPath</span>
<span class="sd">            Path to an already trained SentenceEntityResolverModel, which is used as a starting point for training the new model.</span>
<span class="sd">       overrideExistingCodes</span>
<span class="sd">            Whether to override the existing codes with new data while continue the training from a pretrained model. Default value is false(keep all the codes).</span>
<span class="sd">       returnCosineDistances</span>
<span class="sd">            Extract Cosine Distances. TRUE or False</span>
<span class="sd">       aux_label_col</span>
<span class="sd">            Auxiliary label which maps resolved entities to additional labels</span>
<span class="sd">       useAuxLabel</span>
<span class="sd">            Use AuxLabel Col or not</span>
<span class="sd">       overrideExistingCodes</span>
<span class="sd">            Whether to override the codes present in a pretrained model with new codes when the training process begins with a pretrained model</span>
<span class="sd">       dropCodesList</span>
<span class="sd">            A list of codes in a pretrained model that will be omitted when the training process begins with a pretrained model</span>


<span class="sd">       Examples</span>
<span class="sd">       --------</span>

<span class="sd">       &gt;&gt;&gt; import sparknlp</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">       &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">       &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">       &gt;&gt;&gt; documentAssembler = DocumentAssembler().setInputCol(&quot;text&quot;).setOutputCol(&quot;document&quot;)</span>
<span class="sd">       &gt;&gt;&gt; sentenceDetector = SentenceDetector().setInputCols([&quot;document&quot;]).setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">       &gt;&gt;&gt; tokenizer = Tokenizer().setInputCols([&quot;sentence&quot;]).setOutputCol(&quot;token&quot;)</span>
<span class="sd">       &gt;&gt;&gt; bertEmbeddings = BertSentenceEmbeddings.pretrained(&quot;sent_biobert_pubmed_base_cased&quot;) \\</span>
<span class="sd">       ...  .setInputCols([&quot;sentence&quot;]) \\</span>
<span class="sd">       ...  .setOutputCol(&quot;embeddings&quot;)</span>
<span class="sd">       &gt;&gt;&gt; snomedTrainingPipeline = Pipeline(stages=[</span>
<span class="sd">       ...  documentAssembler,</span>
<span class="sd">       ...  sentenceDetector,</span>
<span class="sd">       ...  bertEmbeddings,</span>
<span class="sd">       ... ])</span>
<span class="sd">       &gt;&gt;&gt; snomedTrainingModel = snomedTrainingPipeline.fit(data)</span>
<span class="sd">       &gt;&gt;&gt; snomedData = snomedTrainingModel.transform(data).cache()</span>
<span class="sd">       &gt;&gt;&gt; assertionModel = assertionPipeline.fit(data)</span>
<span class="sd">       &gt;&gt;&gt; assertionModel = assertionPipeline.fit(data)</span>

<span class="sd">       &gt;&gt;&gt; bertExtractor = SentenceEntityResolverApproach() \\</span>
<span class="sd">       ...   .setNeighbours(25) \\</span>
<span class="sd">       ...   .setThreshold(1000) \\</span>
<span class="sd">       ...   .setInputCols([&quot;bert_embeddings&quot;]) \\</span>
<span class="sd">       ...   .setNormalizedCol(&quot;normalized_text&quot;) \\</span>
<span class="sd">       ...   .setLabelCol(&quot;label&quot;) \\</span>
<span class="sd">       ...   .setOutputCol(&quot;snomed_code&quot;) \\</span>
<span class="sd">       ...   .setDistanceFunction(&quot;EUCLIDIAN&quot;) \\</span>
<span class="sd">       ...   .setCaseSensitive(False)</span>

<span class="sd">       &gt;&gt;&gt; snomedModel = bertExtractor.fit(snomedData)</span>
<span class="sd">       &quot;&quot;&quot;</span>
    <span class="n">labelCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;labelCol&quot;</span><span class="p">,</span> <span class="s2">&quot;Column name for the value we are trying to resolve&quot;</span><span class="p">,</span>
                     <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">normalizedCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;normalizedCol&quot;</span><span class="p">,</span> <span class="s2">&quot;Column name for the original, normalized description&quot;</span><span class="p">,</span>
                          <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">pretrainedModelPath</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;pretrainedModelPath&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;Path to an already trained SentenceEntityResolverModel, which is used as a starting point for training the new model.&quot;</span><span class="p">,</span>
                                <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">overrideExistingCodes</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;overrideExistingCodes&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;Whether to override the existing codes with new data while continue the training from a pretrained model. Default value is false(keep all the codes).&quot;</span><span class="p">,</span>
                                  <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">dropCodesList</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;dropCodesList&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;List of codes in a pretrained model to leave out when continue training with new data.&quot;</span><span class="p">,</span>
                          <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

    <span class="n">returnCosineDistances</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;returnCosineDistances&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;Extract Cosine Distances. TRUE or False&quot;</span><span class="p">,</span>
                                  <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">aux_label_col</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;aux_label_col&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Auxiliary label which maps resolved entities to additional labels&quot;</span><span class="p">,</span>
                          <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">useAuxLabel</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;useAuxLabel&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Use AuxLabel Col or not&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

<div class="viewcode-block" id="SentenceEntityResolverApproach.setUseAuxLabel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.SentenceEntityResolverApproach.html#sparknlp_jsl.annotator.SentenceEntityResolverApproach.setUseAuxLabel">[docs]</a>    <span class="k">def</span> <span class="nf">setUseAuxLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets Use AuxLabel Col or not.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : bool</span>
<span class="sd">            Use AuxLabel Col or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">useAuxLabel</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="SentenceEntityResolverApproach.setAuxLabelCol"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.SentenceEntityResolverApproach.html#sparknlp_jsl.annotator.SentenceEntityResolverApproach.setAuxLabelCol">[docs]</a>    <span class="k">def</span> <span class="nf">setAuxLabelCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets auxiliary label which maps resolved entities to additional labels</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Auxiliary label which maps resolved entities to additional labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">aux_label_col</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="SentenceEntityResolverApproach.setExtractCosineDistances"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.SentenceEntityResolverApproach.html#sparknlp_jsl.annotator.SentenceEntityResolverApproach.setExtractCosineDistances">[docs]</a>    <span class="k">def</span> <span class="nf">setExtractCosineDistances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Extract Cosine Distances. TRUE or False.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : bool</span>
<span class="sd">            Extract Cosine Distances. TRUE or False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">returnCosineDistances</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="SentenceEntityResolverApproach.setLabelCol"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.SentenceEntityResolverApproach.html#sparknlp_jsl.annotator.SentenceEntityResolverApproach.setLabelCol">[docs]</a>    <span class="k">def</span> <span class="nf">setLabelCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets column name for the value we are trying to resolve</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : bool</span>
<span class="sd">            Column name for the value we are trying to resolve</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">labelCol</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="SentenceEntityResolverApproach.setNormalizedCol"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.SentenceEntityResolverApproach.html#sparknlp_jsl.annotator.SentenceEntityResolverApproach.setNormalizedCol">[docs]</a>    <span class="k">def</span> <span class="nf">setNormalizedCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets column name for the original, normalized description</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : bool</span>
<span class="sd">            Column name for the original, normalized description</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">normalizedCol</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">setPretrainedModelPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">pretrainedModelPath</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setOverrideExistingCodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">overrideExistingCodes</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setDropCodesList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">dropCodesList</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">SentenceEntityResolverModel</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span><span class="p">)</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SentenceEntityResolverApproach</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.resolution.SentenceEntityResolverApproach&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span><span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="n">normalizedCol</span><span class="o">=</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="n">distanceFunction</span><span class="o">=</span><span class="s2">&quot;EUCLIDEAN&quot;</span><span class="p">,</span> <span class="n">neighbours</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
                         <span class="n">threshold</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">missAsEmpty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">returnCosineDistances</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="SentenceEntityResolverModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.SentenceEntityResolverModel.html#sparknlp_jsl.annotator.SentenceEntityResolverModel">[docs]</a><span class="k">class</span> <span class="nc">SentenceEntityResolverModel</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">,</span> <span class="n">HasEmbeddingsProperties</span><span class="p">,</span> <span class="n">HasStorageModel</span><span class="p">,</span> <span class="n">SentenceResolverParams</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Thius class contains all the parameters and methods to train a SentenceEntityResolverModel.</span>
<span class="sd">       The model transforms a dataset with Input Annotation type SENTENCE_EMBEDDINGS, coming from e.g.</span>
<span class="sd">       [BertSentenceEmbeddings](/docs/en/transformers#bertsentenceembeddings)</span>
<span class="sd">       and returns the normalized entity for a particular trained ontology / curated dataset.</span>
<span class="sd">       (e.g. ICD-10, RxNorm, SNOMED etc.)</span>

<span class="sd">       ========================================= ======================</span>
<span class="sd">       Input Annotation types                    Output Annotation type</span>
<span class="sd">       ========================================= ======================</span>
<span class="sd">       ``SENTENCE_EMBEDDINGS``                   ``ENTITY``</span>
<span class="sd">       ========================================= ======================</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       returnCosineDistances</span>
<span class="sd">            Extract Cosine Distances. TRUE or False</span>
<span class="sd">       aux_label_col</span>
<span class="sd">            Auxiliary label which maps resolved entities to additional labels</span>
<span class="sd">       useAuxLabel</span>
<span class="sd">            Use AuxLabel Col or not</span>

<span class="sd">       searchTree</span>
<span class="sd">            Search tree for resolution</span>

<span class="sd">       Examples</span>
<span class="sd">       --------</span>

<span class="sd">       &gt;&gt;&gt; import sparknlp</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">       &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">       &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">       &gt;&gt;&gt; documentAssembler = DocumentAssembler().setInputCol(&quot;text&quot;).setOutputCol(&quot;document&quot;)</span>
<span class="sd">       &gt;&gt;&gt; sentenceDetector = SentenceDetector().setInputCols([&quot;document&quot;]).setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">       &gt;&gt;&gt; tokenizer = Tokenizer().setInputCols([&quot;sentence&quot;]).setOutputCol(&quot;token&quot;)</span>
<span class="sd">       &gt;&gt;&gt; bertEmbeddings = BertSentenceEmbeddings.pretrained(&quot;sent_biobert_pubmed_base_cased&quot;) \\</span>
<span class="sd">       ...  .setInputCols([&quot;sentence&quot;]) \\</span>
<span class="sd">       ...  .setOutputCol(&quot;embeddings&quot;)</span>
<span class="sd">       &gt;&gt;&gt; snomedTrainingPipeline = Pipeline(stages=[</span>
<span class="sd">       ...  documentAssembler,</span>
<span class="sd">       ...  sentenceDetector,</span>
<span class="sd">       ...  bertEmbeddings,</span>
<span class="sd">       ... ])</span>
<span class="sd">       &gt;&gt;&gt; snomedTrainingModel = snomedTrainingPipeline.fit(data)</span>
<span class="sd">       &gt;&gt;&gt; snomedData = snomedTrainingModel.transform(data).cache()</span>
<span class="sd">       &gt;&gt;&gt; assertionModel = assertionPipeline.fit(data)</span>
<span class="sd">       &gt;&gt;&gt; assertionModel = assertionPipeline.fit(data)</span>

<span class="sd">       &gt;&gt;&gt; bertExtractor = SentenceEntityResolverApproach() \\</span>
<span class="sd">       ...   .setNeighbours(25) \\</span>
<span class="sd">       ...   .setThreshold(1000) \\</span>
<span class="sd">       ...   .setInputCols([&quot;bert_embeddings&quot;]) \\</span>
<span class="sd">       ...   .setNormalizedCol(&quot;normalized_text&quot;) \\</span>
<span class="sd">       ...   .setLabelCol(&quot;label&quot;) \\</span>
<span class="sd">       ...   .setOutputCol(&quot;snomed_code&quot;) \\</span>
<span class="sd">       ...   .setDistanceFunction(&quot;EUCLIDIAN&quot;) \\</span>
<span class="sd">       ...   .setCaseSensitive(False)</span>

<span class="sd">       &gt;&gt;&gt; snomedModel = bertExtractor.fit(snomedData)</span>
<span class="sd">       &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;SentenceEntityResolverModel&quot;</span>
    <span class="n">returnCosineDistances</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;returnCosineDistances&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;Extract Cosine Distances. TRUE or False&quot;</span><span class="p">,</span>
                                  <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">aux_label_col</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;aux_label_col&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Auxiliary label which maps resolved entities to additional labels&quot;</span><span class="p">,</span>
                          <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">useAuxLabel</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;useAuxLabel&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Use AuxLabel Col or not&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">searchTree</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;searchTree&quot;</span><span class="p">,</span> <span class="s2">&quot;Search tree for resolution&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

    <span class="c1">##TODO add SetreturnCosineDistances.</span>

<div class="viewcode-block" id="SentenceEntityResolverModel.setUseAuxLabel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.SentenceEntityResolverModel.html#sparknlp_jsl.annotator.SentenceEntityResolverModel.setUseAuxLabel">[docs]</a>    <span class="k">def</span> <span class="nf">setUseAuxLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets Use AuxLabel Col or not.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : bool</span>
<span class="sd">            Use AuxLabel Col or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">useAuxLabel</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="SentenceEntityResolverModel.setAuxLabelCol"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.SentenceEntityResolverModel.html#sparknlp_jsl.annotator.SentenceEntityResolverModel.setAuxLabelCol">[docs]</a>    <span class="k">def</span> <span class="nf">setAuxLabelCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets auxiliary label which maps resolved entities to additional labels</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Auxiliary label which maps resolved entities to additional labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">aux_label_col</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="SentenceEntityResolverModel.setSearchTree"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.SentenceEntityResolverModel.html#sparknlp_jsl.annotator.SentenceEntityResolverModel.setSearchTree">[docs]</a>    <span class="k">def</span> <span class="nf">setSearchTree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets auxiliary label which maps resolved entities to additional labels</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Auxiliary label which maps resolved entities to additional labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">searchTree</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.resolution.SentenceEntityResolverModel&quot;</span><span class="p">,</span>
                 <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SentenceEntityResolverModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.pretrained</span> <span class="kn">import</span> <span class="n">InternalResourceDownloader</span>
        <span class="k">return</span> <span class="n">InternalResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">SentenceEntityResolverModel</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Chunk2Token"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.Chunk2Token.html#sparknlp_jsl.annotator.Chunk2Token">[docs]</a><span class="k">class</span> <span class="nc">Chunk2Token</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Chunk2Token&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.Chunk2Token&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Chunk2Token</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DeIdentification"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification">[docs]</a><span class="k">class</span> <span class="nc">DeIdentification</span><span class="p">(</span><span class="n">AnnotatorApproach</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Contains all the methods for training a DeIdentificationModel model.</span>
<span class="sd">    This module can obfuscate or mask the entities that contains personal information. These can be set with a file of</span>
<span class="sd">    regex patterns with setRegexPatternsDictionary, where each line is a mapping of entity to regex</span>

<span class="sd">    ========================================= ======================</span>
<span class="sd">    Input Annotation types                    Output Annotation type</span>
<span class="sd">    ========================================= ======================</span>
<span class="sd">    ``DOCUMENT, CHUNK, TOKEN``                ``DOCUMENT``</span>
<span class="sd">    ========================================= ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    regexPatternsDictionary</span>
<span class="sd">        ictionary with regular expression patterns that match some protected entity</span>
<span class="sd">    mode</span>
<span class="sd">        Mode for Anonimizer [&#39;mask&#39;|&#39;obfuscate&#39;]</span>
<span class="sd">    obfuscateDate</span>
<span class="sd">        When mode==&#39;obfuscate&#39; whether to obfuscate dates or not. This param helps in consistency to make dateFormats more visible. When setting to ``true``, make sure dateFormats param fits the needs (default: false)</span>
<span class="sd">    obfuscateRefFile</span>
<span class="sd">        File with the terms to be used for Obfuscation</span>
<span class="sd">    refFileFormat</span>
<span class="sd">        Format of the reference file</span>
<span class="sd">    refSep</span>
<span class="sd">        Sep character in refFile</span>
<span class="sd">    dateTag</span>
<span class="sd">        Tag representing dates in the obfuscate reference file (default: DATE)</span>
<span class="sd">    days</span>
<span class="sd">        Number of days to obfuscate the dates by displacement. If not provided a random integer between 1 and 60 will be used</span>
<span class="sd">    dateToYear</span>
<span class="sd">        True if we want the model to transform dates into years, False otherwise.</span>
<span class="sd">    minYear</span>
<span class="sd">        Minimum year to be used when transforming dates into years.</span>
<span class="sd">    dateFormats</span>
<span class="sd">        List of date formats to automatically displace if parsed</span>
<span class="sd">    consistentObfuscation</span>
<span class="sd">        Whether to replace very similar entities in a document with the same randomized term (default: true)</span>
<span class="sd">        The similarity is based on the Levenshtein Distance between the words.</span>
<span class="sd">    sameEntityThreshold</span>
<span class="sd">        Similarity threshold [0.0-1.0] to consider two appearances of an entity as ``the same`` (default: 0.9).</span>
<span class="sd">    obfuscateRefSource</span>
<span class="sd">        The source of obfuscation of to obfuscate the entities.For dates entities doesnt apply tha method.</span>
<span class="sd">        The values ar the following:</span>
<span class="sd">        file: Takes the entities from the obfuscatorRefFile</span>
<span class="sd">        faker: Takes the entities from the Faker module</span>
<span class="sd">        both : Takes the entities from the obfuscatorRefFile and the faker module randomly.</span>

<span class="sd">    regexOverride</span>
<span class="sd">        If is true prioritize the regex entities, if is false prioritize the ner.</span>
<span class="sd">    seed</span>
<span class="sd">        It is the seed to select the entities on obfuscate mode.With the seed you can reply a execution several times with the same ouptut.</span>
<span class="sd">    ignoreRegex</span>
<span class="sd">       Select if you want to use regex file loaded in the model.If true the default regex file will be not used.The default value is false.</span>
<span class="sd">    isRandomDateDisplacement</span>
<span class="sd">        Use a random displacement days in dates entities,that random number is based on the [[DeIdentificationParams.seed]]</span>
<span class="sd">        If true use random displacement days in dates entities,if false use the [[DeIdentificationParams.days]]</span>
<span class="sd">        The default value is false.</span>
<span class="sd">    mappingsColumn</span>
<span class="sd">        This is the mapping column that will return the Annotations chunks with the fake entities.</span>
<span class="sd">    returnEntityMappings</span>
<span class="sd">        With this property you select if you want to return mapping column</span>
<span class="sd">    blackList</span>
<span class="sd">        List of entities ignored for masking or obfuscation.The default values are: &quot;SSN&quot;,&quot;PASSPORT&quot;,&quot;DLN&quot;,&quot;NPI&quot;,&quot;C_CARD&quot;,&quot;IBAN&quot;,&quot;DEA&quot;</span>

<span class="sd">    maskingPolicy</span>
<span class="sd">        Select the masking policy:</span>
<span class="sd">            same_length_chars: Replace the obfuscated entity with a masking sequence composed of asterisks and surrounding squared brackets, being the total length of the masking sequence of the same length as the original sequence.</span>
<span class="sd">            Example, Smith -&gt; [***].</span>
<span class="sd">            If the entity is less than 3 chars (like Jo, or 5), asterisks without brackets will be returned.</span>
<span class="sd">            entity_labels: Replace the values with the corresponding entity labels.</span>
<span class="sd">            fixed_length_chars: Replace the obfuscated entity with a masking sequence composed of a fixed number of asterisks.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \\</span>
<span class="sd">    ...     .setInputCol(&quot;text&quot;) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt;  sentenceDetector = SentenceDetector() \\</span>
<span class="sd">    ...     .setInputCols([&quot;document&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;sentence&quot;) \\</span>
<span class="sd">    ...     .setUseAbbreviations(True)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;]) \</span>
<span class="sd">    ...     .setOutputCol(&quot;token&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt; embeddings = WordEmbeddingsModel \</span>
<span class="sd">    ...     .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;token&quot;]) \</span>
<span class="sd">    ...     .setOutputCol(&quot;embeddings&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">     Ner entities</span>
<span class="sd">    &gt;&gt;&gt; clinical_sensitive_entities = MedicalNerModel \\</span>
<span class="sd">    ...     .pretrained(&quot;ner_deid_enriched&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;]).setOutputCol(&quot;ner&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; nerConverter = NerConverter() \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;ner_con&quot;)</span>
<span class="sd">     Deidentification</span>
<span class="sd">    &gt;&gt;&gt; deIdentification = DeIdentification() \\</span>
<span class="sd">    ...     .setInputCols([&quot;ner_chunk&quot;, &quot;token&quot;, &quot;sentence&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;dei&quot;) \\</span>
<span class="sd">    ...     # file with custom regex pattern for custom entities\</span>
<span class="sd">    ...     .setRegexPatternsDictionary(&quot;path/to/dic_regex_patterns_main_categories.txt&quot;) \\</span>
<span class="sd">    ...     # file with custom obfuscator names for the entities\</span>
<span class="sd">    ...     .setObfuscateRefFile(&quot;path/to/obfuscate_fixed_entities.txt&quot;) \\</span>
<span class="sd">    ...     .setRefFileFormat(&quot;csv&quot;) \\</span>
<span class="sd">    ...     .setRefSep(&quot;#&quot;) \\</span>
<span class="sd">    ...     .setMode(&quot;obfuscate&quot;) \\</span>
<span class="sd">    ...     .setDateFormats(Array(&quot;MM/dd/yy&quot;,&quot;yyyy-MM-dd&quot;)) \\</span>
<span class="sd">    ...     .setObfuscateDate(True) \\</span>
<span class="sd">    ...     .setDateTag(&quot;DATE&quot;) \\</span>
<span class="sd">    ...     .setDays(5) \\</span>
<span class="sd">    ...     .setObfuscateRefSource(&quot;file&quot;)</span>
<span class="sd">    Pipeline</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([</span>
<span class="sd">    ...     [&quot;# 7194334 Date : 01/13/93 PCP : Oliveira , 25 years-old , Record date : 2079-11-09.&quot;]</span>
<span class="sd">    ...     ]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline(stages=[</span>
<span class="sd">    ...     documentAssembler,</span>
<span class="sd">    ...     sentenceDetector,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     embeddings,</span>
<span class="sd">    ...     clinical_sensitive_entities,</span>
<span class="sd">    ...     nerConverter,</span>
<span class="sd">    ...     deIdentification</span>
<span class="sd">    ... ])</span>
<span class="sd">    &gt;&gt;&gt; result = pipeline.fit(data).transform(data)</span>
<span class="sd">    &gt;&gt;&gt; result.select(&quot;dei.result&quot;).show(truncate = False)</span>
<span class="sd">     +--------------------------------------------------------------------------------------------------+</span>
<span class="sd">     |result                                                                                            |</span>
<span class="sd">     +--------------------------------------------------------------------------------------------------+</span>
<span class="sd">     |[# 01010101 Date : 01/18/93 PCP : Dr. Gregory House , &lt;AGE&gt; years-old , Record date : 2079-11-14.]|</span>
<span class="sd">     +--------------------------------------------------------------------------------------------------+</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;DeIdentification&quot;</span>

    <span class="n">regexPatternsDictionary</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                    <span class="s2">&quot;regexPatternsDictionary&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;dictionary with regular expression patterns that match some protected entity&quot;</span><span class="p">,</span>
                                    <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="s2">&quot;Mode for Anonimizer [&#39;mask&#39;|&#39;obfuscate&#39;]&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">maskingPolicy</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;maskingPolicy&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Select the masking policy:&#39;same_length_chars&#39; or &#39;entity_labels&#39;.&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">fixedMaskLength</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;fixedMaskLength&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;This is the length of the masking sequence that will be used when the &#39;fixed_length_chars&#39; masking policy is selected.&quot;</span><span class="p">,</span>
                            <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">obfuscateDate</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;obfuscateDate&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;When mode==&#39;obfuscate&#39; whether to obfuscate dates or not. This param helps in consistency to make dateFormats more visible. When setting to ``true``, make sure dateFormats param fits the needs (default: false)&quot;</span><span class="p">,</span>
                          <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">obfuscateRefFile</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;obfuscateRefFile&quot;</span><span class="p">,</span> <span class="s2">&quot;File with the terms to be used for Obfuscation&quot;</span><span class="p">,</span>
                             <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">refFileFormat</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;refFileFormat&quot;</span><span class="p">,</span> <span class="s2">&quot;Format of the reference file&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">refSep</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;refSep&quot;</span><span class="p">,</span> <span class="s2">&quot;Sep character in refFile&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">dateTag</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;dateTag&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tag representing dates in the obfuscate reference file (default: DATE)&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">days</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;days&quot;</span><span class="p">,</span> <span class="s2">&quot;Number of days to obfuscate by displacement the dates.&quot;</span><span class="p">,</span>
                 <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">dateToYear</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;dateToYear&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;True if we want the model to transform dates into years, False otherwise.&quot;</span><span class="p">,</span>
                       <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">minYear</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;minYear&quot;</span><span class="p">,</span> <span class="s2">&quot;Minimum year to be used when transforming dates into years.&quot;</span><span class="p">,</span>
                    <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">dateFormats</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;dateFormats&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;List of date formats to automatically displace if parsed&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>
    <span class="n">consistentObfuscation</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;consistentObfuscation&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;Whether to replace very similar entities in a document with the same randomized term (default: true).&quot;</span><span class="p">,</span>
                                  <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">sameEntityThreshold</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;sameEntityThreshold&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;Similarity threshold [0.0-1.0] to consider two appearances of an entity as ``the same`` (default: 0.9).&quot;</span><span class="p">,</span>
                                <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>
    <span class="n">obfuscateRefSource</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;obfuscateRefSource&quot;</span><span class="p">,</span>
                               <span class="s2">&quot;Mode for select obfuscate source [&#39;both&#39;|&#39;faker&#39;| &#39;file]&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">regexOverride</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;regexOverride&quot;</span><span class="p">,</span> <span class="s2">&quot;Prioritice regex over ner entities&quot;</span><span class="p">,</span>
                          <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">seed</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;seed&quot;</span><span class="p">,</span> <span class="s2">&quot;It is the seed to select the entities on obfuscate mode&quot;</span><span class="p">,</span>
                 <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">ignoreRegex</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;ignoreRegex&quot;</span><span class="p">,</span> <span class="s2">&quot;Select if you want to use regex&quot;</span><span class="p">,</span>
                        <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">isRandomDateDisplacement</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;isRandomDateDisplacement&quot;</span><span class="p">,</span>
                                     <span class="s2">&quot;Select if you want to use random displacement in dates&quot;</span><span class="p">,</span>
                                     <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">mappingsColumn</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;mappingsColumn&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;This is the mapping column that will return the Annotations chunks with the fake entities&quot;</span><span class="p">,</span>
                           <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">returnEntityMappings</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;returnEntityMappings&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;With this property you select if you want to return mapping column&quot;</span><span class="p">,</span>
                                 <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">blackList</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;blackList&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;List of entities ignored for masking or obfuscation.The default values are: </span><span class="se">\&quot;</span><span class="s2">SSN</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">PASSPORT</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">DLN</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">NPI</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">C_CARD</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">IBAN</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">DEA</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span>
                      <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>
    <span class="n">language</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;language&quot;</span><span class="p">,</span> <span class="s2">&quot;The language used to select the regex file and some faker entities&quot;</span><span class="p">,</span>
                     <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DeIdentification</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.deid.DeIdentification&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getBlackList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blackList</span><span class="p">)</span>

<div class="viewcode-block" id="DeIdentification.setLanguage"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setLanguage">[docs]</a>    <span class="k">def</span> <span class="nf">setLanguage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The language used to select the regex file and some faker entities.&#39;en&#39;(english),&#39;de&#39;() or &#39;es&#39;(Spanish)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        l : str</span>
<span class="sd">          The language used to select the regex file and some faker entities.&#39;en&#39;(english),&#39;de&#39;() or &#39;es&#39;(Spanish)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">language</span><span class="o">=</span><span class="n">l</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setRegexPatternsDictionary"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setRegexPatternsDictionary">[docs]</a>    <span class="k">def</span> <span class="nf">setRegexPatternsDictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">read_as</span><span class="o">=</span><span class="n">ReadAs</span><span class="o">.</span><span class="n">TEXT</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets dictionary with regular expression patterns that match some protected entity</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            Path wher is de dictionary</span>
<span class="sd">        read_as: ReadAs</span>
<span class="sd">            Format of the file</span>
<span class="sd">        options: dict</span>
<span class="sd">            Dictionary with the options to read the file.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;delimiter&quot;</span><span class="p">:</span> <span class="s2">&quot; &quot;</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">regexPatternsDictionary</span><span class="o">=</span><span class="n">ExternalResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">read_as</span><span class="p">,</span> <span class="n">options</span><span class="p">))</span></div>

<div class="viewcode-block" id="DeIdentification.setMode"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setMode">[docs]</a>    <span class="k">def</span> <span class="nf">setMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets mode for Anonimizer [&#39;mask&#39;|&#39;obfuscate&#39;]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        m : str</span>
<span class="sd">            Mode for Anonimizer [&#39;mask&#39;|&#39;obfuscate&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">m</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setMaskingPolicy"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setMaskingPolicy">[docs]</a>    <span class="k">def</span> <span class="nf">setMaskingPolicy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the masking policy:</span>
<span class="sd">            same_length_chars: Replace the obfuscated entity with a masking sequence composed of asterisks and surrounding squared brackets, being the total length of the masking sequence of the same length as the original sequence.</span>
<span class="sd">            Example, Smith -&gt; [***].</span>
<span class="sd">            If the entity is less than 3 chars (like Jo, or 5), asterisks without brackets will be returned.</span>
<span class="sd">            entity_labels: Replace the values with the corresponding entity labels.</span>
<span class="sd">            fixed_length_chars: Replace the obfuscated entity with a masking sequence composed of a fixed number of asterisks.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        m : str</span>
<span class="sd">            The masking policy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">maskingPolicy</span><span class="o">=</span><span class="n">m</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setFixedMaskLength"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setFixedMaskLength">[docs]</a>    <span class="k">def</span> <span class="nf">setFixedMaskLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Fixed mask length: this is the length of the masking sequence that will be used when the &#39;fixed_length_chars&#39; masking</span>
<span class="sd">            policy is selected.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        length : int</span>
<span class="sd">           The mask length</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">fixedMaskLength</span><span class="o">=</span><span class="n">length</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setObfuscateRefFile"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setObfuscateRefFile">[docs]</a>    <span class="k">def</span> <span class="nf">setObfuscateRefFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set file with the terms to be used for Obfuscation</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        f : str</span>
<span class="sd">            File with the terms to be used for Obfuscation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">obfuscateRefFile</span><span class="o">=</span><span class="n">f</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setRefFileFormat"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setRefFileFormat">[docs]</a>    <span class="k">def</span> <span class="nf">setRefFileFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets format of the reference file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        f : str</span>
<span class="sd">            Format of the reference file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">refFileFormat</span><span class="o">=</span><span class="n">f</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setRefSep"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setRefSep">[docs]</a>    <span class="k">def</span> <span class="nf">setRefSep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets separator character in refFile</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        f : str</span>
<span class="sd">            Separator character in refFile</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">refSep</span><span class="o">=</span><span class="n">c</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setDateTag"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setDateTag">[docs]</a>    <span class="k">def</span> <span class="nf">setDateTag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets tag representing dates in the obfuscate reference file (default: DATE)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        f : str</span>
<span class="sd">            Tag representing dates in the obfuscate reference file (default: DATE)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">dateTag</span><span class="o">=</span><span class="n">t</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setObfuscateDate"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setObfuscateDate">[docs]</a>    <span class="k">def</span> <span class="nf">setObfuscateDate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets auxiliary label which maps resolved entities to additional labels</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : str</span>
<span class="sd">            When mode==&quot;obfuscate&quot; whether to obfuscate dates or not. This param helps in consistency to make dateFormats more visible.</span>
<span class="sd">            When setting to `true`, make sure dateFormats param fits the needs (default: false)</span>
<span class="sd">            WHen setting to &#39;false&#39; then the date will be mask to &lt;DATE&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">obfuscateDate</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setDays"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setDays">[docs]</a>    <span class="k">def</span> <span class="nf">setDays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets number of days to obfuscate by displacement the dates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        d : int</span>
<span class="sd">            Number of days to obfuscate by displacement the dates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">d</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setDateToYear"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setDateToYear">[docs]</a>    <span class="k">def</span> <span class="nf">setDateToYear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets transform dates into years.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : bool</span>
<span class="sd">            True if we want the model to transform dates into years, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">dateToYear</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setMinYear"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setMinYear">[docs]</a>    <span class="k">def</span> <span class="nf">setMinYear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets minimum year to be used when transforming dates into years.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : int</span>
<span class="sd">            Minimum year to be used when transforming dates into years.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">minYear</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setDateFormats"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setDateFormats">[docs]</a>    <span class="k">def</span> <span class="nf">setDateFormats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets list of date formats to automatically displace if parsed</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            List of date formats to automatically displace if parsed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">dateFormats</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setConsistentObfuscation"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setConsistentObfuscation">[docs]</a>    <span class="k">def</span> <span class="nf">setConsistentObfuscation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to replace very similar entities in a document with the same randomized term (default: true).The similarity is based on the Levenshtein Distance between the words.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : str</span>
<span class="sd">            Whether to replace very similar entities in a document with the same randomized term .The similarity is based on the Levenshtein Distance between the words.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">consistentObfuscation</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setSameEntityThreshold"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setSameEntityThreshold">[docs]</a>    <span class="k">def</span> <span class="nf">setSameEntityThreshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets similarity threshold [0.0-1.0] to consider two appearances of an entity as `the same` (default: 0.9).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : float</span>
<span class="sd">            Similarity threshold [0.0-1.0] to consider two appearances of an entity as `the same` (default: 0.9).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">sameEntityThreshold</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setObfuscateRefSource"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setObfuscateRefSource">[docs]</a>    <span class="k">def</span> <span class="nf">setObfuscateRefSource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets mode for select obfuscate source [&#39;both&#39;|&#39;faker&#39;| &#39;file]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : str</span>
<span class="sd">            Mode for select obfuscate source [&#39;both&#39;|&#39;faker&#39;| &#39;file]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">obfuscateRefSource</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setRegexOverride"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setRegexOverride">[docs]</a>    <span class="k">def</span> <span class="nf">setRegexOverride</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to prioritize regex over ner entities</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : bool</span>
<span class="sd">            Whether to prioritize regex over ner entities</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">regexOverride</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setIgnoreRegex"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setIgnoreRegex">[docs]</a>    <span class="k">def</span> <span class="nf">setIgnoreRegex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets if you want to use regex.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : bool</span>
<span class="sd">            Whether to use regex.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">ignoreRegex</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setSeed"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setSeed">[docs]</a>    <span class="k">def</span> <span class="nf">setSeed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the seed to select the entities on obfuscate mode</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : int</span>
<span class="sd">            The seed to select the entities on obfuscate mode</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setIsRandomDateDisplacement"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setIsRandomDateDisplacement">[docs]</a>    <span class="k">def</span> <span class="nf">setIsRandomDateDisplacement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets if you want to use random displacement in dates</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : bool</span>
<span class="sd">            Boolean value to select if you want to use random displacement in dates</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">isRandomDateDisplacement</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setMappingsColumn"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setMappingsColumn">[docs]</a>    <span class="k">def</span> <span class="nf">setMappingsColumn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the name of mapping column that will return the Annotations chunks with the fake entities</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Mapping column that will return the Annotations chunks with the fake entities</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">mappingsColumn</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setReturnEntityMappings"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setReturnEntityMappings">[docs]</a>    <span class="k">def</span> <span class="nf">setReturnEntityMappings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets if you want to return mapping column</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : bool</span>
<span class="sd">            Whether to return the mappings column.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">returnEntityMappings</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentification.setBlackList"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentification.html#sparknlp_jsl.annotator.DeIdentification.setBlackList">[docs]</a>    <span class="k">def</span> <span class="nf">setBlackList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;List of entities ignored for masking or obfuscation.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : list</span>
<span class="sd">            List of entities ignored for masking or obfuscation.The default values are: values are &quot;SSN&quot;,&quot;PASSPORT&quot;,&quot;DLN&quot;,&quot;NPI&quot;,&quot;C_CARD&quot;,&quot;IBAN&quot;,&quot;DEA&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">blackList</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DeIdentificationModel</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span><span class="p">)</span></div>


<div class="viewcode-block" id="DeIdentificationModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel">[docs]</a><span class="k">class</span> <span class="nc">DeIdentificationModel</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; The DeIdentificationModel model can obfuscate or mask the entities that contains personal information. These can be set with a file of</span>
<span class="sd">    regex patterns with setRegexPatternsDictionary, where each line is a mapping of entity to regex</span>

<span class="sd">    ========================================= ======================</span>
<span class="sd">    Input Annotation types                    Output Annotation type</span>
<span class="sd">    ========================================= ======================</span>
<span class="sd">    ``DOCUMENT, CHUNK, TOKEN``                ``DOCUMENT``</span>
<span class="sd">    ========================================= ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    regexPatternsDictionary</span>
<span class="sd">        ictionary with regular expression patterns that match some protected entity</span>
<span class="sd">    mode</span>
<span class="sd">        Mode for Anonimizer [&#39;mask&#39;|&#39;obfuscate&#39;]</span>
<span class="sd">    obfuscateDate</span>
<span class="sd">        When mode==&#39;obfuscate&#39; whether to obfuscate dates or not. This param helps in consistency to make dateFormats more visible. When setting to `true`, make sure dateFormats param fits the needs (default: false)</span>
<span class="sd">    dateTag</span>
<span class="sd">        Tag representing dates in the obfuscate reference file (default: DATE)</span>
<span class="sd">    days</span>
<span class="sd">        Number of days to obfuscate the dates by displacement. If not provided a random integer between 1 and 60 will be used</span>
<span class="sd">    dateToYear</span>
<span class="sd">        True if we want the model to transform dates into years, False otherwise.</span>
<span class="sd">    minYear</span>
<span class="sd">        Minimum year to be used when transforming dates into years.</span>
<span class="sd">    dateFormats</span>
<span class="sd">        List of date formats to automatically displace if parsed</span>
<span class="sd">    consistentObfuscation</span>
<span class="sd">        Whether to replace very similar entities in a document with the same randomized term (default: true)</span>
<span class="sd">        The similarity is based on the Levenshtein Distance between the words.</span>
<span class="sd">    sameEntityThreshold</span>
<span class="sd">        Similarity threshold [0.0-1.0] to consider two appearances of an entity as `the same` (default: 0.9).</span>
<span class="sd">    obfuscateRefSource</span>
<span class="sd">        The source of obfuscation of to obfuscate the entities.For dates entities doesnt apply tha method.</span>
<span class="sd">        The values ar the following:</span>
<span class="sd">        file: Takes the entities from the obfuscatorRefFile</span>
<span class="sd">        faker: Takes the entities from the Faker module</span>
<span class="sd">        both: Takes the entities from the obfuscatorRefFile and the faker module randomly.</span>
<span class="sd">    regexOverride</span>
<span class="sd">        If is true prioritize the regex entities, if is false prioritize the ner.</span>
<span class="sd">    seed</span>
<span class="sd">        It is the seed to select the entities on obfuscate mode.With the seed you can reply a execution several times with the same ouptut.</span>
<span class="sd">    ignoreRegex</span>
<span class="sd">       Select if you want to use regex file loaded in the model.If true the default regex file will be not used.The default value is false.</span>
<span class="sd">    isRandomDateDisplacement</span>
<span class="sd">        Use a random displacement days in dates entities,that random number is based on the [[DeIdentificationParams.seed]]</span>
<span class="sd">        If true use random displacement days in dates entities,if false use the [[DeIdentificationParams.days]]</span>
<span class="sd">        The default value is false.</span>
<span class="sd">    mappingsColumn</span>
<span class="sd">        This is the mapping column that will return the Annotations chunks with the fake entities.</span>
<span class="sd">    returnEntityMappings</span>
<span class="sd">        With this property you select if you want to return mapping column</span>
<span class="sd">    blackList</span>
<span class="sd">        List of entities ignored for masking or obfuscation.The default values are: &quot;SSN&quot;,&quot;PASSPORT&quot;,&quot;DLN&quot;,&quot;NPI&quot;,&quot;C_CARD&quot;,&quot;IBAN&quot;,&quot;DEA&quot;</span>
<span class="sd">    regexEntities</span>
<span class="sd">        Keep the regex entities used in the regexPatternDictionary</span>
<span class="sd">    maskingPolicy</span>
<span class="sd">        Select the masking policy:</span>
<span class="sd">            same_length_chars: Replace the obfuscated entity with a masking sequence composed of asterisks and surrounding squared brackets, being the total length of the masking sequence of the same length as the original sequence.</span>
<span class="sd">            Example, Smith -&gt; [***].</span>
<span class="sd">            If the entity is less than 3 chars (like Jo, or 5), asterisks without brackets will be returned.</span>
<span class="sd">            entity_labels: Replace the values with the corresponding entity labels.</span>
<span class="sd">            fixed_length_chars: Replace the obfuscated entity with a masking sequence composed of a fixed number of asterisks.</span>

<span class="sd">    fixedMaskLength: this is the length of the masking sequence that will be used when the &#39;fixed_length_chars&#39; masking policy is selected.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \\</span>
<span class="sd">    ...     .setInputCol(&quot;text&quot;) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt;  sentenceDetector = SentenceDetector() \\</span>
<span class="sd">    ...     .setInputCols([&quot;document&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;sentence&quot;) \\</span>
<span class="sd">    ...     .setUseAbbreviations(True)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;]) \</span>
<span class="sd">    ...     .setOutputCol(&quot;token&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt; embeddings = WordEmbeddingsModel \</span>
<span class="sd">    ...     .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;token&quot;]) \</span>
<span class="sd">    ...     .setOutputCol(&quot;embeddings&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">     Ner entities</span>
<span class="sd">    &gt;&gt;&gt; clinical_sensitive_entities = MedicalNerModel \\</span>
<span class="sd">    ...     .pretrained(&quot;ner_deid_enriched&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;]).setOutputCol(&quot;ner&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; nerConverter = NerConverter() \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;ner_con&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">     Deidentification</span>
<span class="sd">    &gt;&gt;&gt; deIdentification = DeIdentificationModel.pretrained(&quot;deidentify_large&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...     .setInputCols([&quot;ner_chunk&quot;, &quot;token&quot;, &quot;sentence&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;dei&quot;) \\</span>
<span class="sd">    ...     .setMode(&quot;obfuscate&quot;) \\</span>
<span class="sd">    ...     .setDateFormats(Array(&quot;MM/dd/yy&quot;,&quot;yyyy-MM-dd&quot;)) \\</span>
<span class="sd">    ...     .setObfuscateDate(True) \\</span>
<span class="sd">    ...     .setDateTag(&quot;DATE&quot;) \\</span>
<span class="sd">    ...     .setDays(5) \\</span>
<span class="sd">    ...     .setObfuscateRefSource(&quot;both&quot;)</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([</span>
<span class="sd">    ...     [&quot;# 7194334 Date : 01/13/93 PCP : Oliveira , 25 years-old , Record date : 2079-11-09.&quot;]</span>
<span class="sd">    ...     ]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline(stages=[</span>
<span class="sd">    ...     documentAssembler,</span>
<span class="sd">    ...     sentenceDetector,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     embeddings,</span>
<span class="sd">    ...     clinical_sensitive_entities,</span>
<span class="sd">    ...     nerConverter,</span>
<span class="sd">    ...     deIdentification</span>
<span class="sd">    ... ])</span>
<span class="sd">    &gt;&gt;&gt; result = pipeline.fit(data).transform(data)</span>
<span class="sd">    &gt;&gt;&gt; result.select(&quot;dei.result&quot;).show(truncate = False)</span>
<span class="sd">     +--------------------------------------------------------------------------------------------------+</span>
<span class="sd">     |result                                                                                            |</span>
<span class="sd">     +--------------------------------------------------------------------------------------------------+</span>
<span class="sd">     |[# 01010101 Date : 01/18/93 PCP : Dr. Gregory House , &lt;AGE&gt; years-old , Record date : 2079-11-14.]|</span>
<span class="sd">     +--------------------------------------------------------------------------------------------------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;DeIdentificationModel&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.deid.DeIdentificationModel&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DeIdentificationModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>

    <span class="n">dateFormats</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;dateFormats&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;List of date formats to automatically displace if parsed&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

    <span class="n">mode</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="s2">&quot;Mode for Anonimizer [&#39;mask&#39;|&#39;ofuscate&#39;]&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">maskingPolicy</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;maskingPolicy&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Select the masking policy:&#39;same_length_chars&#39; or &#39;entity_labels&#39;.&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">fixedMaskLength</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;fixedMaskLength&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;This is the length of the masking sequence that will be used when the &#39;fixed_length_chars&#39; masking policy is selected.&quot;</span><span class="p">,</span>
                            <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">obfuscateDate</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;obfuscateDate&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;When mode==&#39;obfuscate&#39; whether to obfuscate dates or not. This param helps in consistency to make dateFormats more visible. When setting to `true`, make sure dateFormats param fits the needs (default: false)&quot;</span><span class="p">,</span>
                          <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">dateTag</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;dateTag&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tag representing dates in the obfuscate reference file (default: DATE)&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">days</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;days&quot;</span><span class="p">,</span> <span class="s2">&quot;Number of days to obfuscate by displacement the dates.&quot;</span><span class="p">,</span>
                 <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">dateToYear</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;dateToYear&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Y if we want the model to transform dates into years, N otherwise.&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">minYear</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;minYear&quot;</span><span class="p">,</span> <span class="s2">&quot;Minimum year to be used when transforming dates into years.&quot;</span><span class="p">,</span>
                    <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">dateFormats</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;dateFormats&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;List of date formats to automatically displace if parsed&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>
    <span class="n">consistentObfuscation</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;consistentObfuscation&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;Whether to replace very similar entities in a document with the same randomized term (default: true).&quot;</span><span class="p">,</span>
                                  <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">sameEntityThreshold</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;sameEntityThreshold&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;Similarity threshold [0.0-1.0] to consider two appearances of an entity as `the same` (default: 0.9).&quot;</span><span class="p">,</span>
                                <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>
    <span class="n">obfuscateRefSource</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;obfuscateRefSource&quot;</span><span class="p">,</span>
                               <span class="s2">&quot;Mode for select obfuscate source [&#39;both&#39;|&#39;faker&#39;| &#39;file]&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">regexOverride</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;regexOverride&quot;</span><span class="p">,</span> <span class="s2">&quot;Prioritice regex over ner entities&quot;</span><span class="p">,</span>
                          <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">seed</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;seed&quot;</span><span class="p">,</span> <span class="s2">&quot;It is the seed to select the entities on obfuscate mode&quot;</span><span class="p">,</span>
                 <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">ignoreRegex</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;ignoreRegex&quot;</span><span class="p">,</span> <span class="s2">&quot;Select if you want to use regex&quot;</span><span class="p">,</span>
                        <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">isRandomDateDisplacement</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;isRandomDateDisplacement&quot;</span><span class="p">,</span>
                                     <span class="s2">&quot;Select if you want to use random displacement in dates&quot;</span><span class="p">,</span>
                                     <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">mappingsColumn</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;mappingsColumn&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;This is the mapping column that will return the Annotations chunks with the fake entities&quot;</span><span class="p">,</span>
                           <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">returnEntityMappings</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;returnEntityMappings&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;With this property you select if you want to return mapping column&quot;</span><span class="p">,</span>
                                 <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">blackList</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;blackList&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;List of entities ignored for masking or obfuscation.The default values are: </span><span class="se">\&quot;</span><span class="s2">SSN</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">PASSPORT</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">DLN</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">NPI</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">C_CARD</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">IBAN</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">DEA</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span>
                      <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

    <span class="n">regexEntities</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;regexEntities&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Keep the regex entities used in the regexPatternDictionary&quot;</span><span class="p">,</span>
                          <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="s2">&quot;Mode for Anonimizer [&#39;mask&#39;|&#39;ofuscate&#39;]&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">language</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;language&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;The language used to select the regex file and some faker entities.&#39;en&#39;(english),&#39;de&#39;() or &#39;es&#39;(Spanish)&quot;</span><span class="p">,</span>
                     <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getBlackList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blackList</span><span class="p">)</span>

<div class="viewcode-block" id="DeIdentificationModel.setLanguage"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setLanguage">[docs]</a>    <span class="k">def</span> <span class="nf">setLanguage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The language used to select the regex file and some faker entities.&#39;en&#39;(english),&#39;de&#39;() or &#39;es&#39;(Spanish)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        l : str</span>
<span class="sd">          The language used to select the regex file and some faker entities.&#39;en&#39;(english),&#39;de&#39;() or &#39;es&#39;(Spanish)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">language</span><span class="o">=</span><span class="n">l</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setMode"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setMode">[docs]</a>    <span class="k">def</span> <span class="nf">setMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets mode for Anonimizer [&#39;mask&#39;|&#39;obfuscate&#39;]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        m : str</span>
<span class="sd">            Mode for Anonimizer [&#39;mask&#39;|&#39;obfuscate&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">m</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setMaskingPolicy"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setMaskingPolicy">[docs]</a>    <span class="k">def</span> <span class="nf">setMaskingPolicy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the masking policy:</span>
<span class="sd">            same_length_chars: Replace the obfuscated entity with a masking sequence composed of asterisks and surrounding squared brackets, being the total length of the masking sequence of the same length as the original sequence.</span>
<span class="sd">            Example, Smith -&gt; [***].</span>
<span class="sd">            If the entity is less than 3 chars (like Jo, or 5), asterisks without brackets will be returned.</span>
<span class="sd">            entity_labels: Replace the values with the corresponding entity labels.</span>
<span class="sd">            fixed_length_chars: Replace the obfuscated entity with a masking sequence composed of a fixed number of asterisks.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        m : str</span>
<span class="sd">            The masking policy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">maskingPolicy</span><span class="o">=</span><span class="n">m</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setFixedMaskLength"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setFixedMaskLength">[docs]</a>    <span class="k">def</span> <span class="nf">setFixedMaskLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Fixed mask length: this is the length of the masking sequence that will be used when the &#39;fixed_length_chars&#39; masking</span>
<span class="sd">            policy is selected.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        length : int</span>
<span class="sd">           The mask length</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">fixedMaskLength</span><span class="o">=</span><span class="n">length</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setDateTag"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setDateTag">[docs]</a>    <span class="k">def</span> <span class="nf">setDateTag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set file with the terms to be used for Obfuscation</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        f : str</span>
<span class="sd">            File with the terms to be used for Obfuscation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">dateTag</span><span class="o">=</span><span class="n">t</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setObfuscateDate"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setObfuscateDate">[docs]</a>    <span class="k">def</span> <span class="nf">setObfuscateDate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets auxiliary label which maps resolved entities to additional labels</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : str</span>
<span class="sd">            When mode==&quot;obfuscate&quot; whether to obfuscate dates or not. This param helps in consistency to make dateFormats more visible.</span>
<span class="sd">            When setting to `true`, make sure dateFormats param fits the needs (default: false)</span>
<span class="sd">            WHen setting to &#39;false&#39; then the date will be mask to &lt;DATE&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">obfuscateDate</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setDays"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setDays">[docs]</a>    <span class="k">def</span> <span class="nf">setDays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets number of days to obfuscate by displacement the dates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        d : int</span>
<span class="sd">            Number of days to obfuscate by displacement the dates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">d</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setDateToYear"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setDateToYear">[docs]</a>    <span class="k">def</span> <span class="nf">setDateToYear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets transform dates into years.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : bool</span>
<span class="sd">            True if we want the model to transform dates into years, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">dateToYear</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setMinYear"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setMinYear">[docs]</a>    <span class="k">def</span> <span class="nf">setMinYear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets minimum year to be used when transforming dates into years.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : int</span>
<span class="sd">            Minimum year to be used when transforming dates into years.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">minYear</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setDateFormats"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setDateFormats">[docs]</a>    <span class="k">def</span> <span class="nf">setDateFormats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets list of date formats to automatically displace if parsed</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : str</span>
<span class="sd">            List of date formats to automatically displace if parsed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">dateFormats</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setConsistentObfuscation"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setConsistentObfuscation">[docs]</a>    <span class="k">def</span> <span class="nf">setConsistentObfuscation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to replace very similar entities in a document with the same randomized term (default: true).The similarity is based on the Levenshtein Distance between the words.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : str</span>
<span class="sd">            Whether to replace very similar entities in a document with the same randomized term (default: true).The similarity is based on the Levenshtein Distance between the words.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">consistentObfuscation</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setSameEntityThreshold"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setSameEntityThreshold">[docs]</a>    <span class="k">def</span> <span class="nf">setSameEntityThreshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets similarity threshold [0.0-1.0] to consider two appearances of an entity as `the same` (default: 0.9).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : float</span>
<span class="sd">            Similarity threshold [0.0-1.0] to consider two appearances of an entity as `the same` (default: 0.9).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">sameEntityThreshold</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setObfuscateRefSource"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setObfuscateRefSource">[docs]</a>    <span class="k">def</span> <span class="nf">setObfuscateRefSource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets mode for select obfuscate source [&#39;both&#39;|&#39;faker&#39;| &#39;file]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : str</span>
<span class="sd">            Mode for select obfuscate source [&#39;both&#39;|&#39;faker&#39;| &#39;file]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">obfuscateRefSource</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setRegexOverride"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setRegexOverride">[docs]</a>    <span class="k">def</span> <span class="nf">setRegexOverride</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to prioritize regex over ner entities</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : bool</span>
<span class="sd">            Whether to prioritize regex over ner entities</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">regexOverride</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setSeed"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setSeed">[docs]</a>    <span class="k">def</span> <span class="nf">setSeed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the seed to select the entities on obfuscate mode</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : int</span>
<span class="sd">            The seed to select the entities on obfuscate mode</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setIgnoreRegex"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setIgnoreRegex">[docs]</a>    <span class="k">def</span> <span class="nf">setIgnoreRegex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets if you want to use regex.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : bool</span>
<span class="sd">            Whether to use regex.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">ignoreRegex</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setIsRandomDateDisplacement"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setIsRandomDateDisplacement">[docs]</a>    <span class="k">def</span> <span class="nf">setIsRandomDateDisplacement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets if you want to use random displacement in dates</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : bool</span>
<span class="sd">            Boolean value to select if you want to use random displacement in dates</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">isRandomDateDisplacement</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setMappingsColumn"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setMappingsColumn">[docs]</a>    <span class="k">def</span> <span class="nf">setMappingsColumn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the name of mapping column that will return the Annotations chunks with the fake entities</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Mapping column that will return the Annotations chunks with the fake entities</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">mappingsColumn</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setBlackList"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setBlackList">[docs]</a>    <span class="k">def</span> <span class="nf">setBlackList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;List of entities ignored for masking or obfuscation.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : list</span>
<span class="sd">            List of entities ignored for masking or obfuscation.The default values are: &quot;SSN&quot;,&quot;PASSPORT&quot;,&quot;DLN&quot;,&quot;NPI&quot;,&quot;C_CARD&quot;,&quot;IBAN&quot;,&quot;DEA&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">blackList</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeIdentificationModel.setReturnEntityMappings"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DeIdentificationModel.html#sparknlp_jsl.annotator.DeIdentificationModel.setReturnEntityMappings">[docs]</a>    <span class="k">def</span> <span class="nf">setReturnEntityMappings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets if you want to return mapping column</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : bool</span>
<span class="sd">            Whether to save the mappings column.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">returnEntityMappings</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">getRegexEntities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regexEntities</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp.pretrained</span> <span class="kn">import</span> <span class="n">ResourceDownloader</span>
        <span class="k">return</span> <span class="n">ResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">DeIdentificationModel</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="ReIdentification"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ReIdentification.html#sparknlp_jsl.annotator.ReIdentification">[docs]</a><span class="k">class</span> <span class="nc">ReIdentification</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ReDeideintification&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.deid.ReIdentification&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ReIdentification</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="NerDisambiguator"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguator.html#sparknlp_jsl.annotator.NerDisambiguator">[docs]</a><span class="k">class</span> <span class="nc">NerDisambiguator</span><span class="p">(</span><span class="n">AnnotatorApproach</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Links words of interest, such as names of persons, locations and companies, from an input text document to</span>
<span class="sd">    a corresponding unique entity in a target Knowledge Base (KB). Words of interest are called Named Entities (NEs),</span>
<span class="sd">    mentions, or surface forms.</span>
<span class="sd">    Instantiated / pretrained model of the NerDisambiguator.</span>
<span class="sd">    Links words of interest, such as names of persons, locations and companies, from an input text document to</span>
<span class="sd">    a corresponding unique entity in a target Knowledge Base (KB). Words of interest are called Named Entities (NEs),</span>

<span class="sd">    ========================================= ======================</span>
<span class="sd">    Input Annotation types                    Output Annotation type</span>
<span class="sd">    ========================================= ======================</span>
<span class="sd">    ``CHUNK, SENTENCE_EMBEDDINGS``            ``DISAMBIGUATION``</span>
<span class="sd">    ========================================= ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    embeddingTypeParam</span>
<span class="sd">        Could be &#39;bow&#39; for word embeddings or &#39;sentence&#39; for sentences</span>
<span class="sd">    numFirstChars</span>
<span class="sd">        How many characters should be considered for initial prefix search in knowledge base</span>
<span class="sd">    tokenSearch</span>
<span class="sd">        Should we search by token or by chunk in knowledge base (token is recommended)</span>
<span class="sd">    narrowWithApproximateMatching</span>
<span class="sd">        Should we narrow prefix search results with levenstein distance based matching (true is recommended)</span>
<span class="sd">    levenshteinDistanceThresholdParam</span>
<span class="sd">        Levenshtein distance threshold to narrow results from prefix search (0.1 is default)</span>
<span class="sd">    nearMatchingGapParam</span>
<span class="sd">        Puts a limit on a string length (by trimming the candidate chunks) during levenshtein-distance based narrowing,len(candidate) - len(entity chunk) &gt; nearMatchingGap (Default: 4).</span>
<span class="sd">    predictionsLimit</span>
<span class="sd">        Limit on amount of predictions N for topN predictions</span>
<span class="sd">    s3KnowledgeBaseName</span>
<span class="sd">        knowledge base name in s3</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;The show also had a contestant named Donald Trump who later defeated Christina Aguilera ...&quot;]]) \</span>
<span class="sd">    ...   .toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \\</span>
<span class="sd">    ...   .setInputCol(&quot;text&quot;) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentenceDetector = SentenceDetector() \\</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \\</span>
<span class="sd">    ...   .setInputCols([&quot;sentence&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;token&quot;)</span>
<span class="sd">    &gt;&gt;&gt; word_embeddings = WordEmbeddingsModel.pretrained() \\</span>
<span class="sd">    ...   .setInputCols([&quot;sentence&quot;, &quot;token&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;embeddings&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentence_embeddings = SentenceEmbeddings() \\</span>
<span class="sd">    ...   .setInputCols([&quot;sentence&quot;,&quot;embeddings&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;sentence_embeddings&quot;)\</span>
<span class="sd">    &gt;&gt;&gt; ner_model = NerDLModel.pretrained() \\</span>
<span class="sd">    ...   .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;ner&quot;)</span>
<span class="sd">    &gt;&gt;&gt; ner_converter = NerConverter() \\</span>
<span class="sd">    ...   .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;ner_chunk&quot;) \\</span>
<span class="sd">    ...   .setWhiteList([&quot;PER&quot;])</span>

<span class="sd">    Then the extracted entities can be disambiguated.</span>
<span class="sd">    &gt;&gt;&gt; disambiguator = NerDisambiguator() \\</span>
<span class="sd">    ...   .setS3KnowledgeBaseName(&quot;i-per&quot;) \\</span>
<span class="sd">    ...   .setInputCols([&quot;ner_chunk&quot;, &quot;sentence_embeddings&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;disambiguation&quot;) \\</span>
<span class="sd">    ...   .setNumFirstChars(5)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; nlpPipeline = Pipeline(stages=[</span>
<span class="sd">    ...   documentAssembler,</span>
<span class="sd">    ...   sentenceDetector,</span>
<span class="sd">    ...   tokenizer,</span>
<span class="sd">    ...   word_embeddings,</span>
<span class="sd">    ...   sentence_embeddings,</span>
<span class="sd">    ...   ner_model,</span>
<span class="sd">    ...   ner_converter,</span>
<span class="sd">    ...   disambiguator])</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; model = nlpPipeline.fit(data)</span>
<span class="sd">    &gt;&gt;&gt; result = model.transform(data)</span>
<span class="sd">    &gt;&gt;&gt; result.selectExpr(&quot;explode(disambiguation)&quot;) \\</span>
<span class="sd">    ...  .selectExpr(&quot;col.metadata.chunk as chunk&quot;, &quot;col.result as result&quot;).show(5, False)</span>

<span class="sd">    +------------------+------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">    |chunk             |result                                                                                                                  |</span>
<span class="sd">    +------------------+------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">    |Donald Trump      |http:#en.wikipedia.org/?curid=4848272, http:#en.wikipedia.org/?curid=31698421, http:#en.wikipedia.org/?curid=55907961   |</span>
<span class="sd">    |Christina Aguilera|http:#en.wikipedia.org/?curid=144171, http:#en.wikipedia.org/?curid=6636454                                             |</span>
<span class="sd">    +------------------+------------------------------------------------------------------------------------------------------------------------+</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">embeddingTypeParam</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                               <span class="s2">&quot;embeddingTypeParam&quot;</span><span class="p">,</span>
                               <span class="s2">&quot;Could be &#39;bow&#39; for word embeddings or &#39;sentence&#39; for sentences&quot;</span><span class="p">,</span>
                               <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">numFirstChars</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                          <span class="s2">&quot;numFirstChars&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;How many characters should be considered for initial prefix search in knowledge base&quot;</span><span class="p">,</span>
                          <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">tokenSearch</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                        <span class="s2">&quot;tokenSearch&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Should we search by token or by chunk in knowledge base (token is recommended)&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">narrowWithApproximateMatching</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                          <span class="s2">&quot;narrowWithApproximateMatching&quot;</span><span class="p">,</span>
                                          <span class="s2">&quot;Should we narrow prefix search results with levenstein distance based matching (true is recommended)&quot;</span><span class="p">,</span>
                                          <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">levenshteinDistanceThresholdParam</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                              <span class="s2">&quot;levenshteinDistanceThresholdParam&quot;</span><span class="p">,</span>
                                              <span class="s2">&quot;Levenshtein distance threshold to narrow results from prefix search (0.1 is default)&quot;</span><span class="p">,</span>
                                              <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>

    <span class="n">nearMatchingGapParam</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                 <span class="s2">&quot;nearMatchingGapParam&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;Puts a limit on a string length (by trimming the candidate chunks) during levenshtein-distance based narrowing&quot;</span><span class="p">,</span>
                                 <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">predictionsLimit</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                             <span class="s2">&quot;predictionsLimit&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;Limit on amount of predictions N for topN predictions&quot;</span><span class="p">,</span>
                             <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">s3KnowledgeBaseName</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                <span class="s2">&quot;s3KnowledgeBaseName&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;knowledge base name in s3&quot;</span><span class="p">,</span>
                                <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

<div class="viewcode-block" id="NerDisambiguator.setEmbeddingType"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguator.html#sparknlp_jsl.annotator.NerDisambiguator.setEmbeddingType">[docs]</a>    <span class="k">def</span> <span class="nf">setEmbeddingType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets if we want to use &#39;bow&#39; for word embeddings or &#39;sentence&#39; for sentences&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : str</span>
<span class="sd">            Can be &#39;bow&#39; for word embeddings or &#39;sentence&#39; for sentences (Default: sentence)</span>
<span class="sd">            Can be &#39;bow&#39; for word embeddings or &#39;sentence&#39; for sentences (Default: sentence)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">embeddingTypeParam</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerDisambiguator.setNumFirstChars"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguator.html#sparknlp_jsl.annotator.NerDisambiguator.setNumFirstChars">[docs]</a>    <span class="k">def</span> <span class="nf">setNumFirstChars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;How many characters should be considered for initial prefix search in knowledge base</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            How many characters should be considered for initial prefix search in knowledge base</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">numFirstChars</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerDisambiguator.setTokenSearch"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguator.html#sparknlp_jsl.annotator.NerDisambiguator.setTokenSearch">[docs]</a>    <span class="k">def</span> <span class="nf">setTokenSearch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to search by token or by chunk in knowledge base (Default: true)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether to search by token or by chunk in knowledge base (Default: true)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">tokenSearch</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerDisambiguator.setNarrowWithApproximateMatching"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguator.html#sparknlp_jsl.annotator.NerDisambiguator.setNarrowWithApproximateMatching">[docs]</a>    <span class="k">def</span> <span class="nf">setNarrowWithApproximateMatching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to narrow prefix search results with levenstein distance based matching (Default: true)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">           Whether to narrow prefix search results with levenstein distance based matching (Default: true)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">narrowWithApproximateMatching</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerDisambiguator.setLevenshteinDistanceThresholdParam"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguator.html#sparknlp_jsl.annotator.NerDisambiguator.setLevenshteinDistanceThresholdParam">[docs]</a>    <span class="k">def</span> <span class="nf">setLevenshteinDistanceThresholdParam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets Levenshtein distance threshold to narrow results from prefix search (0.1 is default)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            Levenshtein distance threshold to narrow results from prefix search (0.1 is default)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">levenshteinDistanceThresholdParam</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerDisambiguator.setNearMatchingGapParam"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguator.html#sparknlp_jsl.annotator.NerDisambiguator.setNearMatchingGapParam">[docs]</a>    <span class="k">def</span> <span class="nf">setNearMatchingGapParam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets a limit on a string length (by trimming the candidate chunks) during levenshtein-distance based narrowing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">             Limit on a string length (by trimming the candidate chunks) during levenshtein-distance based narrowing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">nearMatchingGapParam</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerDisambiguator.setPredictionLimit"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguator.html#sparknlp_jsl.annotator.NerDisambiguator.setPredictionLimit">[docs]</a>    <span class="k">def</span> <span class="nf">setPredictionLimit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets limit on amount of predictions N for topN predictions</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">             Limit on amount of predictions N for topN predictions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">predictionsLimit</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerDisambiguator.setS3KnowledgeBaseName"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguator.html#sparknlp_jsl.annotator.NerDisambiguator.setS3KnowledgeBaseName">[docs]</a>    <span class="k">def</span> <span class="nf">setS3KnowledgeBaseName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets knowledge base name in s3</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : str</span>
<span class="sd">            knowledge base name in s3 example (i-per)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">s3KnowledgeBaseName</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NerDisambiguator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.disambiguation.NerDisambiguator&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span><span class="n">numFirstChars</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">tokenSearch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">levenshteinDistanceThresholdParam</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                         <span class="n">nearMatchingGapParam</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">narrowWithApproximateMatching</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">predictionsLimit</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                         <span class="n">embeddingTypeParam</span><span class="o">=</span><span class="s2">&quot;sentence&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">NerDisambiguatorModel</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span><span class="p">)</span></div>


<div class="viewcode-block" id="NerDisambiguatorModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguatorModel.html#sparknlp_jsl.annotator.NerDisambiguatorModel">[docs]</a><span class="k">class</span> <span class="nc">NerDisambiguatorModel</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Links words of interest, such as names of persons, locations and companies, from an input text document to</span>
<span class="sd">    a corresponding unique entity in a target Knowledge Base (KB). Words of interest are called Named Entities (NEs),</span>
<span class="sd">    mentions, or surface forms.</span>
<span class="sd">    Instantiated / pretrained model of the NerDisambiguator.</span>
<span class="sd">    Links words of interest, such as names of persons, locations and companies, from an input text document to</span>
<span class="sd">    a corresponding unique entity in a target Knowledge Base (KB). Words of interest are called Named Entities (NEs),</span>

<span class="sd">    ========================================= ======================</span>
<span class="sd">    Input Annotation types                    Output Annotation type</span>
<span class="sd">    ========================================= ======================</span>
<span class="sd">     ``CHUNK, SENTENCE_EMBEDDINGS``           ``DISAMBIGUATION``</span>
<span class="sd">    ========================================= ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    embeddingTypeParam</span>
<span class="sd">        Could be ``bow`` for word embeddings or ``sentence`` for sentences</span>
<span class="sd">    numFirstChars</span>
<span class="sd">        How many characters should be considered for initial prefix search in knowledge base</span>
<span class="sd">    tokenSearch</span>
<span class="sd">        Should we search by token or by chunk in knowledge base (token is recommended)</span>
<span class="sd">    narrowWithApproximateMatching</span>
<span class="sd">        Should we narrow prefix search results with levenstein distance based matching (true is recommended)</span>
<span class="sd">    levenshteinDistanceThresholdParam</span>
<span class="sd">        Levenshtein distance threshold to narrow results from prefix search (0.1 is default)</span>
<span class="sd">    nearMatchingGapParam</span>
<span class="sd">        Puts a limit on a string length (by trimming the candidate chunks) during levenshtein-distance based narrowing,len(candidate) - len(entity chunk) &gt; nearMatchingGap (Default: 4).</span>
<span class="sd">    predictionsLimit</span>
<span class="sd">        Limit on amount of predictions N for topN predictions</span>
<span class="sd">    s3KnowledgeBaseName</span>
<span class="sd">        knowledge base name in s3</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;The show also had a contestant named Donald Trump who later defeated Christina Aguilera ...&quot;]]) \</span>
<span class="sd">    ...   .toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \\</span>
<span class="sd">    ...   .setInputCol(&quot;text&quot;) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentenceDetector = SentenceDetector() \\</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \\</span>
<span class="sd">    ...   .setInputCols([&quot;sentence&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;token&quot;)</span>
<span class="sd">    &gt;&gt;&gt; word_embeddings = WordEmbeddingsModel.pretrained() \\</span>
<span class="sd">    ...   .setInputCols([&quot;sentence&quot;, &quot;token&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;embeddings&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentence_embeddings = SentenceEmbeddings() \\</span>
<span class="sd">    ...   .setInputCols([&quot;sentence&quot;,&quot;embeddings&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;sentence_embeddings&quot;)\</span>
<span class="sd">    &gt;&gt;&gt; ner_model = NerDLModel.pretrained() \\</span>
<span class="sd">    ...   .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;ner&quot;)</span>
<span class="sd">    &gt;&gt;&gt; ner_converter = NerConverter() \\</span>
<span class="sd">    ...   .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;ner_chunk&quot;) \\</span>
<span class="sd">    ...   .setWhiteList([&quot;PER&quot;])</span>

<span class="sd">    Then the extracted entities can be disambiguated.</span>
<span class="sd">    &gt;&gt;&gt; disambiguator = NerDisambiguatorModel.pretrained() \\</span>
<span class="sd">    ...   .setInputCols([&quot;ner_chunk&quot;, &quot;sentence_embeddings&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;disambiguation&quot;) \\</span>
<span class="sd">    ...   .setNumFirstChars(5)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; nlpPipeline = Pipeline(stages=[</span>
<span class="sd">    ...   documentAssembler,</span>
<span class="sd">    ...   sentenceDetector,</span>
<span class="sd">    ...   tokenizer,</span>
<span class="sd">    ...   word_embeddings,</span>
<span class="sd">    ...   sentence_embeddings,</span>
<span class="sd">    ...   ner_model,</span>
<span class="sd">    ...   ner_converter,</span>
<span class="sd">    ...   disambiguator])</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; model = nlpPipeline.fit(data)</span>
<span class="sd">    &gt;&gt;&gt; result = model.transform(data)</span>
<span class="sd">    &gt;&gt;&gt; result.selectExpr(&quot;explode(disambiguation)&quot;) \\</span>
<span class="sd">    ...  .selectExpr(&quot;col.metadata.chunk as chunk&quot;, &quot;col.result as result&quot;).show(5, False)</span>

<span class="sd">    +------------------+------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">    |chunk             |result                                                                                                                  |</span>
<span class="sd">    +------------------+------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">    |Donald Trump      |http:#en.wikipedia.org/?curid=4848272, http:#en.wikipedia.org/?curid=31698421, http:#en.wikipedia.org/?curid=55907961   |</span>
<span class="sd">    |Christina Aguilera|http:#en.wikipedia.org/?curid=144171, http:#en.wikipedia.org/?curid=6636454                                             |</span>
<span class="sd">    +------------------+------------------------------------------------------------------------------------------------------------------------+</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;NerDisambiguatorModel&quot;</span>

    <span class="n">embeddingTypeParam</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                               <span class="s2">&quot;embeddingTypeParam&quot;</span><span class="p">,</span>
                               <span class="s2">&quot;Could be &#39;bow&#39; for word embeddings or &#39;sentence&#39; for sentences&quot;</span><span class="p">,</span>
                               <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">numFirstChars</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                          <span class="s2">&quot;numFirstChars&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;How many characters should be considered for initial prefix search in knowledge base&quot;</span><span class="p">,</span>
                          <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">tokenSearch</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                        <span class="s2">&quot;tokenSearch&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Should we search by token or by chunk in knowledge base (token is recommended)&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">narrowWithApproximateMatching</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                          <span class="s2">&quot;narrowWithApproximateMatching&quot;</span><span class="p">,</span>
                                          <span class="s2">&quot;Should we narrow prefix search results with levenstein distance based matching (true is recommended)&quot;</span><span class="p">,</span>
                                          <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">levenshteinDistanceThresholdParam</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                              <span class="s2">&quot;levenshteinDistanceThresholdParam&quot;</span><span class="p">,</span>
                                              <span class="s2">&quot;Levenshtein distance threshold to narrow results from prefix search (0.1 is default)&quot;</span><span class="p">,</span>
                                              <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>

    <span class="n">nearMatchingGapParam</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                 <span class="s2">&quot;nearMatchingGapParam&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;Levenshtein distance threshold to narrow results from prefix search (0.1 is default)&quot;</span><span class="p">,</span>
                                 <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">predictionsLimit</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                             <span class="s2">&quot;predictionsLimit&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;Limit on amount of predictions N for topN predictions&quot;</span><span class="p">,</span>
                             <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

<div class="viewcode-block" id="NerDisambiguatorModel.setEmbeddingType"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguatorModel.html#sparknlp_jsl.annotator.NerDisambiguatorModel.setEmbeddingType">[docs]</a>    <span class="k">def</span> <span class="nf">setEmbeddingType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets if we want to use &#39;bow&#39; for word embeddings or &#39;sentence&#39; for sentences</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : str</span>
<span class="sd">            Can be &#39;bow&#39; for word embeddings or &#39;sentence&#39; for sentences (Default: sentence)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">embeddingTypeParam</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerDisambiguatorModel.setNumFirstChars"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguatorModel.html#sparknlp_jsl.annotator.NerDisambiguatorModel.setNumFirstChars">[docs]</a>    <span class="k">def</span> <span class="nf">setNumFirstChars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;How many characters should be considered for initial prefix search in knowledge base</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            How many characters should be considered for initial prefix search in knowledge base</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">numFirstChars</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerDisambiguatorModel.setTokenSearch"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguatorModel.html#sparknlp_jsl.annotator.NerDisambiguatorModel.setTokenSearch">[docs]</a>    <span class="k">def</span> <span class="nf">setTokenSearch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to search by token or by chunk in knowledge base (Default: true)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether to search by token or by chunk in knowledge base (Default: true)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">tokenSearch</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerDisambiguatorModel.setNarrowWithApproximateMatching"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguatorModel.html#sparknlp_jsl.annotator.NerDisambiguatorModel.setNarrowWithApproximateMatching">[docs]</a>    <span class="k">def</span> <span class="nf">setNarrowWithApproximateMatching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to narrow prefix search results with levenstein distance based matching (Default: true)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">           Whether to narrow prefix search results with levenstein distance based matching (Default: true)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">narrowWithApproximateMatching</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerDisambiguatorModel.setLevenshteinDistanceThresholdParam"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguatorModel.html#sparknlp_jsl.annotator.NerDisambiguatorModel.setLevenshteinDistanceThresholdParam">[docs]</a>    <span class="k">def</span> <span class="nf">setLevenshteinDistanceThresholdParam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets Levenshtein distance threshold to narrow results from prefix search (0.1 is default)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            Levenshtein distance threshold to narrow results from prefix search (0.1 is default)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">levenshteinDistanceThresholdParam</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerDisambiguatorModel.setNearMatchingGapParam"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguatorModel.html#sparknlp_jsl.annotator.NerDisambiguatorModel.setNearMatchingGapParam">[docs]</a>    <span class="k">def</span> <span class="nf">setNearMatchingGapParam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets a limit on a string length (by trimming the candidate chunks) during levenshtein-distance based narrowing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">             Limit on a string length (by trimming the candidate chunks) during levenshtein-distance based narrowing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">nearMatchingGapParam</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerDisambiguatorModel.setPredictionLimit"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerDisambiguatorModel.html#sparknlp_jsl.annotator.NerDisambiguatorModel.setPredictionLimit">[docs]</a>    <span class="k">def</span> <span class="nf">setPredictionLimit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets limit on amount of predictions N for topN predictions</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : bool</span>
<span class="sd">             Limit on amount of predictions N for topN predictions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">predictionsLimit</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.disambiguation.NerDisambiguatorModel&quot;</span><span class="p">,</span>
                 <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NerDisambiguatorModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;disambiguator_per&quot;</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp.pretrained</span> <span class="kn">import</span> <span class="n">ResourceDownloader</span>
        <span class="k">return</span> <span class="n">ResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">NerDisambiguatorModel</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="s2">&quot;clinical/models&quot;</span><span class="p">,</span>
                                                <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="ContextualParserApproach"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ContextualParserApproach.html#sparknlp_jsl.annotator.ContextualParserApproach">[docs]</a><span class="k">class</span> <span class="nc">ContextualParserApproach</span><span class="p">(</span><span class="n">AnnotatorApproach</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Creates a model, that extracts entity from a document based on user defined rules.</span>
<span class="sd">    Rule matching is based on a RegexMatcher defined in a JSON file. It is set through the parameter setJsonPath()</span>
<span class="sd">    In this JSON file, regex is defined that you want to match along with the information that will output on metadata</span>
<span class="sd">    field. Additionally, a dictionary can be provided with ``setDictionary`` to map extracted entities</span>
<span class="sd">    to a unified representation. The first column of the dictionary file should be the representation with following</span>
<span class="sd">    columns the possible matches.</span>

<span class="sd">    ========================================= ======================</span>
<span class="sd">    Input Annotation types                    Output Annotation type</span>
<span class="sd">    ========================================= ======================</span>
<span class="sd">    ``DOCUMENT, TOKEN``                       ``CHUNK``</span>
<span class="sd">    ========================================= ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    jsonPath</span>
<span class="sd">        Path to json file with rules</span>
<span class="sd">    caseSensitive</span>
<span class="sd">        Whether to use case sensitive when matching values</span>
<span class="sd">    prefixAndSuffixMatch</span>
<span class="sd">        Whether to match both prefix and suffix to annotate the hit</span>
<span class="sd">    dictionary</span>
<span class="sd">        Path to dictionary file in tsv or csv format</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>


<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \</span>
<span class="sd">    ...   .setInputCol(&quot;text&quot;) \</span>
<span class="sd">    ...   .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; sentenceDetector = SentenceDetector() \</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;]) \</span>
<span class="sd">    ...   .setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \</span>
<span class="sd">    ...   .setInputCols([&quot;sentence&quot;]) \</span>
<span class="sd">    ...   .setOutputCol(&quot;token&quot;)</span>

<span class="sd">    Define the parser (json file needs to be provided)</span>

<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;A patient has liver metastases pT1bN0M0 and the T5 primary site may be colon or... &quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; contextualParser = ContextualParserApproach() \</span>
<span class="sd">    ...   .setInputCols([&quot;sentence&quot;, &quot;token&quot;]) \</span>
<span class="sd">    ...   .setOutputCol(&quot;entity&quot;) \</span>
<span class="sd">    ...   .setJsonPath(&quot;/path/to/regex_token.json&quot;) \</span>
<span class="sd">    ...   .setCaseSensitive(True)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline(stages=[</span>
<span class="sd">    ...     documentAssembler,</span>
<span class="sd">    ...     sentenceDetector,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     contextualParser</span>
<span class="sd">    ...   ])</span>

<span class="sd">    &gt;&gt;&gt; result = pipeline.fit(data).transform(data)</span>
<span class="sd">    &gt;&gt;&gt; result.selectExpr(&quot;explode(entity)&quot;).show(5, truncate=False)</span>

<span class="sd">    +-------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">    |col                                                                                                                      |</span>
<span class="sd">    +-------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">    |{chunk, 32, 39, pT1bN0M0, {field -&gt; Stage, normalized -&gt; , confidenceValue -&gt; 1.00, sentence -&gt; 0}, []}                  |</span>
<span class="sd">    |{chunk, 49, 50, T5, {field -&gt; Stage, normalized -&gt; , confidenceValue -&gt; 1.00, sentence -&gt; 0}, []}                        |</span>
<span class="sd">    |{chunk, 148, 156, cT4bcN2M1, {field -&gt; Stage, normalized -&gt; , confidenceValue -&gt; 1.00, sentence -&gt; 1}, []}               |</span>
<span class="sd">    |{chunk, 189, 194, T?N3M1, {field -&gt; Stage, normalized -&gt; , confidenceValue -&gt; 1.00, sentence -&gt; 2}, []}                  |</span>
<span class="sd">    |{chunk, 316, 323, pT1bN0M0, {field -&gt; Stage, normalized -&gt; , confidenceValue -&gt; 1.00, sentence -&gt; 3}, []}                |</span>
<span class="sd">    +-------------------------------------------------------------------------------------------------------------------------+</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">jsonPath</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                     <span class="s2">&quot;jsonPath&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Path to json file with regex rules. This parameter can also detect JSON format&quot;</span><span class="p">,</span>
                     <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">caseSensitive</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                          <span class="s2">&quot;caseSensitive&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Whether to use case sensitive when matching values&quot;</span><span class="p">,</span>
                          <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">prefixAndSuffixMatch</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                 <span class="s2">&quot;prefixAndSuffixMatch&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;Whether to match both prefix and suffix to annotate the hit&quot;</span><span class="p">,</span>
                                 <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">dictionary</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                       <span class="s2">&quot;dictionary&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Path to dictionary file in tsv or csv format&quot;</span><span class="p">,</span>
                       <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

    <span class="n">optionalContextRules</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                 <span class="s2">&quot;optionalContextRules&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;When set to true, it will output regex match regardless of context matches&quot;</span><span class="p">,</span>
                                 <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ContextualParserApproach</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.context.ContextualParserApproach&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span><span class="n">caseSensitive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefixAndSuffixMatch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optionalContextRules</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">jsonPath</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="ContextualParserApproach.setJsonPath"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ContextualParserApproach.html#sparknlp_jsl.annotator.ContextualParserApproach.setJsonPath">[docs]</a>    <span class="k">def</span> <span class="nf">setJsonPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets path to json file with rules</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : str</span>
<span class="sd">            Path to json file with rules</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">jsonPath</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContextualParserApproach.setCaseSensitive"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ContextualParserApproach.html#sparknlp_jsl.annotator.ContextualParserApproach.setCaseSensitive">[docs]</a>    <span class="k">def</span> <span class="nf">setCaseSensitive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to use case sensitive when matching values</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether to use case sensitive when matching values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">caseSensitive</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContextualParserApproach.setPrefixAndSuffixMatch"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ContextualParserApproach.html#sparknlp_jsl.annotator.ContextualParserApproach.setPrefixAndSuffixMatch">[docs]</a>    <span class="k">def</span> <span class="nf">setPrefixAndSuffixMatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to match both prefix and suffix to annotate the hit</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether to match both prefix and suffix to annotate the hit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">prefixAndSuffixMatch</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContextualParserApproach.setDictionary"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ContextualParserApproach.html#sparknlp_jsl.annotator.ContextualParserApproach.setDictionary">[docs]</a>    <span class="k">def</span> <span class="nf">setDictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">read_as</span><span class="o">=</span><span class="n">ReadAs</span><span class="o">.</span><span class="n">TEXT</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets if we want to use &#39;bow&#39; for word embeddings or &#39;sentence&#39; for sentences&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            Path wher is de dictionary</span>
<span class="sd">        read_as: ReadAs</span>
<span class="sd">            Format of the file</span>
<span class="sd">        options: dict</span>
<span class="sd">            Dictionary with the options to read the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;delimiter&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">dictionary</span><span class="o">=</span><span class="n">ExternalResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">read_as</span><span class="p">,</span> <span class="n">options</span><span class="p">))</span></div>

    <span class="k">def</span> <span class="nf">setOptionalContextRules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">optionalContextRules</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ContextualParserModel</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span><span class="p">)</span></div>


<div class="viewcode-block" id="ContextualParserModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ContextualParserModel.html#sparknlp_jsl.annotator.ContextualParserModel">[docs]</a><span class="k">class</span> <span class="nc">ContextualParserModel</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extracts entity from a document based on user defined rules. Rule matching is based on a RegexMatcher defined in a</span>
<span class="sd">    JSON file. In this file, regex is defined that you want to match along with the information that will output on</span>
<span class="sd">    metadata field..</span>

<span class="sd">    ========================================= ======================</span>
<span class="sd">    Input Annotation types                    Output Annotation type</span>
<span class="sd">    ========================================= ======================</span>
<span class="sd">    ``DOCUMENT, TOKEN``                       ``CHUNK``</span>
<span class="sd">    ========================================= ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    jsonPath</span>
<span class="sd">        Path to json file with rules</span>
<span class="sd">    caseSensitive</span>
<span class="sd">        Whether to use case sensitive when matching values</span>
<span class="sd">    prefixAndSuffixMatch</span>
<span class="sd">        Whether to match both prefix and suffix to annotate the hit</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>

<span class="sd">    Which means to extract the stage code on a sentence level.</span>
<span class="sd">    An example pipeline could then be defined like this</span>
<span class="sd">    Pipeline could then be defined like this</span>

<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \</span>
<span class="sd">    ...   .setInputCol(&quot;text&quot;) \</span>
<span class="sd">    ...   .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; sentenceDetector = SentenceDetector() \</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;]) \</span>
<span class="sd">    ...   .setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \</span>
<span class="sd">    ...   .setInputCols([&quot;sentence&quot;]) \</span>
<span class="sd">    ...   .setOutputCol(&quot;token&quot;)</span>

<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;A patient has liver metastases pT1bN0M0 and the T5 primary site may be colon or... &quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; contextualParser = ContextualParserModel.load(&quot;mycontextualParserModel&quot;) \</span>
<span class="sd">    ...   .setInputCols([&quot;sentence&quot;, &quot;token&quot;]) \</span>
<span class="sd">    ...   .setOutputCol(&quot;entity&quot;) \</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline(stages=[</span>
<span class="sd">    ...     documentAssembler,</span>
<span class="sd">    ...     sentenceDetector,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     contextualParser</span>
<span class="sd">    ...   ])</span>

<span class="sd">    &gt;&gt;&gt; result = pipeline.fit(data).transform(data)</span>
<span class="sd">    &gt;&gt;&gt; result.selectExpr(&quot;explode(entity)&quot;).show(5, truncate=False)</span>

<span class="sd">    +-------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">    |col                                                                                                                      |</span>
<span class="sd">    +-------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">    |{chunk, 32, 39, pT1bN0M0, {field -&gt; Stage, normalized -&gt; , confidenceValue -&gt; 1.00, sentence -&gt; 0}, []}                  |</span>
<span class="sd">    |{chunk, 49, 50, T5, {field -&gt; Stage, normalized -&gt; , confidenceValue -&gt; 1.00, sentence -&gt; 0}, []}                        |</span>
<span class="sd">    |{chunk, 148, 156, cT4bcN2M1, {field -&gt; Stage, normalized -&gt; , confidenceValue -&gt; 1.00, sentence -&gt; 1}, []}               |</span>
<span class="sd">    |{chunk, 189, 194, T?N3M1, {field -&gt; Stage, normalized -&gt; , confidenceValue -&gt; 1.00, sentence -&gt; 2}, []}                  |</span>
<span class="sd">    |{chunk, 316, 323, pT1bN0M0, {field -&gt; Stage, normalized -&gt; , confidenceValue -&gt; 1.00, sentence -&gt; 3}, []}                |</span>
<span class="sd">    +-------------------------------------------------------------------------------------------------------------------------+</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">caseSensitive</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                          <span class="s2">&quot;caseSensitive&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Whether to use case sensitive when matching values&quot;</span><span class="p">,</span>
                          <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">prefixAndSuffixMatch</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                 <span class="s2">&quot;prefixAndSuffixMatch&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;Whether to match both prefix and suffix to annotate the hit&quot;</span><span class="p">,</span>
                                 <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">optionalContextRules</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                 <span class="s2">&quot;optionalContextRules&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;When set to true, it will output regex match regardless of context matches&quot;</span><span class="p">,</span>
                                 <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.context.ContextualParserModel&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ContextualParserModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span><span class="n">caseSensitive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefixAndSuffixMatch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optionalContextRules</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<div class="viewcode-block" id="ContextualParserModel.setCaseSensitive"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ContextualParserModel.html#sparknlp_jsl.annotator.ContextualParserModel.setCaseSensitive">[docs]</a>    <span class="k">def</span> <span class="nf">setCaseSensitive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to use case sensitive when matching values</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether to use case sensitive when matching values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">caseSensitive</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContextualParserModel.setPrefixAndSuffixMatch"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ContextualParserModel.html#sparknlp_jsl.annotator.ContextualParserModel.setPrefixAndSuffixMatch">[docs]</a>    <span class="k">def</span> <span class="nf">setPrefixAndSuffixMatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to match both prefix and suffix to annotate the hit</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether to match both prefix and suffix to annotate the hit</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">prefixAndSuffixMatch</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">setOptionalContextRules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">optionalContextRules</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="DocumentLogRegClassifierApproach"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DocumentLogRegClassifierApproach.html#sparknlp_jsl.annotator.DocumentLogRegClassifierApproach">[docs]</a><span class="k">class</span> <span class="nc">DocumentLogRegClassifierApproach</span><span class="p">(</span><span class="n">AnnotatorApproach</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Trains a model to classify documents with a Logarithmic Regression algorithm. Training data requires columns for</span>
<span class="sd">    text and their label. The result is a trained GenericClassifierModel.</span>

<span class="sd">    ========================================= ======================</span>
<span class="sd">    Input Annotation types                    Output Annotation type</span>
<span class="sd">    ========================================= ======================</span>
<span class="sd">    ``TOKEN``                       `         ``CATEGORY``</span>
<span class="sd">    ========================================= ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    labelCol</span>
<span class="sd">        Column with the value result we are trying to predict.</span>
<span class="sd">    maxIter</span>
<span class="sd">        maximum number of iterations.</span>
<span class="sd">    tol</span>
<span class="sd">        convergence tolerance after each iteration.</span>
<span class="sd">    fitIntercept</span>
<span class="sd">        whether to fit an intercept term, default is true.</span>
<span class="sd">    labels</span>
<span class="sd">        array to output the label in the original form.</span>
<span class="sd">    vectorizationModelPath</span>
<span class="sd">        specify the vectorization model if it has been already trained.</span>
<span class="sd">    classificationModelPath</span>
<span class="sd">        specify the classification model if it has been already trained.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>

<span class="sd">    An example pipeline could then be defined like this</span>

<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \\</span>
<span class="sd">    ...    .setInputCols(&quot;document&quot;) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;token&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; normalizer = Normalizer() \\</span>
<span class="sd">    ...    .setInputCols(&quot;token&quot;) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;normalized&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; stopwords_cleaner = StopWordsCleaner()\\</span>
<span class="sd">    ...    .setInputCols(&quot;normalized&quot;)\\</span>
<span class="sd">    ...    .setOutputCol(&quot;cleanTokens&quot;)\\</span>
<span class="sd">    ...    .setCaseSensitive(False)</span>
<span class="sd">    ...</span>
<span class="sd">    ...stemmer = Stemmer() \</span>
<span class="sd">    ...    .setInputCols(&quot;cleanTokens&quot;) \</span>
<span class="sd">    ...    .setOutputCol(&quot;stem&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; gen_clf = DocumentLogRegClassifierApproach() \\</span>
<span class="sd">    ...    .setLabelColumn(&quot;category&quot;) \\</span>
<span class="sd">    ...    .setInputCols(&quot;stem&quot;) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;prediction&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline().setStages([</span>
<span class="sd">    ...    document_assembler,</span>
<span class="sd">    ...    tokenizer,</span>
<span class="sd">    ...    normalizer,</span>
<span class="sd">    ...    stopwords_cleaner,</span>
<span class="sd">    ...    stemmer,</span>
<span class="sd">    ...    logreg</span>
<span class="sd">    ...])</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; clf_model = pipeline.fit(data)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">labelCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;labelCol&quot;</span><span class="p">,</span> <span class="s2">&quot;column with the value result we are trying to predict.&quot;</span><span class="p">,</span>
                     <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">maxIter</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;maxIter&quot;</span><span class="p">,</span> <span class="s2">&quot;maximum number of iterations.&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">tol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;tol&quot;</span><span class="p">,</span> <span class="s2">&quot;convergence tolerance after each iteration.&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>
    <span class="n">fitIntercept</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;fitIntercept&quot;</span><span class="p">,</span> <span class="s2">&quot;whether to fit an intercept term, default is true.&quot;</span><span class="p">,</span>
                         <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;array to output the label in the original form.&quot;</span><span class="p">,</span>
                   <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>
    <span class="n">vectorizationModelPath</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;vectorizationModelPath&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;specify the vectorization model if it has been already trained.&quot;</span><span class="p">,</span>
                                   <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">classificationModelPath</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;classificationModelPath&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;specify the classification model if it has been already trained.&quot;</span><span class="p">,</span>
                                    <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

<div class="viewcode-block" id="DocumentLogRegClassifierApproach.setLabelColumn"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DocumentLogRegClassifierApproach.html#sparknlp_jsl.annotator.DocumentLogRegClassifierApproach.setLabelColumn">[docs]</a>    <span class="k">def</span> <span class="nf">setLabelColumn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets column with the value result we are trying to predict.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            Column with the value result we are trying to predict.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">labelCol</span><span class="o">=</span><span class="n">label</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentLogRegClassifierApproach.setMaxIter"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DocumentLogRegClassifierApproach.html#sparknlp_jsl.annotator.DocumentLogRegClassifierApproach.setMaxIter">[docs]</a>    <span class="k">def</span> <span class="nf">setMaxIter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets maximum number of iterations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        k : int</span>
<span class="sd">             Maximum number of iterations.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">maxIter</span><span class="o">=</span><span class="n">k</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentLogRegClassifierApproach.setTol"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DocumentLogRegClassifierApproach.html#sparknlp_jsl.annotator.DocumentLogRegClassifierApproach.setTol">[docs]</a>    <span class="k">def</span> <span class="nf">setTol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets  convergence tolerance after each iteration.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dist : float</span>
<span class="sd">            Convergence tolerance after each iteration.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">tol</span><span class="o">=</span><span class="n">dist</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentLogRegClassifierApproach.setFitIntercept"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DocumentLogRegClassifierApproach.html#sparknlp_jsl.annotator.DocumentLogRegClassifierApproach.setFitIntercept">[docs]</a>    <span class="k">def</span> <span class="nf">setFitIntercept</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">merge</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to fit an intercept term, default is true.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            Whether to fit an intercept term, default is true.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">fitIntercept</span><span class="o">=</span><span class="n">merge</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentLogRegClassifierApproach.setVectorizationModelPath"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DocumentLogRegClassifierApproach.html#sparknlp_jsl.annotator.DocumentLogRegClassifierApproach.setVectorizationModelPath">[docs]</a>    <span class="k">def</span> <span class="nf">setVectorizationModelPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets a path to the the classification model if it has been already trained.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">          Path to the the classification model if it has been already trained.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">vectorizationModelPath</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentLogRegClassifierApproach.setClassificationModelPath"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DocumentLogRegClassifierApproach.html#sparknlp_jsl.annotator.DocumentLogRegClassifierApproach.setClassificationModelPath">[docs]</a>    <span class="k">def</span> <span class="nf">setClassificationModelPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets a path to the the classification model if it has been already trained.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            Path to the the classification model if it has been already trained.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">classificationModelPath</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentLogRegClassifierApproach.setLabels"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DocumentLogRegClassifierApproach.html#sparknlp_jsl.annotator.DocumentLogRegClassifierApproach.setLabels">[docs]</a>    <span class="k">def</span> <span class="nf">setLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets array to output the label in the original form.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : list</span>
<span class="sd">           array to output the label in the original form.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DocumentLogRegClassifierModel</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span><span class="p">)</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DocumentLogRegClassifierApproach</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.classification.DocumentLogRegClassifierApproach&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span>
            <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;selector&quot;</span><span class="p">,</span>
            <span class="n">maxIter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
            <span class="n">fitIntercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">vectorizationModelPath</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">classificationModelPath</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DocumentLogRegClassifierModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DocumentLogRegClassifierModel.html#sparknlp_jsl.annotator.DocumentLogRegClassifierModel">[docs]</a><span class="k">class</span> <span class="nc">DocumentLogRegClassifierModel</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Classifies documents with a Logarithmic Regression algorithm.</span>


<span class="sd">    ========================================= ======================</span>
<span class="sd">    Input Annotation types                    Output Annotation type</span>
<span class="sd">    ========================================= ======================</span>
<span class="sd">    ``TOKEN``                                 ``CATEGORY``</span>
<span class="sd">    ========================================= ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mergeChunks</span>
<span class="sd">        Whether to merge all chunks in a document or not (Default: false)</span>
<span class="sd">    labels</span>
<span class="sd">        Array to output the label in the original form.</span>
<span class="sd">    vectorizationModel</span>
<span class="sd">       Vectorization model if it has been already trained.</span>
<span class="sd">    classificationModel</span>
<span class="sd">        Classification model if it has been already trained.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;DocumentLogRegClassifierModel&quot;</span>

    <span class="n">vectorizationModel</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;vectorizationModel&quot;</span><span class="p">,</span> <span class="s2">&quot;wrapped vectorization model.&quot;</span><span class="p">,</span>
                               <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>
    <span class="n">classificationModel</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;classificationModel&quot;</span><span class="p">,</span> <span class="s2">&quot;wrapped classification model.&quot;</span><span class="p">,</span>
                                <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;array to output the label in the original form.&quot;</span><span class="p">,</span>
                   <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>
    <span class="n">mergeChunks</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;mergeChunks&quot;</span><span class="p">,</span> <span class="s2">&quot;whether or not to combine all chunks and make a single query&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.classification.DocumentLogRegClassifierModel&quot;</span><span class="p">,</span>
                 <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DocumentLogRegClassifierModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>

<div class="viewcode-block" id="DocumentLogRegClassifierModel.setLabels"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DocumentLogRegClassifierModel.html#sparknlp_jsl.annotator.DocumentLogRegClassifierModel.setLabels">[docs]</a>    <span class="k">def</span> <span class="nf">setLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets array to output the label in the original form.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : list</span>
<span class="sd">           array to output the label in the original form.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentLogRegClassifierModel.setMergeChunks"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DocumentLogRegClassifierModel.html#sparknlp_jsl.annotator.DocumentLogRegClassifierModel.setMergeChunks">[docs]</a>    <span class="k">def</span> <span class="nf">setMergeChunks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">merge</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to merge all chunks in a document or not (Default: false)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        merge : list</span>
<span class="sd">           whether to merge all chunks in a document or not (Default: false)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">mergeChunks</span><span class="o">=</span><span class="n">merge</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentLogRegClassifierModel.setVectorizationModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DocumentLogRegClassifierModel.html#sparknlp_jsl.annotator.DocumentLogRegClassifierModel.setVectorizationModel">[docs]</a>    <span class="k">def</span> <span class="nf">setVectorizationModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets a path to the classification model if it has been already trained.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model: :class:`pyspark.ml.PipelineModel`</span>
<span class="sd">            Classification model if it has been already trained.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">vectorizationModel</span><span class="o">=</span><span class="n">model</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentLogRegClassifierModel.setClassificationModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DocumentLogRegClassifierModel.html#sparknlp_jsl.annotator.DocumentLogRegClassifierModel.setClassificationModel">[docs]</a>    <span class="k">def</span> <span class="nf">setClassificationModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets a path to the the classification model if it has been already trained.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model: :class:`pyspark.ml.PipelineModel`</span>
<span class="sd">            Classification model if it has been already trained.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">classificationModel</span><span class="o">=</span><span class="n">model</span><span class="p">)</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.pretrained</span> <span class="kn">import</span> <span class="n">InternalResourceDownloader</span>
        <span class="k">return</span> <span class="n">InternalResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">DocumentLogRegClassifierModel</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GenericClassifierApproach"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.GenericClassifierApproach.html#sparknlp_jsl.annotator.GenericClassifierApproach">[docs]</a><span class="k">class</span> <span class="nc">GenericClassifierApproach</span><span class="p">(</span><span class="n">AnnotatorApproach</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Trains a TensorFlow model for generic classification of feature vectors. It takes FEATURE_VECTOR annotations from</span>
<span class="sd">    FeaturesAssembler` as input, classifies them and outputs CATEGORY annotations.</span>

<span class="sd">    ========================================= ======================</span>
<span class="sd">    Input Annotation types                    Output Annotation type</span>
<span class="sd">    ========================================= ======================</span>
<span class="sd">    ``FEATURE_VECTOR``                        ``CATEGORY``</span>
<span class="sd">    ========================================= ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    labelColumn</span>
<span class="sd">        Column with one label per document</span>
<span class="sd">    batchSize</span>
<span class="sd">        Size for each batch in the optimization process</span>
<span class="sd">    epochsN</span>
<span class="sd">        Number of epochs for the optimization process</span>
<span class="sd">    learningRate</span>
<span class="sd">        Learning rate for the optimization proces</span>
<span class="sd">    dropou</span>
<span class="sd">        Dropout at the output of each laye</span>
<span class="sd">    validationSplit</span>
<span class="sd">        Validaiton split - how much data to use for validation</span>
<span class="sd">    modelFile</span>
<span class="sd">        File name to load the mode from</span>
<span class="sd">    fixImbalance</span>
<span class="sd">        A flag indicating whenther to balance the trainig set</span>
<span class="sd">    featureScaling</span>
<span class="sd">        Feature scaling method. Possible values are &#39;zscore&#39;, &#39;minmax&#39; or empty (no scaling)</span>
<span class="sd">    outputLogsPath</span>
<span class="sd">        Path to folder where logs will be saved. If no path is specified, no logs are generated</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; features_asm = FeaturesAssembler() \</span>
<span class="sd">    ...    .setInputCols([&quot;feature_1&quot;, &quot;feature_2&quot;, &quot;...&quot;, &quot;feature_n&quot;]) \</span>
<span class="sd">    ...    .setOutputCol(&quot;features&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; gen_clf = GenericClassifierApproach() \\</span>
<span class="sd">    ...    .setLabelColumn(&quot;target&quot;) \\</span>
<span class="sd">    ...    .setInputCols([&quot;features&quot;]) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;prediction&quot;) \\</span>
<span class="sd">    ...    .setModelFile(&quot;/path/to/graph_file.pb&quot;) \\</span>
<span class="sd">    ...    .setEpochsNumber(50) \\</span>
<span class="sd">    ...    .setBatchSize(100) \\</span>
<span class="sd">    ...    .setFeatureScaling(&quot;zscore&quot;) \\</span>
<span class="sd">    ...    .setlearningRate(0.001) \\</span>
<span class="sd">    ...    .setFixImbalance(True) \\</span>
<span class="sd">    ...    .setOutputLogsPath(&quot;logs&quot;) \\</span>
<span class="sd">    ...    .setValidationSplit(0.2) # keep 20% of the data for validation purposes</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline().setStages([</span>
<span class="sd">    ...    features_asm,</span>
<span class="sd">    ...    gen_clf</span>
<span class="sd">    ...])</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; clf_model = pipeline.fit(data)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">labelColumn</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;labelColumn&quot;</span><span class="p">,</span> <span class="s2">&quot;Column with one label per document&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">batchSize</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;batchSize&quot;</span><span class="p">,</span> <span class="s2">&quot;Size for each batch in the optimization process&quot;</span><span class="p">,</span>
                      <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">epochsN</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;epochsN&quot;</span><span class="p">,</span> <span class="s2">&quot;Number of epochs for the optimization process&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">learningRate</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;learningRate&quot;</span><span class="p">,</span> <span class="s2">&quot;Learning rate for the optimization process&quot;</span><span class="p">,</span>
                         <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>
    <span class="n">dropout</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;dropout&quot;</span><span class="p">,</span> <span class="s2">&quot;Dropout at the output of each layer&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>
    <span class="n">validationSplit</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;validationSplit&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;Validaiton split - how much data to use for validation&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>

    <span class="n">modelFile</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;modelFile&quot;</span><span class="p">,</span> <span class="s2">&quot;File name to load the mode from&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">fixImbalance</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;fixImbalance&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;A flag indicating whenther to balance the trainig set&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">featureScaling</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;featureScaling&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;Feature scaling method. Possible values are &#39;zscore&#39;, &#39;minmax&#39; or empty (no scaling)&quot;</span><span class="p">,</span>
                           <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">outputLogsPath</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;outputLogsPath&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;Path to folder where logs will be saved. If no path is specified, no logs are generated&quot;</span><span class="p">,</span>
                           <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

<div class="viewcode-block" id="GenericClassifierApproach.setLabelCol"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.GenericClassifierApproach.html#sparknlp_jsl.annotator.GenericClassifierApproach.setLabelCol">[docs]</a>    <span class="k">def</span> <span class="nf">setLabelCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label_column</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets  Size for each batch in the optimization process</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            Column with the value result we are trying to predict.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">labelColumn</span><span class="o">=</span><span class="n">label_column</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericClassifierApproach.setBatchSize"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.GenericClassifierApproach.html#sparknlp_jsl.annotator.GenericClassifierApproach.setBatchSize">[docs]</a>    <span class="k">def</span> <span class="nf">setBatchSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Size for each batch in the optimization process</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : int</span>
<span class="sd">             Size for each batch in the optimization process</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">batchSize</span><span class="o">=</span><span class="n">size</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericClassifierApproach.setEpochsNumber"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.GenericClassifierApproach.html#sparknlp_jsl.annotator.GenericClassifierApproach.setEpochsNumber">[docs]</a>    <span class="k">def</span> <span class="nf">setEpochsNumber</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epochs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets number of epochs for the optimization process</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        epochs : int</span>
<span class="sd">            Number of epochs for the optimization process</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">epochsN</span><span class="o">=</span><span class="n">epochs</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericClassifierApproach.setLearningRate"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.GenericClassifierApproach.html#sparknlp_jsl.annotator.GenericClassifierApproach.setLearningRate">[docs]</a>    <span class="k">def</span> <span class="nf">setLearningRate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lamda</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets learning rate for the optimization process</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lamda : float</span>
<span class="sd">            Learning rate for the optimization process</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">learningRate</span><span class="o">=</span><span class="n">lamda</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericClassifierApproach.setDropout"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.GenericClassifierApproach.html#sparknlp_jsl.annotator.GenericClassifierApproach.setDropout">[docs]</a>    <span class="k">def</span> <span class="nf">setDropout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dropout</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets drouptup</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dropout : float</span>
<span class="sd">             Dropout at the output of each layer</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericClassifierApproach.setValidationSplit"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.GenericClassifierApproach.html#sparknlp_jsl.annotator.GenericClassifierApproach.setValidationSplit">[docs]</a>    <span class="k">def</span> <span class="nf">setValidationSplit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validation_split</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets validaiton split - how much data to use for validation</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        validation_split : float</span>
<span class="sd">            Validaiton split - how much data to use for validation</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">validationSplit</span><span class="o">=</span><span class="n">validation_split</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericClassifierApproach.setModelFile"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.GenericClassifierApproach.html#sparknlp_jsl.annotator.GenericClassifierApproach.setModelFile">[docs]</a>    <span class="k">def</span> <span class="nf">setModelFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode_file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets file name to load the mode from&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            File name to load the mode from&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">modelFile</span><span class="o">=</span><span class="n">mode_file</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericClassifierApproach.setFixImbalance"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.GenericClassifierApproach.html#sparknlp_jsl.annotator.GenericClassifierApproach.setFixImbalance">[docs]</a>    <span class="k">def</span> <span class="nf">setFixImbalance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fix_imbalance</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets A flag indicating whenther to balance the trainig set.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fix_imbalance : bool</span>
<span class="sd">            A flag indicating whenther to balance the trainig set.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">fixImbalance</span><span class="o">=</span><span class="n">fix_imbalance</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericClassifierApproach.setFeatureScaling"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.GenericClassifierApproach.html#sparknlp_jsl.annotator.GenericClassifierApproach.setFeatureScaling">[docs]</a>    <span class="k">def</span> <span class="nf">setFeatureScaling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature_scaling</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets Feature scaling method. Possible values are &#39;zscore&#39;, &#39;minmax&#39; or empty (no scaling</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        feature_scaling : str</span>
<span class="sd">            Feature scaling method. Possible values are &#39;zscore&#39;, &#39;minmax&#39; or empty (no scaling</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">featureScaling</span><span class="o">=</span><span class="n">feature_scaling</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericClassifierApproach.setOutputLogsPath"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.GenericClassifierApproach.html#sparknlp_jsl.annotator.GenericClassifierApproach.setOutputLogsPath">[docs]</a>    <span class="k">def</span> <span class="nf">setOutputLogsPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_logs_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets path to folder where logs will be saved. If no path is specified, no logs are generated</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            Path to folder where logs will be saved. If no path is specified, no logs are generated</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">outputLogsPath</span><span class="o">=</span><span class="n">output_logs_path</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">GenericClassifierModel</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span><span class="p">)</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.generic_classifier.GenericClassifierApproach&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GenericClassifierApproach</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span>
            <span class="n">labelColumn</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span>
            <span class="n">batchSize</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
            <span class="n">epochsN</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">learningRate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
            <span class="n">dropout</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
            <span class="n">fixImbalance</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">featureScaling</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">outputLogsPath</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GenericClassifierModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.GenericClassifierModel.html#sparknlp_jsl.annotator.GenericClassifierModel">[docs]</a><span class="k">class</span> <span class="nc">GenericClassifierModel</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generic classifier of feature vectors. It takes FEATURE_VECTOR annotations from</span>
<span class="sd">    FeaturesAssembler` as input, classifies them and outputs CATEGORY annotations.</span>

<span class="sd">    ========================================= ======================</span>
<span class="sd">    Input Annotation types                    Output Annotation type</span>
<span class="sd">    ========================================= ======================</span>
<span class="sd">    ``FEATURE_VECTOR``                        ``CATEGORY``</span>
<span class="sd">    ========================================= ======================</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; features_asm = FeaturesAssembler() \\</span>
<span class="sd">    ...    .setInputCols([&quot;feature_1&quot;, &quot;feature_2&quot;, &quot;...&quot;, &quot;feature_n&quot;]) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;features&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; gen_clf = GenericClassifierModel.pretrained() \\</span>
<span class="sd">    ...    .setInputCols([&quot;features&quot;]) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;prediction&quot;) \\</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline().setStages([</span>
<span class="sd">    ...    features_asm,</span>
<span class="sd">    ...    gen_clf</span>
<span class="sd">    ...])</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; clf_model = pipeline.fit(data)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;GenericClassifierModel&quot;</span>

    <span class="n">classes</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;classes&quot;</span><span class="p">,</span> <span class="s2">&quot;Categorization classes&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.generic_classifier.GenericClassifierModel&quot;</span><span class="p">,</span>
                 <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GenericClassifierModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.pretrained</span> <span class="kn">import</span> <span class="n">InternalResourceDownloader</span>
        <span class="k">return</span> <span class="n">InternalResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">GenericClassifierModel</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="ChunkMergeApproach"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMergeApproach.html#sparknlp_jsl.annotator.ChunkMergeApproach">[docs]</a><span class="k">class</span> <span class="nc">ChunkMergeApproach</span><span class="p">(</span><span class="n">AnnotatorApproach</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merges two chunk columns coming from two annotators(NER, ContextualParser or any other annotator producing</span>
<span class="sd">    chunks). The merger of the two chunk columns is made by selecting one chunk from one of the columns according</span>
<span class="sd">    to certain criteria.</span>
<span class="sd">    The decision on which chunk to select is made according to the chunk indices in the source document.</span>
<span class="sd">    (chunks with longer lengths and highest information will be kept from each source)</span>
<span class="sd">    Labels can be changed by setReplaceDictResource.</span>

<span class="sd">    =========================== ======================</span>
<span class="sd">    Input Annotation types      Output Annotation type</span>
<span class="sd">    =========================== ======================</span>
<span class="sd">    ``CHUNK,CHUNK``               ``CHUNK``</span>
<span class="sd">    =========================== ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mergeOverlapping</span>
<span class="sd">        whether to merge overlapping matched chunks. Defaults false</span>
<span class="sd">    falsePositivesResource</span>
<span class="sd">        file with false positive pairs</span>
<span class="sd">    replaceDictResource</span>
<span class="sd">        replace dictionary pairs</span>
<span class="sd">    chunkPrecedence</span>
<span class="sd">        Select what is the precedence when two chunks have the same start and end indices. Possible values are [entity|identifier|field]</span>
<span class="sd">    blackList</span>
<span class="sd">        If defined, list of entities to ignore. The rest will be proccessed.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    Define a pipeline with 2 different NER models with a ChunkMergeApproach at the end</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;A 63-year-old man presents to the hospital ...&quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline(stages=[</span>
<span class="sd">    ...  DocumentAssembler().setInputCol(&quot;text&quot;).setOutputCol(&quot;document&quot;),</span>
<span class="sd">    ...  SentenceDetector().setInputCols([&quot;document&quot;]).setOutputCol(&quot;sentence&quot;),</span>
<span class="sd">    ...  Tokenizer().setInputCols([&quot;sentence&quot;]).setOutputCol(&quot;token&quot;),</span>
<span class="sd">    ...   WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;).setOutputCol(&quot;embs&quot;),</span>
<span class="sd">    ...   MedicalNerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embs&quot;]).setOutputCol(&quot;jsl_ner&quot;),</span>
<span class="sd">    ...  NerConverter().setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;jsl_ner&quot;]).setOutputCol(&quot;jsl_ner_chunk&quot;),</span>
<span class="sd">    ...   MedicalNerModel.pretrained(&quot;ner_bionlp&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embs&quot;]).setOutputCol(&quot;bionlp_ner&quot;),</span>
<span class="sd">    ...  NerConverter().setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;bionlp_ner&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;bionlp_ner_chunk&quot;),</span>
<span class="sd">    ...  ChunkMergeApproach().setInputCols([&quot;jsl_ner_chunk&quot;, &quot;bionlp_ner_chunk&quot;]).setOutputCol(&quot;merged_chunk&quot;)</span>
<span class="sd">    &gt;&gt;&gt; ])</span>
<span class="sd">    &gt;&gt;&gt; result = pipeline.fit(data).transform(data).cache()</span>
<span class="sd">    &gt;&gt;&gt; result.selectExpr(&quot;explode(merged_chunk) as a&quot;) \\</span>
<span class="sd">    ...   .selectExpr(&quot;a.begin&quot;,&quot;a.end&quot;,&quot;a.result as chunk&quot;,&quot;a.metadata.entity as entity&quot;) \\</span>
<span class="sd">    ...   .show(5, False)</span>
<span class="sd">    +-----+---+-----------+---------+</span>
<span class="sd">    |begin|end|chunk      |entity   |</span>
<span class="sd">    +-----+---+-----------+---------+</span>
<span class="sd">    |5    |15 |63-year-old|Age      |</span>
<span class="sd">    |17   |19 |man        |Gender   |</span>
<span class="sd">    |64   |72 |recurrent  |Modifier |</span>
<span class="sd">    |98   |107|cellulitis |Diagnosis|</span>
<span class="sd">    |110  |119|pneumonias |Diagnosis|</span>
<span class="sd">    +-----+---+-----------+---------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ChunkMergeApproach&quot;</span>

    <span class="n">mergeOverlapping</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                             <span class="s2">&quot;mergeOverlapping&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;whether to merge overlapping matched chunks. Defaults false&quot;</span><span class="p">,</span>
                             <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">falsePositivesResource</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                   <span class="s2">&quot;falsePositivesResource&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;file with false positive pairs&quot;</span><span class="p">,</span>
                                   <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

    <span class="n">replaceDictResource</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                <span class="s2">&quot;replaceDictResource&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;replace dictionary pairs&quot;</span><span class="p">,</span>
                                <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

    <span class="n">chunkPrecedence</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                            <span class="s2">&quot;chunkPrecedence&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;Select what is the precedence when two chunks have the same start and end indices. Possible values are [entity|identifier|field]&quot;</span><span class="p">,</span>
                            <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">blackList</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;blackList&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;If defined, list of entities to ignore. The rest will be processed. Do not include IOB prefix on labels&quot;</span><span class="p">,</span>
                      <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

<div class="viewcode-block" id="ChunkMergeApproach.setMergeOverlapping"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMergeApproach.html#sparknlp_jsl.annotator.ChunkMergeApproach.setMergeOverlapping">[docs]</a>    <span class="k">def</span> <span class="nf">setMergeOverlapping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to merge overlapping matched chunks. Defaults false</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : bool</span>
<span class="sd">            whether to merge overlapping matched chunks. Defaults false</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">mergeOverlapping</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="ChunkMergeApproach.setFalsePositivesResource"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMergeApproach.html#sparknlp_jsl.annotator.ChunkMergeApproach.setFalsePositivesResource">[docs]</a>    <span class="k">def</span> <span class="nf">setFalsePositivesResource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">read_as</span><span class="o">=</span><span class="n">ReadAs</span><span class="o">.</span><span class="n">TEXT</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets file with false positive pairs</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            Path to the external resource</span>
<span class="sd">        read_as : str, optional</span>
<span class="sd">            How to read the resource, by default ReadAs.TEXT</span>
<span class="sd">        options : dict, optional</span>
<span class="sd">            Options for reading the resource, by default {&quot;format&quot;: &quot;text&quot;}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;delimiter&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">falsePositivesResource</span><span class="o">=</span><span class="n">ExternalResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">read_as</span><span class="p">,</span> <span class="n">options</span><span class="p">))</span></div>


<div class="viewcode-block" id="ChunkMergeApproach.setReplaceDictResource"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMergeApproach.html#sparknlp_jsl.annotator.ChunkMergeApproach.setReplaceDictResource">[docs]</a>    <span class="k">def</span> <span class="nf">setReplaceDictResource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">read_as</span><span class="o">=</span><span class="n">ReadAs</span><span class="o">.</span><span class="n">TEXT</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;delimiter&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="p">}):</span>
        <span class="sd">&quot;&quot;&quot;Sets replace dictionary pairs</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            Path to the external resource</span>

<span class="sd">        read_as : str, optional</span>
<span class="sd">            How to read the resource, by default ReadAs.TEXT</span>
<span class="sd">        options : dict, optional</span>
<span class="sd">            Options for reading the resource, by default {&quot;format&quot;: &quot;text&quot;}</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">replaceDictResource</span><span class="o">=</span><span class="n">ExternalResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">read_as</span><span class="p">,</span> <span class="n">options</span><span class="p">))</span></div>

<div class="viewcode-block" id="ChunkMergeApproach.setChunkPrecedence"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMergeApproach.html#sparknlp_jsl.annotator.ChunkMergeApproach.setChunkPrecedence">[docs]</a>    <span class="k">def</span> <span class="nf">setChunkPrecedence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets what is the precedence when two chunks have the same start and end indices. Possible values are [entity|identifier|field]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : str</span>
<span class="sd">            Select what is the precedence when two chunks have the same start and end indices. Possible values are [entity|identifier|field]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">chunkPrecedence</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="ChunkMergeApproach.setBlackList"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMergeApproach.html#sparknlp_jsl.annotator.ChunkMergeApproach.setBlackList">[docs]</a>    <span class="k">def</span> <span class="nf">setBlackList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entities</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;If defined, list of entities to ignore. The rest will be processed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        entities : list</span>
<span class="sd">           If defined, list of entities to ignore. The rest will be processed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">blackList</span><span class="o">=</span><span class="n">entities</span><span class="p">)</span></div>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ChunkMergeApproach</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.merge.ChunkMergeApproach&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ChunkMergeModel</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span><span class="p">)</span></div>


<div class="viewcode-block" id="ChunkMergeModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMergeModel.html#sparknlp_jsl.annotator.ChunkMergeModel">[docs]</a><span class="k">class</span> <span class="nc">ChunkMergeModel</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The model produced by ChunkMergerAproach.</span>

<span class="sd">    =========================== ======================</span>
<span class="sd">    Input Annotation types      Output Annotation type</span>
<span class="sd">    =========================== ======================</span>
<span class="sd">    ``CHUNK,CHUNK``             ``CHUNK``</span>
<span class="sd">    =========================== ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    mergeOverlapping</span>
<span class="sd">        whether to merge overlapping matched chunks. Defaults false</span>
<span class="sd">    chunkPrecedence</span>
<span class="sd">        Select what is the precedence when two chunks have the same start and end indices. Possible values are [entity|identifier|field]</span>
<span class="sd">    blackList</span>
<span class="sd">        If defined, list of entities to ignore. The rest will be proccessed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ChunkMergeModel&quot;</span>

    <span class="n">mergeOverlapping</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                             <span class="s2">&quot;mergeOverlapping&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;whether to merge overlapping matched chunks. Defaults false&quot;</span><span class="p">,</span>
                             <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">falsePositives</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;falsePositives&quot;</span><span class="p">,</span> <span class="s2">&quot;list of false positive tuples (text, entity)&quot;</span><span class="p">,</span>
                           <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>
    <span class="n">replaceDict</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;replaceDict&quot;</span><span class="p">,</span> <span class="s2">&quot;dictionary of entities to replace&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

    <span class="n">chunkPrecedence</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                            <span class="s2">&quot;chunkPrecedence&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;Select what is the precedence when two chunks have the same start and end indices. Possible values are [entity|identifier|field]&quot;</span><span class="p">,</span>
                            <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">blackList</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;blackList&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;If defined, list of entities to ignore. The rest will be processed. Do not include IOB prefix on labels&quot;</span><span class="p">,</span>
                      <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

<div class="viewcode-block" id="ChunkMergeModel.setMergeOverlapping"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMergeModel.html#sparknlp_jsl.annotator.ChunkMergeModel.setMergeOverlapping">[docs]</a>    <span class="k">def</span> <span class="nf">setMergeOverlapping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to merge overlapping matched chunks. Defaults false</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v : bool</span>
<span class="sd">            Whether to merge overlapping matched chunks. Defaults false</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">mergeOverlapping</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="ChunkMergeModel.setChunkPrecedence"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMergeModel.html#sparknlp_jsl.annotator.ChunkMergeModel.setChunkPrecedence">[docs]</a>    <span class="k">def</span> <span class="nf">setChunkPrecedence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets what is the precedence when two chunks have the same start and end indices. Possible values are [entity|identifier|field]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : str</span>
<span class="sd">            Select what is the precedence when two chunks have the same start and end indices. Possible values are [entity|identifier|field]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">chunkPrecedence</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.merge.ChunkMergeModel&quot;</span><span class="p">,</span>
                 <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ChunkMergeModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.pretrained</span> <span class="kn">import</span> <span class="n">InternalResourceDownloader</span>
        <span class="k">return</span> <span class="n">InternalResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">ChunkMergeModel</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="RelationExtractionApproach"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RelationExtractionApproach.html#sparknlp_jsl.annotator.RelationExtractionApproach">[docs]</a><span class="k">class</span> <span class="nc">RelationExtractionApproach</span><span class="p">(</span><span class="n">GenericClassifierApproach</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Trains a TensorFlow model for relation extraction. The Tensorflow graph in ``.pb`` format needs to be specified with</span>
<span class="sd">    ``setModelFile``. The result is a RelationExtractionModel.</span>
<span class="sd">    To start training, see the parameters that need to be set in the Parameters section.</span>



<span class="sd">    ===========================================  ======================</span>
<span class="sd">    Input Annotation types                       Output Annotation type</span>
<span class="sd">    ===========================================  ======================</span>
<span class="sd">    ``WORD_EMBEDDINGS, POS, CHUNK, DEPENDENCY``  ``CATEGORY``</span>
<span class="sd">    ===========================================  ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fromEntityBeginCol</span>
<span class="sd">        From Entity Begining Column</span>
<span class="sd">    fromEntityEndCol</span>
<span class="sd">        From Entity End Column</span>
<span class="sd">    fromEntityLabelCol</span>
<span class="sd">        From Entity Label Column</span>
<span class="sd">    toEntityBeginCol</span>
<span class="sd">        To Entity Begining Column</span>
<span class="sd">    toEntityEndCol</span>
<span class="sd">        To Entity End Column</span>
<span class="sd">    toEntityLabelCol</span>
<span class="sd">        &quot;To Entity Label Column</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \</span>
<span class="sd">    ...   .setInputCol(&quot;text&quot;) \</span>
<span class="sd">    ...   .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;]) \</span>
<span class="sd">    ...   .setOutputCol(&quot;tokens&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; embedder = WordEmbeddingsModel \</span>
<span class="sd">    ...   .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;, &quot;tokens&quot;]) \</span>
<span class="sd">    ...   .setOutputCol(&quot;embeddings&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; posTagger = PerceptronModel \</span>
<span class="sd">    ...   .pretrained(&quot;pos_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;, &quot;tokens&quot;]) \</span>
<span class="sd">    ...   .setOutputCol(&quot;posTags&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; nerTagger = MedicalNerModel \</span>
<span class="sd">    ...   .pretrained(&quot;ner_events_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;, &quot;tokens&quot;, &quot;embeddings&quot;]) \</span>
<span class="sd">    ...   .setOutputCol(&quot;ner_tags&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; nerConverter = NerConverter() \</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;, &quot;tokens&quot;, &quot;ner_tags&quot;]) \</span>
<span class="sd">    ...   .setOutputCol(&quot;nerChunks&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; depencyParser = DependencyParserModel \</span>
<span class="sd">    ...   .pretrained(&quot;dependency_conllu&quot;, &quot;en&quot;) \</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;, &quot;posTags&quot;, &quot;tokens&quot;]) \</span>
<span class="sd">    ...   .setOutputCol(&quot;dependencies&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; re = RelationExtractionApproach() \</span>
<span class="sd">    ...   .setInputCols([&quot;embeddings&quot;, &quot;posTags&quot;, &quot;train_ner_chunks&quot;, &quot;dependencies&quot;]) \</span>
<span class="sd">    ...   .setOutputCol(&quot;relations_t&quot;) \</span>
<span class="sd">    ...   .setLabelColumn(&quot;target_rel&quot;) \</span>
<span class="sd">    ...   .setEpochsNumber(300) \</span>
<span class="sd">    ...   .setBatchSize(200) \</span>
<span class="sd">    ...   .setLearningRate(0.001) \</span>
<span class="sd">    ...   .setModelFile(&quot;path/to/graph_file.pb&quot;) \</span>
<span class="sd">    ...   .setFixImbalance(True) \</span>
<span class="sd">    ...   .setValidationSplit(0.05) \</span>
<span class="sd">    ...   .setFromEntity(&quot;from_begin&quot;, &quot;from_end&quot;, &quot;from_label&quot;) \</span>
<span class="sd">    ...   .setToEntity(&quot;to_begin&quot;, &quot;to_end&quot;, &quot;to_label&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline(stages=[</span>
<span class="sd">    ...     documentAssembler,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     embedder,</span>
<span class="sd">    ...     posTagger,</span>
<span class="sd">    ...     nerTagger,</span>
<span class="sd">    ...     nerConverter,</span>
<span class="sd">    ...     depencyParser,</span>
<span class="sd">    ...     re])</span>

<span class="sd">    &gt;&gt;&gt; model = pipeline.fit(trainData)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;RelationExtractionApproach&quot;</span>

    <span class="n">fromEntityBeginCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;fromEntityBeginCol&quot;</span><span class="p">,</span> <span class="s2">&quot;From Entity Begining Column&quot;</span><span class="p">,</span>
                               <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">fromEntityEndCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;fromEntityEndCol&quot;</span><span class="p">,</span> <span class="s2">&quot;From Entity End Column&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">fromEntityLabelCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;fromEntityLabelCol&quot;</span><span class="p">,</span> <span class="s2">&quot;From Entity Label Column&quot;</span><span class="p">,</span>
                               <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">toEntityBeginCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;toEntityBeginCol&quot;</span><span class="p">,</span> <span class="s2">&quot;To Entity Begining Column&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">toEntityEndCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;toEntityEndCol&quot;</span><span class="p">,</span> <span class="s2">&quot;To Entity End Column&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">toEntityLabelCol</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;toEntityLabelCol&quot;</span><span class="p">,</span> <span class="s2">&quot;To Entity Label Column&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">customLabels</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;customLabels&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;Custom relation labels&quot;</span><span class="p">,</span>
                         <span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

<div class="viewcode-block" id="RelationExtractionApproach.setFromEntity"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RelationExtractionApproach.html#sparknlp_jsl.annotator.RelationExtractionApproach.setFromEntity">[docs]</a>    <span class="k">def</span> <span class="nf">setFromEntity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">begin_col</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="n">label_col</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets from entity</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        begin_col : str</span>
<span class="sd">             Column that has a reference of where the chunk begins</span>
<span class="sd">        end_col: str</span>
<span class="sd">             Column that has a reference of where the chunk end</span>
<span class="sd">        label_col: str</span>
<span class="sd">             Column that has a reference what are the type of chunk</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">fromEntityBeginCol</span><span class="o">=</span><span class="n">begin_col</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">fromEntityEndCol</span><span class="o">=</span><span class="n">end_col</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">fromEntityLabelCol</span><span class="o">=</span><span class="n">label_col</span><span class="p">)</span></div>

<div class="viewcode-block" id="RelationExtractionApproach.setToEntity"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RelationExtractionApproach.html#sparknlp_jsl.annotator.RelationExtractionApproach.setToEntity">[docs]</a>    <span class="k">def</span> <span class="nf">setToEntity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">begin_col</span><span class="p">,</span> <span class="n">end_col</span><span class="p">,</span> <span class="n">label_col</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets to entity</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        begin_col : str</span>
<span class="sd">             Column that has a reference of where the chunk begins</span>
<span class="sd">        end_col: str</span>
<span class="sd">             Column that has a reference of where the chunk end</span>
<span class="sd">        label_col: str</span>
<span class="sd">             Column that has a reference what are the type of chunk</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">toEntityBeginCol</span><span class="o">=</span><span class="n">begin_col</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">toEntityEndCol</span><span class="o">=</span><span class="n">end_col</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">toEntityLabelCol</span><span class="o">=</span><span class="n">label_col</span><span class="p">)</span></div>

<div class="viewcode-block" id="RelationExtractionApproach.setCustomLabels"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RelationExtractionApproach.html#sparknlp_jsl.annotator.RelationExtractionApproach.setCustomLabels">[docs]</a>    <span class="k">def</span> <span class="nf">setCustomLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets custom relation labels</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        labels : dict[str, str]</span>
<span class="sd">            Dictionary which maps old to new labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">CustomLabels</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">customLabels</span><span class="o">=</span><span class="n">CustomLabels</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.re.RelationExtractionApproach&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RelationExtractionApproach</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">)</span></div>


<div class="viewcode-block" id="RelationExtractionModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RelationExtractionModel.html#sparknlp_jsl.annotator.RelationExtractionModel">[docs]</a><span class="k">class</span> <span class="nc">RelationExtractionModel</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Trains a TensorFlow model for relation extraction. The Tensorflow graph in ``.pb`` format needs to be specified with</span>
<span class="sd">    ``setModelFile``. The result is a RelationExtractionModel.</span>
<span class="sd">    To start training, see the parameters that need to be set in the Parameters section.</span>

<span class="sd">    ===========================================  ======================</span>
<span class="sd">    Input Annotation types                       Output Annotation type</span>
<span class="sd">    ===========================================  ======================</span>
<span class="sd">    ``WORD_EMBEDDINGS, POS, CHUNK, DEPENDENCY``  ``CATEGORY``</span>
<span class="sd">    ===========================================  ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    predictionThreshold</span>
<span class="sd">        Minimal activation of the target unit to encode a new relation instance</span>
<span class="sd">    relationPairs</span>
<span class="sd">        List of dash-separated pairs of named entities (&quot;ENTITY1-ENTITY2&quot;, e.g. &quot;Biomarker-RelativeDay&quot;), which will be processed</span>
<span class="sd">    relationPairsCaseSensitive</span>
<span class="sd">        Determines whether relation pairs are case sensitive</span>
<span class="sd">    maxSyntacticDistance</span>
<span class="sd">        Maximal syntactic distance, as threshold (Default: 0)</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \\</span>
<span class="sd">    ...   .setInputCol(&quot;text&quot;) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \\</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;tokens&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; embedder = WordEmbeddingsModel \</span>
<span class="sd">    ...   .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;, &quot;tokens&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;embeddings&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; posTagger = PerceptronModel \\</span>
<span class="sd">    ...   .pretrained(&quot;pos_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;, &quot;tokens&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;posTags&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; nerTagger = MedicalNerModel \\</span>
<span class="sd">    ...   .pretrained(&quot;ner_events_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;, &quot;tokens&quot;, &quot;embeddings&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;ner_tags&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; nerConverter = NerConverter() \\</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;, &quot;tokens&quot;, &quot;ner_tags&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;nerChunks&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; depencyParser = DependencyParserModel \\</span>
<span class="sd">    ...   .pretrained(&quot;dependency_conllu&quot;, &quot;en&quot;) \\</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;, &quot;posTags&quot;, &quot;tokens&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;dependencies&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; relationPairs = [</span>
<span class="sd">    ...   &quot;direction-external_body_part_or_region&quot;,</span>
<span class="sd">    ...   &quot;external_body_part_or_region-direction&quot;,</span>
<span class="sd">    ...   &quot;direction-internal_organ_or_component&quot;,</span>
<span class="sd">    ...   &quot;internal_organ_or_component-direction&quot;</span>
<span class="sd">    ... ]</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; re_model = RelationExtractionModel.pretrained(&quot;re_bodypart_directions&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...     .setInputCols([&quot;embeddings&quot;, &quot;pos_tags&quot;, &quot;ner_chunks&quot;, &quot;dependencies&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;relations&quot;) \\</span>
<span class="sd">    ...     .setRelationPairs(relationPairs) \\</span>
<span class="sd">    ...     .setMaxSyntacticDistance(4) \\</span>
<span class="sd">    ...     .setPredictionThreshold(0.9)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline(stages=[</span>
<span class="sd">    ...     documentAssembler,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     embedder,</span>
<span class="sd">    ...     posTagger,</span>
<span class="sd">    ...     nerTagger,</span>
<span class="sd">    ...     nerConverter,</span>
<span class="sd">    ...     depencyParser,</span>
<span class="sd">    ...     re_model])</span>

<span class="sd">    &gt;&gt;&gt; model = pipeline.fit(trainData)</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;MRI demonstrated infarction in the upper brain stem , left cerebellum and  right basil ganglia&quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; result = pipeline.fit(data).transform(data)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; result.selectExpr(&quot;explode(relations) as relations&quot;)</span>
<span class="sd">    ...  .select(</span>
<span class="sd">    ...    &quot;relations.metadata.chunk1&quot;,</span>
<span class="sd">    ...    &quot;relations.metadata.entity1&quot;,</span>
<span class="sd">    ...    &quot;relations.metadata.chunk2&quot;,</span>
<span class="sd">    ...    &quot;relations.metadata.entity2&quot;,</span>
<span class="sd">    ...    &quot;relations.result&quot;</span>
<span class="sd">    ...  )</span>
<span class="sd">    ...  .where(&quot;result != 0&quot;)</span>
<span class="sd">    ...  .show(truncate=False)</span>
<span class="sd">    ...</span>
<span class="sd">    ... # Show results</span>
<span class="sd">    ... result.selectExpr(&quot;explode(relations) as relations&quot;) \\</span>
<span class="sd">    ...   .select(</span>
<span class="sd">    ...      &quot;relations.metadata.chunk1&quot;,</span>
<span class="sd">    ...      &quot;relations.metadata.entity1&quot;,</span>
<span class="sd">    ...      &quot;relations.metadata.chunk2&quot;,</span>
<span class="sd">    ...      &quot;relations.metadata.entity2&quot;,</span>
<span class="sd">    ...      &quot;relations.result&quot;</span>
<span class="sd">    ...   ).where(&quot;result != 0&quot;) \</span>
<span class="sd">    ...   .show(truncate=False)</span>
<span class="sd">    +------+---------+-------------+---------------------------+------+</span>
<span class="sd">    |chunk1|entity1  |chunk2       |entity2                    |result|</span>
<span class="sd">    +------+---------+-------------+---------------------------+------+</span>
<span class="sd">    |upper |Direction|brain stem   |Internal_organ_or_component|1     |</span>
<span class="sd">    |left  |Direction|cerebellum   |Internal_organ_or_component|1     |</span>
<span class="sd">    |right |Direction|basil ganglia|Internal_organ_or_component|1     |</span>
<span class="sd">    +------+---------+-------------+---------------------------+------+</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;RelationExtractionModel&quot;</span>

    <span class="n">predictionThreshold</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;predictionThreshold&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;Minimal activation of the target unit to encode a new relation instance&quot;</span><span class="p">,</span>
                                <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>

    <span class="n">relationPairs</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;relationPairs&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;List of dash-separated pairs of named entities  which will be processed&quot;</span><span class="p">,</span>
                          <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">relationPairsCaseSensitive</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;relationPairsCaseSensitive&quot;</span><span class="p">,</span> <span class="s2">&quot;Determines whether relation pairs are case sensitive&quot;</span><span class="p">,</span>
                                       <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">maxSyntacticDistance</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;maxSyntacticDistance&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;Maximal syntactic distance, as threshold (Default: 0)&quot;</span><span class="p">,</span>
                                 <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">classes</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;classes&quot;</span><span class="p">,</span> <span class="s2">&quot;Categorization classes&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>
    <span class="n">customLabels</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;customLabels&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;Custom relation labels&quot;</span><span class="p">,</span>
                         <span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

<div class="viewcode-block" id="RelationExtractionModel.setMaxSyntacticDistance"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RelationExtractionModel.html#sparknlp_jsl.annotator.RelationExtractionModel.setMaxSyntacticDistance">[docs]</a>    <span class="k">def</span> <span class="nf">setMaxSyntacticDistance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets maximal syntactic distance, as threshold (Default: 0)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : int</span>
<span class="sd">            Maximal syntactic distance, as threshold (Default: 0)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">maxSyntacticDistance</span><span class="o">=</span><span class="n">distance</span><span class="p">)</span></div>

<div class="viewcode-block" id="RelationExtractionModel.setPredictionThreshold"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RelationExtractionModel.html#sparknlp_jsl.annotator.RelationExtractionModel.setPredictionThreshold">[docs]</a>    <span class="k">def</span> <span class="nf">setPredictionThreshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets Minimal activation of the target unit to encode a new relation instance</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        threshold : float</span>
<span class="sd">            Minimal activation of the target unit to encode a new relation instance</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">predictionThreshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span></div>

<div class="viewcode-block" id="RelationExtractionModel.setRelationPairs"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RelationExtractionModel.html#sparknlp_jsl.annotator.RelationExtractionModel.setRelationPairs">[docs]</a>    <span class="k">def</span> <span class="nf">setRelationPairs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pairs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets List of dash-separated pairs of named entities (&quot;ENTITY1-ENTITY2&quot;, e.g. &quot;Biomarker-RelativeDay&quot;), which will be processed</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pairs : str</span>
<span class="sd">            List of dash-separated pairs of named entities (&quot;ENTITY1-ENTITY2&quot;, e.g. &quot;Biomarker-RelativeDay&quot;), which will be processed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">pairs_str</span> <span class="o">=</span> <span class="n">pairs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pairs_str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">relationPairs</span><span class="o">=</span><span class="n">pairs_str</span><span class="p">)</span></div>

<div class="viewcode-block" id="RelationExtractionModel.setRelationPairsCaseSensitive"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RelationExtractionModel.html#sparknlp_jsl.annotator.RelationExtractionModel.setRelationPairsCaseSensitive">[docs]</a>    <span class="k">def</span> <span class="nf">setRelationPairsCaseSensitive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the case sensitivity of relation pairs</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : boolean</span>
<span class="sd">            whether relation pairs are case sensitive</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">relationPairsCaseSensitive</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="RelationExtractionModel.setCustomLabels"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RelationExtractionModel.html#sparknlp_jsl.annotator.RelationExtractionModel.setCustomLabels">[docs]</a>    <span class="k">def</span> <span class="nf">setCustomLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets custom relation labels</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        labels : dict[str, str]</span>
<span class="sd">            Dictionary which maps old to new labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">CustomLabels</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">customLabels</span><span class="o">=</span><span class="n">CustomLabels</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span></div>

<div class="viewcode-block" id="RelationExtractionModel.getClasses"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RelationExtractionModel.html#sparknlp_jsl.annotator.RelationExtractionModel.getClasses">[docs]</a>    <span class="k">def</span> <span class="nf">getClasses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns labels used to train this model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;getClasses&quot;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.re.RelationExtractionModel&quot;</span><span class="p">,</span>
                 <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RelationExtractionModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span>
            <span class="n">relationPairsCaseSensitive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">maxSyntacticDistance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">predictionThreshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">relationPairs</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp.pretrained</span> <span class="kn">import</span> <span class="n">ResourceDownloader</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;posology_re&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PosologyREModel</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">RelationExtractionModel</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                    <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="IOBTagger"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.IOBTagger.html#sparknlp_jsl.annotator.IOBTagger">[docs]</a><span class="k">class</span> <span class="nc">IOBTagger</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merges token tags and NER labels from chunks in the specified format.</span>
<span class="sd">    For example output columns as inputs from</span>

<span class="sd">    ==========================================  ======================</span>
<span class="sd">    Input Annotation types                      Output Annotation type</span>
<span class="sd">    ==========================================  ======================</span>
<span class="sd">    ``TOKEN, CHUNK``                            ``NAMED_ENTITY``</span>
<span class="sd">    ==========================================  ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Scheme</span>
<span class="sd">        Format of tags, either IOB or BIOES</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \\</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;A 63-year-old man presents to the hospital ...&quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler().setInputCol(&quot;text&quot;).setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentenceDetector = SentenceDetector().setInputCols([&quot;document&quot;]).setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer().setInputCols([&quot;sentence&quot;]).setOutputCol(&quot;token&quot;)</span>
<span class="sd">    &gt;&gt;&gt; embeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;).setOutputCol(&quot;embs&quot;)</span>
<span class="sd">    &gt;&gt;&gt; nerModel = MedicalNerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;).setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embs&quot;]).setOutputCol(&quot;ner&quot;)</span>
<span class="sd">    &gt;&gt;&gt; nerConverter = NerConverter().setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;]).setOutputCol(&quot;ner_chunk&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; iobTagger = IOBTagger().setInputCols([&quot;token&quot;, &quot;ner_chunk&quot;]).setOutputCol(&quot;ner_label&quot;)</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline(stages=[documentAssembler, sentenceDetector, tokenizer, embeddings, nerModel, nerConverter, iobTagger])</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; result.selectExpr(&quot;explode(ner_label) as a&quot;) \</span>
<span class="sd">    ...   .selectExpr(&quot;a.begin&quot;,&quot;a.end&quot;,&quot;a.result as chunk&quot;,&quot;a.metadata.word as word&quot;) \</span>
<span class="sd">    ...   .where(&quot;chunk!=&#39;O&#39;&quot;).show(5, False)</span>
<span class="sd">    +-----+---+-----------+-----------+</span>
<span class="sd">    |begin|end|chunk      |word       |</span>
<span class="sd">    +-----+---+-----------+-----------+</span>
<span class="sd">    |5    |15 |B-Age      |63-year-old|</span>
<span class="sd">    |17   |19 |B-Gender   |man        |</span>
<span class="sd">    |64   |72 |B-Modifier |recurrent  |</span>
<span class="sd">    |98   |107|B-Diagnosis|cellulitis |</span>
<span class="sd">    |110  |119|B-Diagnosis|pneumonias |</span>
<span class="sd">    +-----+---+-----------+-----------+</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;IOBTaggerModel&quot;</span>

    <span class="n">scheme</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;scheme&quot;</span><span class="p">,</span> <span class="s2">&quot;Format of tags, either IOB or BIOES&quot;</span><span class="p">,</span>
                   <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

<div class="viewcode-block" id="IOBTagger.setScheme"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.IOBTagger.html#sparknlp_jsl.annotator.IOBTagger.setScheme">[docs]</a>    <span class="k">def</span> <span class="nf">setScheme</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets format of tags, either IOB or BIOES</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pairs : str</span>
<span class="sd">            Format of tags, either IOB or BIOES</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="n">f</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.ner.IOBTagger&quot;</span><span class="p">,</span>
                 <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IOBTagger</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="NerConverterInternal"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerConverterInternal.html#sparknlp_jsl.annotator.NerConverterInternal">[docs]</a><span class="k">class</span> <span class="nc">NerConverterInternal</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a IOB or IOB2 representation of NER to a user-friendly one,</span>
<span class="sd">    by associating the tokens of recognized entities and their label.</span>
<span class="sd">    Chunks with no associated entity (tagged &quot;O&quot;) are filtered.</span>

<span class="sd">    ==========================================  ======================</span>
<span class="sd">    Input Annotation types                      Output Annotation type</span>
<span class="sd">    ==========================================  ======================</span>
<span class="sd">    ``DOCUMENT, TOKEN, NAMED_ENTITY``           ``CHUNK``</span>
<span class="sd">    ==========================================  ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    whiteList</span>
<span class="sd">        If defined, list of entities to process. The rest will be ignored. Do not include IOB prefix on labels</span>
<span class="sd">    blackList</span>
<span class="sd">        If defined, list of entities to ignore. The rest will be proccessed. Do not include IOB prefix on labels</span>
<span class="sd">    preservePosition</span>
<span class="sd">        Whether to preserve the original position of the tokens in the original document or use the modified tokens</span>
<span class="sd">    greedyMode</span>
<span class="sd">        Whether to ignore B tags for contiguous tokens of same entity same</span>
<span class="sd">    threshold</span>
<span class="sd">        Confidence threshold to filter the chunk entities.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \\</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;A 63-year-old man presents to the hospital ...&quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler().setInputCol(&quot;text&quot;).setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentenceDetector = SentenceDetector().setInputCols([&quot;document&quot;]).setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer().setInputCols([&quot;sentence&quot;]).setOutputCol(&quot;token&quot;)</span>
<span class="sd">    &gt;&gt;&gt; embeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;).setOutputCol(&quot;embs&quot;)</span>
<span class="sd">    &gt;&gt;&gt; nerModel = MedicalNerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;).setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embs&quot;]).setOutputCol(&quot;ner&quot;)</span>
<span class="sd">    &gt;&gt;&gt; nerConverter = NerConverterInternal().setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;]).setOutputCol(&quot;ner_chunk&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline(stages=[</span>
<span class="sd">    ...     documentAssembler,</span>
<span class="sd">    ...     sentenceDetector,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     embeddings,</span>
<span class="sd">    ...     nerModel,</span>
<span class="sd">    ...     nerConverter])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;NerConverterInternal&#39;</span>

    <span class="n">whiteList</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span>
        <span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
        <span class="s2">&quot;whiteList&quot;</span><span class="p">,</span>
        <span class="s2">&quot;If defined, list of entities to process. The rest will be ignored. Do not include IOB prefix on labels&quot;</span><span class="p">,</span>
        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span>
    <span class="p">)</span>

    <span class="n">preservePosition</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span>
        <span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
        <span class="s2">&quot;preservePosition&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Whether to preserve the original position of the tokens in the original document or use the modified tokens&quot;</span><span class="p">,</span>
        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span>
    <span class="p">)</span>

    <span class="n">greedyMode</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span>
        <span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
        <span class="s2">&quot;greedyMode&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Whether to ignore B tags for contiguous tokens of same entity same&quot;</span><span class="p">,</span>
        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span>
    <span class="p">)</span>

    <span class="n">threshold</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span>
        <span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
        <span class="s2">&quot;threshold&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Confidence threshold&quot;</span><span class="p">,</span>
        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span>
    <span class="p">)</span>

    <span class="n">replaceDictResource</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                <span class="s2">&quot;replaceDictResource&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;replace dictionary pairs&quot;</span><span class="p">,</span>
                                <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>
    <span class="n">blackList</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;blackList&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;If defined, list of entities to ignore. The rest will be processed. Do not include IOB prefix on labels&quot;</span><span class="p">,</span>
                      <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

    <span class="n">replaceLabels</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;replaceLabels&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;Custom replace labels&quot;</span><span class="p">,</span>
                         <span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

<div class="viewcode-block" id="NerConverterInternal.setWhiteList"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerConverterInternal.html#sparknlp_jsl.annotator.NerConverterInternal.setWhiteList">[docs]</a>    <span class="k">def</span> <span class="nf">setWhiteList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entities</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;If defined, list of entities to process. The rest will be ignored. Do not include IOB prefix on labels</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        entities : list</span>
<span class="sd">            If defined, list of entities to process. The rest will be ignored. Do not include IOB prefix on labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">whiteList</span><span class="o">=</span><span class="n">entities</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerConverterInternal.setBlackList"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerConverterInternal.html#sparknlp_jsl.annotator.NerConverterInternal.setBlackList">[docs]</a>    <span class="k">def</span> <span class="nf">setBlackList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entities</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;If defined, list of entities to ignore. The rest will be processed. Do not include IOB prefix on labels</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        entities : list</span>
<span class="sd">           If defined, list of entities to ignore. The rest will be processed. Do not include IOB prefix on labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">blackList</span><span class="o">=</span><span class="n">entities</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerConverterInternal.setPreservePosition"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerConverterInternal.html#sparknlp_jsl.annotator.NerConverterInternal.setPreservePosition">[docs]</a>    <span class="k">def</span> <span class="nf">setPreservePosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to preserve the original position of the tokens in the original document or use the modified tokens</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p : bool</span>
<span class="sd">            Whether to preserve the original position of the tokens in the original document or use the modified tokens</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">preservePosition</span><span class="o">=</span><span class="n">p</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerConverterInternal.setGreedyMode"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerConverterInternal.html#sparknlp_jsl.annotator.NerConverterInternal.setGreedyMode">[docs]</a>    <span class="k">def</span> <span class="nf">setGreedyMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets  whether to ignore B tags for contiguous tokens of same entity same</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p : bool</span>
<span class="sd">             Whether to ignore B tags for contiguous tokens of same entity same</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">greedyMode</span><span class="o">=</span><span class="n">p</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerConverterInternal.setThreshold"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerConverterInternal.html#sparknlp_jsl.annotator.NerConverterInternal.setThreshold">[docs]</a>    <span class="k">def</span> <span class="nf">setThreshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets confidence threshold to filter the chunk entities.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p : float</span>
<span class="sd">            Confidence threshold to filter the chunk entities.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="n">p</span><span class="p">)</span></div>

<div class="viewcode-block" id="NerConverterInternal.setReplaceDictResource"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerConverterInternal.html#sparknlp_jsl.annotator.NerConverterInternal.setReplaceDictResource">[docs]</a>    <span class="k">def</span> <span class="nf">setReplaceDictResource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">read_as</span><span class="o">=</span><span class="n">ReadAs</span><span class="o">.</span><span class="n">TEXT</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets replace dictionary pairs</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            Path to the external resource</span>
<span class="sd">        read_as : str, optional</span>
<span class="sd">            How to read the resource, by default ReadAs.TEXT</span>
<span class="sd">        options : dict, optional</span>
<span class="sd">            Options for reading the resource, by default {&quot;format&quot;: &quot;text&quot;}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;delimiter&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">replaceDictResource</span><span class="o">=</span><span class="n">ExternalResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">read_as</span><span class="p">,</span> <span class="n">options</span><span class="p">))</span></div>


<div class="viewcode-block" id="NerConverterInternal.setReplaceLabels"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.NerConverterInternal.html#sparknlp_jsl.annotator.NerConverterInternal.setReplaceLabels">[docs]</a>    <span class="k">def</span> <span class="nf">setReplaceLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets custom relation labels</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        labels : dict[str, str]</span>
<span class="sd">            Dictionary which maps old to new labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">CustomLabels</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">replaceLabels</span><span class="o">=</span><span class="n">CustomLabels</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span></div>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NerConverterInternal</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.ner.NerConverterInternal&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PosologyREModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.PosologyREModel.html#sparknlp_jsl.annotator.PosologyREModel">[docs]</a><span class="k">class</span> <span class="nc">PosologyREModel</span><span class="p">(</span><span class="n">RelationExtractionModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.re.PosologyREModel&quot;</span><span class="p">,</span>
                 <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RelationExtractionModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DrugNormalizer"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DrugNormalizer.html#sparknlp_jsl.annotator.DrugNormalizer">[docs]</a><span class="k">class</span> <span class="nc">DrugNormalizer</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Annotator which normalizes raw text from clinical documents, e.g. scraped web pages or xml documents, from document type columns into Sentence.</span>
<span class="sd">       Removes all dirty characters from text following one or more input regex patterns.</span>
<span class="sd">       Can apply non wanted character removal which a specific policy.</span>
<span class="sd">       Can apply lower case normalization.</span>

<span class="sd">    ==============================  ======================</span>
<span class="sd">    Input Annotation types          Output Annotation type</span>
<span class="sd">    ==============================  ======================</span>
<span class="sd">    ``DOCUMENT``                    ``DOCUMENT``</span>
<span class="sd">    ==============================  ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lowercase</span>
<span class="sd">        whether to convert strings to lowercase</span>
<span class="sd">    policy</span>
<span class="sd">        policy to remove patterns from text. Defaults &quot;all&quot;</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([</span>
<span class="sd">    ...   [&quot;Sodium Chloride/Potassium Chloride 13bag&quot;],</span>
<span class="sd">    ...   [&quot;interferon alfa-2b 10 million unit ( 1 ml ) injec&quot;],</span>
<span class="sd">    ...   [&quot;aspirin 10 meq/ 5 ml oral sol&quot;]</span>
<span class="sd">    ... ]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; document = DocumentAssembler().setInputCol(&quot;text&quot;).setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; drugNormalizer = DrugNormalizer().setInputCols([&quot;document&quot;]).setOutputCol(&quot;document_normalized&quot;)</span>
<span class="sd">    &gt;&gt;&gt; trainingPipeline = Pipeline(stages=[document, drugNormalizer])</span>
<span class="sd">    &gt;&gt;&gt; result = trainingPipeline.fit(data).transform(data)</span>
<span class="sd">    &gt;&gt;&gt; result.selectExpr(&quot;explode(document_normalized.result) as normalized_text&quot;).show(truncate=False)</span>
<span class="sd">    +----------------------------------------------------+</span>
<span class="sd">    |normalized_text                                     |</span>
<span class="sd">    +----------------------------------------------------+</span>
<span class="sd">    |Sodium Chloride / Potassium Chloride 13 bag         |</span>
<span class="sd">    |interferon alfa - 2b 10000000 unt ( 1 ml ) injection|</span>
<span class="sd">    |aspirin 2 meq/ml oral solution                      |</span>
<span class="sd">    +----------------------------------------------------+</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lowercase</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                      <span class="s2">&quot;lowercase&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;whether to convert strings to lowercase&quot;</span><span class="p">,</span>
                      <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">policy</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                   <span class="s2">&quot;policy&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;policy to remove patterns from text. Defaults </span><span class="se">\&quot;</span><span class="s2">all</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span>
                   <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DrugNormalizer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.DrugNormalizer&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span>
            <span class="n">lowercase</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">policy</span><span class="o">=</span><span class="s2">&quot;all&quot;</span>
        <span class="p">)</span>

<div class="viewcode-block" id="DrugNormalizer.setLowercase"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DrugNormalizer.html#sparknlp_jsl.annotator.DrugNormalizer.setLowercase">[docs]</a>    <span class="k">def</span> <span class="nf">setLowercase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to convert strings to lowercase</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p : bool</span>
<span class="sd">            Whether to convert strings to lowercase</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">lowercase</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrugNormalizer.setPolicy"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DrugNormalizer.html#sparknlp_jsl.annotator.DrugNormalizer.setPolicy">[docs]</a>    <span class="k">def</span> <span class="nf">setPolicy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets policy to remove patterns from text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p : str</span>
<span class="sd">            policy to remove patterns from text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">policy</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div></div>


<span class="k">class</span> <span class="nc">_RelationExtractionDLModelLoader</span><span class="p">(</span><span class="n">ExtendedJavaWrapper</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">jspark</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_RelationExtractionDLModelLoader</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;com.johnsnowlabs.nlp.annotators.re.RelationExtractionDLModel.loadSavedModel&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">jspark</span><span class="p">)</span>


<div class="viewcode-block" id="RelationExtractionDLModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RelationExtractionDLModel.html#sparknlp_jsl.annotator.RelationExtractionDLModel">[docs]</a><span class="k">class</span> <span class="nc">RelationExtractionDLModel</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts and classifies instances of relations between named entities.</span>
<span class="sd">    In contrast with RelationExtractionModel, RelationExtractionDLModel is based on BERT.</span>
<span class="sd">    For pretrained models please see the</span>

<span class="sd">    ==========================================  ======================</span>
<span class="sd">    Input Annotation types                      Output Annotation type</span>
<span class="sd">    ==========================================  ======================</span>
<span class="sd">    ``CHUNK, DOCUMENT``                         ``CATEGORY``</span>
<span class="sd">    ==========================================  ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    predictionThreshold</span>
<span class="sd">        Minimal activation of the target unit to encode a new relation instance</span>
<span class="sd">    batchSize</span>
<span class="sd">        Number of relations to process at once</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \\</span>
<span class="sd">    ...   .setInputCol(&quot;text&quot;) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \\</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;tokens&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; embedder = WordEmbeddingsModel \</span>
<span class="sd">    ...   .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;, &quot;tokens&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;embeddings&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; posTagger = PerceptronModel \\</span>
<span class="sd">    ...   .pretrained(&quot;pos_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;, &quot;tokens&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;posTags&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; nerTagger = MedicalNerModel \\</span>
<span class="sd">    ...   .pretrained(&quot;ner_events_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;, &quot;tokens&quot;, &quot;embeddings&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;ner_tags&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; nerConverter = NerConverter() \\</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;, &quot;tokens&quot;, &quot;ner_tags&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;nerChunks&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; depencyParser = DependencyParserModel \\</span>
<span class="sd">    ...   .pretrained(&quot;dependency_conllu&quot;, &quot;en&quot;) \\</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;, &quot;posTags&quot;, &quot;tokens&quot;]) \\</span>
<span class="sd">    ...   .setOutputCol(&quot;dependencies&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; relationPairs = [</span>
<span class="sd">    ...   &quot;direction-external_body_part_or_region&quot;,</span>
<span class="sd">    ...   &quot;external_body_part_or_region-direction&quot;,</span>
<span class="sd">    ...   &quot;direction-internal_organ_or_component&quot;,</span>
<span class="sd">    ...   &quot;internal_organ_or_component-direction&quot;</span>
<span class="sd">    ... ]</span>
<span class="sd">    &gt;&gt;&gt; re_ner_chunk_filter = RENerChunksFilter()\\</span>
<span class="sd">    ...   .setInputCols([&quot;ner_chunks&quot;, &quot;dependencies&quot;])\\</span>
<span class="sd">    ...   .setOutputCol(&quot;re_ner_chunks&quot;)\\</span>
<span class="sd">    ...   .setMaxSyntacticDistance(4)\\</span>
<span class="sd">    ...   .setRelationPairs([&quot;internal_organ_or_component-direction&quot;])</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; re_model = RelationExtractionDLModel.pretrained(&quot;redl_bodypart_direction_biobert&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...     .setInputCols([&quot;re_ner_chunks&quot;, &quot;sentences&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;relations&quot;) \\</span>
<span class="sd">    ...     .setPredictionThreshold(0.5)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline(stages=[</span>
<span class="sd">    ...     documentAssembler,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     embedder,</span>
<span class="sd">    ...     posTagger,</span>
<span class="sd">    ...     nerTagger,</span>
<span class="sd">    ...     nerConverter,</span>
<span class="sd">    ...     depencyParser,</span>
<span class="sd">    ...     re_ner_chunk_filter ,</span>
<span class="sd">    ...     re_model])</span>

<span class="sd">    &gt;&gt;&gt; model = pipeline.fit(trainData)</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;MRI demonstrated infarction in the upper brain stem , left cerebellum and  right basil ganglia&quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; result = pipeline.fit(data).transform(data)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; result.selectExpr(&quot;explode(relations) as relations&quot;)</span>
<span class="sd">    ...  .select(</span>
<span class="sd">    ...    &quot;relations.metadata.chunk1&quot;,</span>
<span class="sd">    ...    &quot;relations.metadata.entity1&quot;,</span>
<span class="sd">    ...    &quot;relations.metadata.chunk2&quot;,</span>
<span class="sd">    ...    &quot;relations.metadata.entity2&quot;,</span>
<span class="sd">    ...    &quot;relations.result&quot;</span>
<span class="sd">    ...  )</span>
<span class="sd">    ...  .where(&quot;result != 0&quot;)</span>
<span class="sd">    ...  .show(truncate=False)</span>
<span class="sd">    ...</span>
<span class="sd">    ... # Show results</span>
<span class="sd">    ... result.selectExpr(&quot;explode(relations) as relations&quot;) \\</span>
<span class="sd">    ...   .select(</span>
<span class="sd">    ...      &quot;relations.metadata.chunk1&quot;,</span>
<span class="sd">    ...      &quot;relations.metadata.entity1&quot;,</span>
<span class="sd">    ...      &quot;relations.metadata.chunk2&quot;,</span>
<span class="sd">    ...      &quot;relations.metadata.entity2&quot;,</span>
<span class="sd">    ...      &quot;relations.result&quot;</span>
<span class="sd">    ...   ).where(&quot;result != 0&quot;) \</span>
<span class="sd">    ...   .show(truncate=False)</span>
<span class="sd">    +------+---------+-------------+---------------------------+------+</span>
<span class="sd">    |chunk1|entity1  |chunk2       |entity2                    |result|</span>
<span class="sd">    +------+---------+-------------+---------------------------+------+</span>
<span class="sd">    |upper |Direction|brain stem   |Internal_organ_or_component|1     |</span>
<span class="sd">    |left  |Direction|cerebellum   |Internal_organ_or_component|1     |</span>
<span class="sd">    |right |Direction|basil ganglia|Internal_organ_or_component|1     |</span>
<span class="sd">    +------+---------+-------------+---------------------------+------+</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;RelationExtractionDLModel&quot;</span>

    <span class="n">predictionThreshold</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;predictionThreshold&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;Minimal activation of the target unit to encode a new relation instance&quot;</span><span class="p">,</span>
                                <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>
    <span class="n">batchSize</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;batchSize&quot;</span><span class="p">,</span> <span class="s2">&quot;Number of relations to process at once&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">classes</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;classes&quot;</span><span class="p">,</span> <span class="s2">&quot;Categorization classes&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>
    <span class="n">customLabels</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;customLabels&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;Custom relation labels&quot;</span><span class="p">,</span>
                         <span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

<div class="viewcode-block" id="RelationExtractionDLModel.setPredictionThreshold"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RelationExtractionDLModel.html#sparknlp_jsl.annotator.RelationExtractionDLModel.setPredictionThreshold">[docs]</a>    <span class="k">def</span> <span class="nf">setPredictionThreshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets maximum syntactic distance between a pair of named entities to consider them as a relation</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        threshold : float</span>
<span class="sd">           maximum syntactic distance between a pair of named entities to consider them as a relation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">predictionThreshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span></div>

    <span class="c1"># TODO set up this value</span>
    <span class="k">def</span> <span class="nf">setCaseSensitive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">caseSensitive</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="RelationExtractionDLModel.setBatchSize"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RelationExtractionDLModel.html#sparknlp_jsl.annotator.RelationExtractionDLModel.setBatchSize">[docs]</a>    <span class="k">def</span> <span class="nf">setBatchSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets number of relations to process at once</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">           Number of relations to process at once</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">batchSize</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="RelationExtractionDLModel.setCustomLabels"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RelationExtractionDLModel.html#sparknlp_jsl.annotator.RelationExtractionDLModel.setCustomLabels">[docs]</a>    <span class="k">def</span> <span class="nf">setCustomLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets custom relation labels</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        labels : dict[str, str]</span>
<span class="sd">            Dictionary which maps old to new labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">CustomLabels</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">customLabels</span><span class="o">=</span><span class="n">CustomLabels</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span></div>

<div class="viewcode-block" id="RelationExtractionDLModel.getClasses"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RelationExtractionDLModel.html#sparknlp_jsl.annotator.RelationExtractionDLModel.getClasses">[docs]</a>    <span class="k">def</span> <span class="nf">getClasses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns labels used to train this model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;getClasses&quot;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.re.RelationExtractionDLModel&quot;</span><span class="p">,</span>
                 <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RelationExtractionDLModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span>
            <span class="n">batchSize</span><span class="o">=</span><span class="mi">10</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">loadSavedModel</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">spark_session</span><span class="p">):</span>
        <span class="n">jModel</span> <span class="o">=</span> <span class="n">_RelationExtractionDLModelLoader</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">spark_session</span><span class="o">.</span><span class="n">_jsparkSession</span><span class="p">)</span><span class="o">.</span><span class="n">_java_obj</span>
        <span class="k">return</span> <span class="n">RelationExtractionDLModel</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">jModel</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.pretrained</span> <span class="kn">import</span> <span class="n">InternalResourceDownloader</span>
        <span class="k">return</span> <span class="n">InternalResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">RelationExtractionDLModel</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="RENerChunksFilter"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RENerChunksFilter.html#sparknlp_jsl.annotator.RENerChunksFilter">[docs]</a><span class="k">class</span> <span class="nc">RENerChunksFilter</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Filters and outputs combinations of relations between extracted entities, for further processing.</span>
<span class="sd">    This annotator is especially useful to create inputs for the RelationExtractionDLModel.</span>

<span class="sd">    ==============================  ======================</span>
<span class="sd">    Input Annotation types          Output Annotation type</span>
<span class="sd">    ==============================  ======================</span>
<span class="sd">    ``CHUNK,DEPENDENCY``            ``CHUNK``</span>
<span class="sd">    ==============================  ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    relationPairs</span>
<span class="sd">        List of valid relations to encode</span>
<span class="sd">    relationPairsCaseSensitive</span>
<span class="sd">        Determines whether relation pairs are case sensitive</span>
<span class="sd">    maxSyntacticDistance</span>
<span class="sd">        Maximum syntactic distance between a pair of named entities to consider them as a relation</span>
<span class="sd">    docLevelRelations</span>
<span class="sd">        Include relations between entities from different sentences (Default: False)</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; documenter = DocumentAssembler()\\</span>
<span class="sd">    ...   .setInputCol(&quot;text&quot;)\\</span>
<span class="sd">    ...   .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; sentencer = SentenceDetector()\\</span>
<span class="sd">    ...   .setInputCols([&quot;document&quot;])\\</span>
<span class="sd">    ...   .setOutputCol(&quot;sentences&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer()\\</span>
<span class="sd">    ...   .setInputCols([&quot;sentences&quot;])\\</span>
<span class="sd">    ...   .setOutputCol(&quot;tokens&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; words_embedder = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\\</span>
<span class="sd">    ...   .setInputCols([&quot;sentences&quot;, &quot;tokens&quot;])\\</span>
<span class="sd">    ...   .setOutputCol(&quot;embeddings&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; pos_tagger = PerceptronModel.pretrained(&quot;pos_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\\</span>
<span class="sd">    ...   .setInputCols([&quot;sentences&quot;, &quot;tokens&quot;])\\</span>
<span class="sd">    ...   .setOutputCol(&quot;pos_tags&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; dependency_parser = DependencyParserModel.pretrained(&quot;dependency_conllu&quot;, &quot;en&quot;)\\</span>
<span class="sd">    ...   .setInputCols([&quot;sentences&quot;, &quot;pos_tags&quot;, &quot;tokens&quot;])\\</span>
<span class="sd">    ...   .setOutputCol(&quot;dependencies&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; clinical_ner_tagger = MedicalNerModel.pretrained(&quot;jsl_ner_wip_greedy_clinical&quot;,&quot;en&quot;,&quot;clinical/models&quot;)\\</span>
<span class="sd">    ...   .setInputCols([&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;])\\</span>
<span class="sd">    ...   .setOutputCol(&quot;ner_tags&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; ner_chunker = NerConverter()\\</span>
<span class="sd">    ...   .setInputCols([&quot;sentences&quot;, &quot;tokens&quot;, &quot;ner_tags&quot;])\\</span>
<span class="sd">    ...   .setOutputCol(&quot;ner_chunks&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    ... # Define the relation pairs and the filter</span>
<span class="sd">    &gt;&gt;&gt; relationPairs = [</span>
<span class="sd">    ...   &quot;direction-external_body_part_or_region&quot;,</span>
<span class="sd">    ...   &quot;external_body_part_or_region-direction&quot;,</span>
<span class="sd">    ...   &quot;direction-internal_organ_or_component&quot;,</span>
<span class="sd">    ...   &quot;internal_organ_or_component-direction&quot;</span>
<span class="sd">    ... ]</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; re_ner_chunk_filter = RENerChunksFilter()\\</span>
<span class="sd">    ...   .setInputCols([&quot;ner_chunks&quot;, &quot;dependencies&quot;])\\</span>
<span class="sd">    ...   .setOutputCol(&quot;re_ner_chunks&quot;)\\</span>
<span class="sd">    ...   .setMaxSyntacticDistance(4)\\</span>
<span class="sd">    ...   .setRelationPairs([&quot;internal_organ_or_component-direction&quot;])</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; trained_pipeline = Pipeline(stages=[</span>
<span class="sd">    ...   documenter,</span>
<span class="sd">    ...   sentencer,</span>
<span class="sd">    ...   tokenizer,</span>
<span class="sd">    ...   words_embedder,</span>
<span class="sd">    ...   pos_tagger,</span>
<span class="sd">    ...   clinical_ner_tagger,</span>
<span class="sd">    ...   ner_chunker,</span>
<span class="sd">    ...   dependency_parser,</span>
<span class="sd">    ...   re_ner_chunk_filter</span>
<span class="sd">    ... ])</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; data = spark.cre&gt;&gt;&gt;DataFrame([[&quot;MRI demonstrated infarction in the upper brain stem , left cerebellum and  right basil ganglia&quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; result = trained_pipeline.fit(data).transform(data)</span>
<span class="sd">    ...</span>
<span class="sd">    ... # Show results</span>
<span class="sd">    &gt;&gt;&gt; result.selectExpr(&quot;explode(re_ner_chunks) as re_chunks&quot;) \</span>
<span class="sd">    ...   .selectExpr(&quot;re_chunks.begin&quot;, &quot;re_chunks.result&quot;, &quot;re_chunks.metadata.entity&quot;, &quot;re_chunks.metadata.paired_to&quot;) \</span>
<span class="sd">    ...   .show(6, truncate=False)</span>
<span class="sd">    +-----+-------------+---------------------------+---------+</span>
<span class="sd">    |begin|result       |entity                     |paired_to|</span>
<span class="sd">    +-----+-------------+---------------------------+---------+</span>
<span class="sd">    |35   |upper        |Direction                  |41       |</span>
<span class="sd">    |41   |brain stem   |Internal_organ_or_component|35       |</span>
<span class="sd">    |35   |upper        |Direction                  |59       |</span>
<span class="sd">    |59   |cerebellum   |Internal_organ_or_component|35       |</span>
<span class="sd">    |35   |upper        |Direction                  |81       |</span>
<span class="sd">    |81   |basil ganglia|Internal_organ_or_component|35       |</span>
<span class="sd">    +-----+-------------+---------------------------+---------+</span>
<span class="sd">    +---------------------------------------------------------+</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;RENerChunksFilter&quot;</span>

    <span class="n">relationPairs</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;relationPairs&quot;</span><span class="p">,</span> <span class="s2">&quot;List of dash-separated pairs of named entitiese&quot;</span><span class="p">,</span>
                          <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">relationPairsCaseSensitive</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;relationPairsCaseSensitive&quot;</span><span class="p">,</span> <span class="s2">&quot;Determines whether relation pairs are case sensitive&quot;</span><span class="p">,</span>
                                       <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">maxSyntacticDistance</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;maxSyntacticDistance&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;Maximum syntactic distance between a pair of named entities to consider them as a relation&quot;</span><span class="p">,</span>
                                 <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">docLevelRelations</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;docLevelRelations&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;Include relations between entities from different sentences (Default: False)&quot;</span><span class="p">,</span>
                              <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

<div class="viewcode-block" id="RENerChunksFilter.setMaxSyntacticDistance"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RENerChunksFilter.html#sparknlp_jsl.annotator.RENerChunksFilter.setMaxSyntacticDistance">[docs]</a>    <span class="k">def</span> <span class="nf">setMaxSyntacticDistance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets maximum syntactic distance between a pair of named entities to consider them as a relation&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        distance : int</span>
<span class="sd">           Maximum syntactic distance between a pair of named entities to consider them as a relation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">maxSyntacticDistance</span><span class="o">=</span><span class="n">distance</span><span class="p">)</span></div>

<div class="viewcode-block" id="RENerChunksFilter.setDocLevelRelations"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RENerChunksFilter.html#sparknlp_jsl.annotator.RENerChunksFilter.setDocLevelRelations">[docs]</a>    <span class="k">def</span> <span class="nf">setDocLevelRelations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docLevelRelations</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to include relations between entities from different sentences</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        docLevelRelations : bool</span>
<span class="sd">            Whether to include relations between entities from different sentences</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">docLevelRelations</span><span class="o">=</span><span class="n">docLevelRelations</span><span class="p">)</span></div>

<div class="viewcode-block" id="RENerChunksFilter.setRelationPairs"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RENerChunksFilter.html#sparknlp_jsl.annotator.RENerChunksFilter.setRelationPairs">[docs]</a>    <span class="k">def</span> <span class="nf">setRelationPairs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pairs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets list of dash-separated pairs of named entities</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pairs : str</span>
<span class="sd">           List of dash-separated pairs of named entities</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">pairs_str</span> <span class="o">=</span> <span class="n">pairs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pairs_str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">relationPairs</span><span class="o">=</span><span class="n">pairs_str</span><span class="p">)</span></div>

<div class="viewcode-block" id="RENerChunksFilter.setRelationPairsCaseSensitive"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.RENerChunksFilter.html#sparknlp_jsl.annotator.RENerChunksFilter.setRelationPairsCaseSensitive">[docs]</a>    <span class="k">def</span> <span class="nf">setRelationPairsCaseSensitive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the case sensitivity of relation pairs</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : boolean</span>
<span class="sd">            whether relation pairs are case sensitive</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">relationPairsCaseSensitive</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.re.RENerChunksFilter&quot;</span><span class="p">,</span>
                 <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RENerChunksFilter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span>
            <span class="n">relationPairsCaseSensitive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">maxSyntacticDistance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">docLevelRelations</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">relationPairs</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="AssertionFilterer"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionFilterer.html#sparknlp_jsl.annotator.AssertionFilterer">[docs]</a><span class="k">class</span> <span class="nc">AssertionFilterer</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Filters entities coming from ASSERTION type annotations and returns the CHUNKS.</span>
<span class="sd">    Filters can be set via a white list on the extracted chunk, the assertion or a regular expression.</span>
<span class="sd">    White list for assertion is enabled by default. To use chunk white list, ``criteria`` has to be set to ``isin``.</span>
<span class="sd">    For regex, ``criteria`` has to be set to ``regex``.</span>

<span class="sd">    ==============================  ======================</span>
<span class="sd">    Input Annotation types          Output Annotation type</span>
<span class="sd">    ==============================  ======================</span>
<span class="sd">    ``DOCUMENT, CHUNK, ASSERTION``  ``CHUNK``</span>
<span class="sd">    ==============================  ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    whiteList</span>
<span class="sd">        If defined, list of entities to process. The rest will be ignored</span>
<span class="sd">    regex</span>
<span class="sd">        If defined, list of entities to process. The rest will be ignored.</span>
<span class="sd">    criteria</span>
<span class="sd">           Tag representing what is the criteria to filter the chunks. possibles values (assertion|isIn|regex)</span>
<span class="sd">                assertion: Filter by the assertion</span>
<span class="sd">                isIn : Filter by the chunk</span>
<span class="sd">                regex : Filter using a regex</span>
<span class="sd">    entitiesConfidence</span>
<span class="sd">        Entity pairs to remove based on the confidence level</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>


<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">     To see how the assertions are extracted, see the example for AssertionDLModel.</span>
<span class="sd">     Define an extra step where the assertions are filtered</span>
<span class="sd">    &gt;&gt;&gt; assertionFilterer = AssertionFilterer() \\</span>
<span class="sd">    ...   .setInputCols([&quot;sentence&quot;,&quot;ner_chunk&quot;,&quot;assertion&quot;]) \\</span>
<span class="sd">    ...    .setOutputCol(&quot;filtered&quot;) \\</span>
<span class="sd">    ...   .setCriteria(&quot;assertion&quot;) \\</span>
<span class="sd">    ...   .setWhiteList([&quot;present&quot;])</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; assertionPipeline = Pipeline(stages=[</span>
<span class="sd">    ...   documentAssembler,</span>
<span class="sd">    ...   sentenceDetector,</span>
<span class="sd">    ...   tokenizer,</span>
<span class="sd">    ...   embeddings,</span>
<span class="sd">    ...   nerModel,</span>
<span class="sd">    ...   nerConverter,</span>
<span class="sd">    ...   clinicalAssertion,</span>
<span class="sd">    ...   assertionFilterer</span>
<span class="sd">    ... ])</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; assertionModel = assertionPipeline.fit(data)</span>
<span class="sd">    &gt;&gt;&gt; result = assertionModel.transform(data)</span>


<span class="sd">    &gt;&gt;&gt; result.selectExpr(&quot;ner_chunk.result&quot;, &quot;assertion.result&quot;).show(3, truncate=False)</span>
<span class="sd">    +--------------------------------+--------------------------------+</span>
<span class="sd">    |result                          |result                          |</span>
<span class="sd">    +--------------------------------+--------------------------------+</span>
<span class="sd">    |[severe fever, sore throat]     |[present, present]              |</span>
<span class="sd">    |[stomach pain]                  |[absent]                        |</span>
<span class="sd">    |[an epidural, PCA, pain control]|[present, present, hypothetical]|</span>
<span class="sd">    +--------------------------------+--------------------------------+</span>

<span class="sd">    &gt;&gt;&gt; result.select(&quot;filtered.result&quot;).show(3, truncate=False)</span>
<span class="sd">    +---------------------------+</span>
<span class="sd">    |result                     |</span>
<span class="sd">    +---------------------------+</span>
<span class="sd">    |[severe fever, sore throat]|</span>
<span class="sd">    |[]                         |</span>
<span class="sd">    |[an epidural, PCA]         |</span>
<span class="sd">    +---------------------------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ChunksFilter&quot;</span>

    <span class="n">whiteList</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span>
        <span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
        <span class="s2">&quot;whiteList&quot;</span><span class="p">,</span>
        <span class="s2">&quot;If defined, list of entities to process. The rest will be ignored.&quot;</span><span class="p">,</span>
        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span>
    <span class="p">)</span>

    <span class="n">regex</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span>
        <span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
        <span class="s2">&quot;regex&quot;</span><span class="p">,</span>
        <span class="s2">&quot;If defined, list of regex to process. The rest will be ignored.&quot;</span><span class="p">,</span>
        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span>
    <span class="p">)</span>

    <span class="n">criteria</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;criteria&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Assertion find by assertion&quot;</span><span class="p">,</span>
                     <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">entitiesConfidence</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                               <span class="s2">&quot;entitiesConfidence&quot;</span><span class="p">,</span>
                               <span class="s2">&quot;Entity pairs to remove based on the confidence level&quot;</span><span class="p">,</span>
                               <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

<div class="viewcode-block" id="AssertionFilterer.setWhiteList"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionFilterer.html#sparknlp_jsl.annotator.AssertionFilterer.setWhiteList">[docs]</a>    <span class="k">def</span> <span class="nf">setWhiteList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets list of entities to process. The rest will be ignored.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : list</span>
<span class="sd">           If defined, list of entities to process. The rest will be ignored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">whiteList</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionFilterer.setRegex"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionFilterer.html#sparknlp_jsl.annotator.AssertionFilterer.setRegex">[docs]</a>    <span class="k">def</span> <span class="nf">setRegex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets llist of regex to process. The rest will be ignored.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : list</span>
<span class="sd">           List of dash-separated pairs of named entities</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="AssertionFilterer.setCriteria"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AssertionFilterer.html#sparknlp_jsl.annotator.AssertionFilterer.setCriteria">[docs]</a>    <span class="k">def</span> <span class="nf">setCriteria</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set tag representing what is the criteria to filter the chunks. possibles values (assertion|isIn|regex)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pairs : list</span>
<span class="sd">           List of dash-separated pairs of named entities</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">criteria</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

    <span class="c1"># TODO set confidence</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.chunker.AssertionFilterer&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AssertionFilterer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="ChunkFiltererApproach"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkFiltererApproach.html#sparknlp_jsl.annotator.ChunkFiltererApproach">[docs]</a><span class="k">class</span> <span class="nc">ChunkFiltererApproach</span><span class="p">(</span><span class="n">AnnotatorApproach</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Model that Filters entities coming from CHUNK annotations. Filters can be set via a white list of terms or a regular expression.</span>
<span class="sd">        White list criteria is enabled by default. To use regex, `criteria` has to be set to `regex`.</span>

<span class="sd">    ==============================  ======================</span>
<span class="sd">    Input Annotation types          Output Annotation type</span>
<span class="sd">    ==============================  ======================</span>
<span class="sd">    ``DOCUMENT, CHUNK, ASSERTION``  ``CHUNK``</span>
<span class="sd">    ==============================  ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    whiteList</span>
<span class="sd">        If defined, list of entities to process. The rest will be ignored</span>
<span class="sd">    regex</span>
<span class="sd">        If defined, list of entities to process. The rest will be ignored.</span>
<span class="sd">    criteria</span>
<span class="sd">           Tag representing what is the criteria to filter the chunks. possibles values (assertion|isIn|regex)</span>
<span class="sd">                isIn : Filter by the chunk</span>
<span class="sd">                regex : Filter using a regex</span>
<span class="sd">    entitiesConfidence</span>
<span class="sd">        Path to csv with  pairs (entity,confidenceThreshold). Filter the chunks with  entities which have confidence lower than the confidence threshold.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;Has a past history of gastroenteritis and stomach pain, however patient ...&quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; docAssembler = DocumentAssembler().setInputCol(&quot;text&quot;).setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentenceDetector = SentenceDetector().setInputCols([&quot;document&quot;]).setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer().setInputCols([&quot;sentence&quot;]).setOutputCol(&quot;token&quot;)</span>
<span class="sd">    &gt;&gt;&gt; posTagger = PerceptronModel.pretrained() \</span>
<span class="sd">    ...    .setInputCols([&quot;sentence&quot;, &quot;token&quot;]) \</span>
<span class="sd">    ...    .setOutputCol(&quot;pos&quot;)</span>
<span class="sd">    &gt;&gt;&gt; chunker = Chunker() \</span>
<span class="sd">    ...   .setInputCols([&quot;pos&quot;, &quot;sentence&quot;]) \</span>
<span class="sd">    ...   .setOutputCol(&quot;chunk&quot;) \</span>
<span class="sd">    ...   .setRegexParsers([&quot;(&lt;NN&gt;)+&quot;])</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; chunkerFilter = ChunkFiltererApproach() \</span>
<span class="sd">    ...   .setInputCols([&quot;sentence&quot;,&quot;chunk&quot;]) \</span>
<span class="sd">    ...   .setOutputCol(&quot;filtered&quot;) \</span>
<span class="sd">    ...   .setCriteria(&quot;isin&quot;) \</span>
<span class="sd">    ...   .setWhiteList([&quot;gastroenteritis&quot;])</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline(stages=[</span>
<span class="sd">    ...   docAssembler,</span>
<span class="sd">    ...   sentenceDetector,</span>
<span class="sd">    ...   tokenizer,</span>
<span class="sd">    ...   posTagger,</span>
<span class="sd">    ...   chunker,</span>
<span class="sd">    ...   chunkerFilter])</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; result = pipeline.fit(data).transform(data)</span>
<span class="sd">    &gt;&gt;&gt; result.selectExpr(&quot;explode(chunk)&quot;).show(truncate=False)</span>

<span class="sd">    &gt;&gt;&gt; result.selectExpr(&quot;explode(chunk)&quot;).show(truncate=False)</span>
<span class="sd">    +---------------------------------------------------------------------------------+</span>
<span class="sd">    |col                                                                              |</span>
<span class="sd">    +---------------------------------------------------------------------------------+</span>
<span class="sd">    |{chunk, 11, 17, history, {sentence -&gt; 0, chunk -&gt; 0}, []}                        |</span>
<span class="sd">    |{chunk, 22, 36, gastroenteritis, {sentence -&gt; 0, chunk -&gt; 1}, []}                |</span>
<span class="sd">    |{chunk, 42, 53, stomach pain, {sentence -&gt; 0, chunk -&gt; 2}, []}                   |</span>
<span class="sd">    |{chunk, 64, 70, patient, {sentence -&gt; 0, chunk -&gt; 3}, []}                        |</span>
<span class="sd">    |{chunk, 81, 110, stomach pain now.We don&#39;t care, {sentence -&gt; 0, chunk -&gt; 4}, []}|</span>
<span class="sd">    |{chunk, 118, 132, gastroenteritis, {sentence -&gt; 0, chunk -&gt; 5}, []}              |</span>
<span class="sd">    +---------------------------------------------------------------------------------+</span>

<span class="sd">    &gt;&gt;&gt; result.selectExpr(&quot;explode(filtered)&quot;).show(truncate=False)</span>
<span class="sd">    +-------------------------------------------------------------------+</span>
<span class="sd">    |col                                                                |</span>
<span class="sd">    +-------------------------------------------------------------------+</span>
<span class="sd">    |{chunk, 22, 36, gastroenteritis, {sentence -&gt; 0, chunk -&gt; 1}, []}  |</span>
<span class="sd">    |{chunk, 118, 132, gastroenteritis, {sentence -&gt; 0, chunk -&gt; 5}, []}|</span>
<span class="sd">    +-------------------------------------------------------------------+</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ChunksFilterApproach&quot;</span>

    <span class="n">whiteList</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span>
        <span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
        <span class="s2">&quot;whiteList&quot;</span><span class="p">,</span>
        <span class="s2">&quot;If defined, list of entities to process. The rest will be ignored.&quot;</span><span class="p">,</span>
        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span>
    <span class="p">)</span>

    <span class="n">regex</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span>
        <span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
        <span class="s2">&quot;regex&quot;</span><span class="p">,</span>
        <span class="s2">&quot;If defined, list of entities to process. The rest will be ignored.&quot;</span><span class="p">,</span>
        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span>
    <span class="p">)</span>

    <span class="n">filterValue</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span>
        <span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
        <span class="s2">&quot;filterValue&quot;</span><span class="p">,</span>
        <span class="s2">&quot;possibles values result|entity.&quot;</span><span class="p">,</span>
        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span>
    <span class="p">)</span>

    <span class="n">criteria</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;criteria&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Select mode&quot;</span><span class="p">,</span>
                     <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">entitiesConfidenceResource</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                       <span class="s2">&quot;entitiesConfidenceResource&quot;</span><span class="p">,</span>
                                       <span class="s2">&quot;Path to csv with  entity pairs to remove based on the confidance level&quot;</span><span class="p">,</span>
                                       <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

<div class="viewcode-block" id="ChunkFiltererApproach.setWhiteList"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkFiltererApproach.html#sparknlp_jsl.annotator.ChunkFiltererApproach.setWhiteList">[docs]</a>    <span class="k">def</span> <span class="nf">setWhiteList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets list of entities to process. The rest will be ignored.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : list</span>
<span class="sd">           If defined, list of entities to process. The rest will be ignored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">whiteList</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="ChunkFiltererApproach.setRegex"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkFiltererApproach.html#sparknlp_jsl.annotator.ChunkFiltererApproach.setRegex">[docs]</a>    <span class="k">def</span> <span class="nf">setRegex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets llist of regex to process. The rest will be ignored.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : list</span>
<span class="sd">           List of dash-separated pairs of named entities</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="ChunkFiltererApproach.setCriteria"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkFiltererApproach.html#sparknlp_jsl.annotator.ChunkFiltererApproach.setCriteria">[docs]</a>    <span class="k">def</span> <span class="nf">setCriteria</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set tag representing what is the criteria to filter the chunks. possibles values (isIn|regex)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : str</span>
<span class="sd">           List of dash-separated pairs of named entities</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">criteria</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="ChunkFiltererApproach.setFilterEntity"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkFiltererApproach.html#sparknlp_jsl.annotator.ChunkFiltererApproach.setFilterEntity">[docs]</a>    <span class="k">def</span> <span class="nf">setFilterEntity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set tag representing what is the criteria to filter the chunks. possibles values (assertion|isIn|regex)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : str</span>
<span class="sd">           possibles values result|entity.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">filterValue</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">setEntitiesConfidenceResource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">read_as</span><span class="o">=</span><span class="n">ReadAs</span><span class="o">.</span><span class="n">TEXT</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;delimiter&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">entitiesConfidenceResource</span><span class="o">=</span><span class="n">ExternalResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">read_as</span><span class="p">,</span> <span class="n">options</span><span class="p">))</span>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.chunker.ChunkFiltererApproach&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ChunkFiltererApproach</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ChunkFilterer</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span><span class="p">)</span></div>


<div class="viewcode-block" id="ChunkFilterer"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkFilterer.html#sparknlp_jsl.annotator.ChunkFilterer">[docs]</a><span class="k">class</span> <span class="nc">ChunkFilterer</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Model that Filters entities coming from CHUNK annotations. Filters can be set via a white list of terms or a regular expression.</span>
<span class="sd">        White list criteria is enabled by default. To use regex, `criteria` has to be set to `regex`.This model was trained using the ChunkFiltererApproach</span>
<span class="sd">        and has embeded the list of pairs (entity,confidenceThreshold).</span>

<span class="sd">       ==============================  ======================</span>
<span class="sd">       Input Annotation types          Output Annotation type</span>
<span class="sd">       ==============================  ======================</span>
<span class="sd">       ``DOCUMENT, CHUNK, ASSERTION``  ``CHUNK``</span>
<span class="sd">       ==============================  ======================</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       whiteList</span>
<span class="sd">           If defined, list of entities to process. The rest will be ignored</span>
<span class="sd">       regex</span>
<span class="sd">           If defined, list of entities to process. The rest will be ignored.</span>
<span class="sd">       criteria</span>
<span class="sd">              Tag representing what is the criteria to filter the chunks. possibles values (assertion|isIn|regex)</span>
<span class="sd">                   isIn : Filter by the chunk</span>
<span class="sd">                   regex : Filter using a regex</span>

<span class="sd">       Examples</span>
<span class="sd">       --------</span>

<span class="sd">       &gt;&gt;&gt; import sparknlp</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">       &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">       &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">       &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">       &gt;&gt;&gt; data = spark.createDataFrame([[&quot;Has a past history of gastroenteritis and stomach pain, however patient ...&quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">       &gt;&gt;&gt; docAssembler = DocumentAssembler().setInputCol(&quot;text&quot;).setOutputCol(&quot;document&quot;)</span>
<span class="sd">       &gt;&gt;&gt; sentenceDetector = SentenceDetector().setInputCols([&quot;document&quot;]).setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">       &gt;&gt;&gt; tokenizer = Tokenizer().setInputCols([&quot;sentence&quot;]).setOutputCol(&quot;token&quot;)</span>
<span class="sd">       &gt;&gt;&gt; posTagger = PerceptronModel.pretrained() \</span>
<span class="sd">       ...    .setInputCols([&quot;sentence&quot;, &quot;token&quot;]) \</span>
<span class="sd">       ...    .setOutputCol(&quot;pos&quot;)</span>
<span class="sd">       &gt;&gt;&gt; chunker = Chunker() \</span>
<span class="sd">       ...   .setInputCols([&quot;pos&quot;, &quot;sentence&quot;]) \</span>
<span class="sd">       ...   .setOutputCol(&quot;chunk&quot;) \</span>
<span class="sd">       ...   .setRegexParsers([&quot;(&lt;NN&gt;)+&quot;])</span>
<span class="sd">       ...</span>
<span class="sd">       &gt;&gt;&gt; chunkerFilter = ChunkFilterer() \</span>
<span class="sd">       ...   .setInputCols([&quot;sentence&quot;,&quot;chunk&quot;]) \</span>
<span class="sd">       ...   .setOutputCol(&quot;filtered&quot;) \</span>
<span class="sd">       ...   .setCriteria(&quot;isin&quot;) \</span>
<span class="sd">       ...   .setWhiteList([&quot;gastroenteritis&quot;])</span>
<span class="sd">       ...</span>
<span class="sd">       &gt;&gt;&gt; pipeline = Pipeline(stages=[</span>
<span class="sd">       ...   docAssembler,</span>
<span class="sd">       ...   sentenceDetector,</span>
<span class="sd">       ...   tokenizer,</span>
<span class="sd">       ...   posTagger,</span>
<span class="sd">       ...   chunker,</span>
<span class="sd">       ...   chunkerFilter])</span>
<span class="sd">       ...</span>
<span class="sd">       &gt;&gt;&gt; result = pipeline.fit(data).transform(data)</span>
<span class="sd">       &gt;&gt;&gt; result.selectExpr(&quot;explode(chunk)&quot;).show(truncate=False)</span>


<span class="sd">       &gt;&gt;&gt; result.selectExpr(&quot;explode(chunk)&quot;).show(truncate=False)</span>
<span class="sd">       +---------------------------------------------------------------------------------+</span>
<span class="sd">       |col                                                                              |</span>
<span class="sd">       +---------------------------------------------------------------------------------+</span>
<span class="sd">       |{chunk, 11, 17, history, {sentence -&gt; 0, chunk -&gt; 0}, []}                        |</span>
<span class="sd">       |{chunk, 22, 36, gastroenteritis, {sentence -&gt; 0, chunk -&gt; 1}, []}                |</span>
<span class="sd">       |{chunk, 42, 53, stomach pain, {sentence -&gt; 0, chunk -&gt; 2}, []}                   |</span>
<span class="sd">       |{chunk, 64, 70, patient, {sentence -&gt; 0, chunk -&gt; 3}, []}                        |</span>
<span class="sd">       |{chunk, 81, 110, stomach pain now.We don&#39;t care, {sentence -&gt; 0, chunk -&gt; 4}, []}|</span>
<span class="sd">       |{chunk, 118, 132, gastroenteritis, {sentence -&gt; 0, chunk -&gt; 5}, []}              |</span>
<span class="sd">       +---------------------------------------------------------------------------------+</span>

<span class="sd">       &gt;&gt;&gt; result.selectExpr(&quot;explode(filtered)&quot;).show(truncate=False)</span>
<span class="sd">       +-------------------------------------------------------------------+</span>
<span class="sd">       |col                                                                |</span>
<span class="sd">       +-------------------------------------------------------------------+</span>
<span class="sd">       |{chunk, 22, 36, gastroenteritis, {sentence -&gt; 0, chunk -&gt; 1}, []}  |</span>
<span class="sd">       |{chunk, 118, 132, gastroenteritis, {sentence -&gt; 0, chunk -&gt; 5}, []}|</span>
<span class="sd">       +-------------------------------------------------------------------+</span>
<span class="sd">         &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ChunkFilterer&quot;</span>

    <span class="n">whiteList</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span>
        <span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
        <span class="s2">&quot;whiteList&quot;</span><span class="p">,</span>
        <span class="s2">&quot;If defined, list of entities to process. The rest will be ignored.&quot;</span><span class="p">,</span>
        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span>
    <span class="p">)</span>

    <span class="n">regex</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span>
        <span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
        <span class="s2">&quot;regex&quot;</span><span class="p">,</span>
        <span class="s2">&quot;If defined, list of entities to process. The rest will be ignored.&quot;</span><span class="p">,</span>
        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span>
    <span class="p">)</span>

    <span class="n">filterValue</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span>
        <span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
        <span class="s2">&quot;filterValue&quot;</span><span class="p">,</span>
        <span class="s2">&quot;possibles values result|entity.&quot;</span><span class="p">,</span>
        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span>
    <span class="p">)</span>

    <span class="n">criteria</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;criteria&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Select mode&quot;</span><span class="p">,</span>
                     <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setWhiteList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">whiteList</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setRegex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setFilterEntity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">filterValue</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setCriteria</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">criteria</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.chunker.ChunkFilterer&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ChunkFilterer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="MedicalNerApproach"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach">[docs]</a><span class="k">class</span> <span class="nc">MedicalNerApproach</span><span class="p">(</span><span class="n">AnnotatorApproach</span><span class="p">,</span> <span class="n">sparknlp</span><span class="o">.</span><span class="n">annotators</span><span class="o">.</span><span class="n">NerApproach</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This Named Entity recognition annotator allows to train generic NER model</span>
<span class="sd">    based on Neural Networks.</span>

<span class="sd">    The architecture of the neural network is a Char CNNs - BiLSTM - CRF that</span>
<span class="sd">    achieves state-of-the-art in most datasets.</span>

<span class="sd">    For instantiated/pretrained models, see :class:`.NerDLModel`.</span>

<span class="sd">    The training data should be a labeled Spark Dataset, in the format of</span>
<span class="sd">    :class:`.CoNLL` 2003 IOB with `Annotation` type columns. The data should</span>
<span class="sd">    have columns of type ``DOCUMENT, TOKEN, WORD_EMBEDDINGS`` and an additional</span>
<span class="sd">    label column of annotator type ``NAMED_ENTITY``.</span>

<span class="sd">    Excluding the label, this can be done with for example:</span>

<span class="sd">    - a SentenceDetector,</span>
<span class="sd">    - a Tokenizer and</span>
<span class="sd">    - a WordEmbeddingsModel (any embeddings can be chosen, e.g. BertEmbeddings</span>
<span class="sd">      for BERT based embeddings).</span>

<span class="sd">    For extended examples of usage, see the `Spark NLP Workshop &lt;https://github.com/JohnSnowLabs/spark-nlp-workshop/tree/master/jupyter/training/english/dl-ner&gt;`__.</span>

<span class="sd">    ==================================== ======================</span>
<span class="sd">    Input Annotation types               Output Annotation type</span>
<span class="sd">    ==================================== ======================</span>
<span class="sd">    ``DOCUMENT, TOKEN, WORD_EMBEDDINGS`` ``NAMED_ENTITY``</span>
<span class="sd">    ==================================== ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    labelColumn</span>
<span class="sd">        Column with label per each token</span>
<span class="sd">    entities</span>
<span class="sd">        Entities to recognize</span>
<span class="sd">    minEpochs</span>
<span class="sd">        Minimum number of epochs to train, by default 0</span>
<span class="sd">    maxEpochs</span>
<span class="sd">        Maximum number of epochs to train, by default 50</span>
<span class="sd">    verbose</span>
<span class="sd">        Level of verbosity during training, by default 2</span>
<span class="sd">    randomSeed</span>
<span class="sd">        Random seed</span>
<span class="sd">    lr</span>
<span class="sd">        Learning Rate, by default 0.001</span>
<span class="sd">    po</span>
<span class="sd">        Learning rate decay coefficient. Real Learning Rage = lr / (1 + po *</span>
<span class="sd">        epoch), by default 0.005</span>
<span class="sd">    batchSize</span>
<span class="sd">        Batch size, by default 8</span>
<span class="sd">    dropout</span>
<span class="sd">        Dropout coefficient, by default 0.5</span>
<span class="sd">    graphFolder</span>
<span class="sd">        Folder path that contain external graph files</span>
<span class="sd">    configProtoBytes</span>
<span class="sd">        ConfigProto from tensorflow, serialized into byte array.</span>
<span class="sd">    useContrib</span>
<span class="sd">        whether to use contrib LSTM Cells. Not compatible with Windows. Might</span>
<span class="sd">        slightly improve accuracy</span>
<span class="sd">    validationSplit</span>
<span class="sd">        Choose the proportion of training dataset to be validated against the</span>
<span class="sd">        model on each Epoch. The value should be between 0.0 and 1.0 and by</span>
<span class="sd">        default it is 0.0 and off, by default 0.0</span>
<span class="sd">    evaluationLogExtended</span>
<span class="sd">        Whether logs for validation to be extended, by default False.</span>
<span class="sd">    testDataset</span>
<span class="sd">        Path to test dataset. If set used to calculate statistic on it during</span>
<span class="sd">        training.</span>
<span class="sd">    includeConfidence</span>
<span class="sd">        whether to include confidence scores in annotation metadata, by default</span>
<span class="sd">        False</span>
<span class="sd">    includeAllConfidenceScores</span>
<span class="sd">        whether to include all confidence scores in annotation metadata or just</span>
<span class="sd">        the score of the predicted tag, by default False</span>
<span class="sd">    enableOutputLogs</span>
<span class="sd">        Whether to use stdout in addition to Spark logs, by default False</span>
<span class="sd">    outputLogsPath</span>
<span class="sd">        Folder path to save training logs</span>
<span class="sd">    enableMemoryOptimizer</span>
<span class="sd">        Whether to optimize for large datasets or not. Enabling this option can</span>
<span class="sd">        slow down training, by default False</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>

<span class="sd">    First extract the prerequisites for the NerDLApproach</span>

<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \\</span>
<span class="sd">    ...     .setInputCol(&quot;text&quot;) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentence = SentenceDetector() \\</span>
<span class="sd">    ...     .setInputCols([&quot;document&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;token&quot;)</span>
<span class="sd">    &gt;&gt;&gt; embeddings = BertEmbeddings.pretrained() \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;token&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;embeddings&quot;)</span>

<span class="sd">    Then the training can start</span>

<span class="sd">    &gt;&gt;&gt; nerTagger = MedicalNerApproach() \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;]) \\</span>
<span class="sd">    ...     .setLabelColumn(&quot;label&quot;) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;ner&quot;) \\</span>
<span class="sd">    ...     .setMaxEpochs(1) \\</span>
<span class="sd">    ...     .setRandomSeed(0) \\</span>
<span class="sd">    ...     .setVerbose(0)</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline().setStages([</span>
<span class="sd">    ...     documentAssembler,</span>
<span class="sd">    ...     sentence,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     embeddings,</span>
<span class="sd">    ...     nerTagger</span>
<span class="sd">    ... ])</span>
<span class="sd">    &gt;&gt;&gt; conll = CoNLL()</span>
<span class="sd">    &gt;&gt;&gt; trainingData = conll.readDataset(spark, &quot;src/test/resources/conll2003/eng.train&quot;)</span>
<span class="sd">    &gt;&gt;&gt; pipelineModel = pipeline.fit(trainingData)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lr</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;lr&quot;</span><span class="p">,</span> <span class="s2">&quot;Learning Rate&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>

    <span class="n">po</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;po&quot;</span><span class="p">,</span> <span class="s2">&quot;Learning rate decay coefficient. Real Learning Rage = lr / (1 + po * epoch)&quot;</span><span class="p">,</span>
               <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>

    <span class="n">batchSize</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;batchSize&quot;</span><span class="p">,</span> <span class="s2">&quot;Batch size&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">dropout</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;dropout&quot;</span><span class="p">,</span> <span class="s2">&quot;Dropout coefficient&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>

    <span class="n">graphFolder</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;graphFolder&quot;</span><span class="p">,</span> <span class="s2">&quot;Folder path that contains external graph files&quot;</span><span class="p">,</span>
                        <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">graphFile</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;graphFile&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Path that contains the external graph file. When specified, the provided file will be used, and no graph search will happen.&quot;</span><span class="p">,</span>
                      <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">configProtoBytes</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;configProtoBytes&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;ConfigProto from tensorflow, serialized into byte array. Get with config_proto.SerializeToString()&quot;</span><span class="p">,</span>
                             <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

    <span class="n">useContrib</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;useContrib&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;whether to use contrib LSTM Cells. Not compatible with Windows. Might slightly improve accuracy.&quot;</span><span class="p">,</span>
                       <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">validationSplit</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;validationSplit&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;Choose the proportion of training dataset to be validated against the model on each Epoch. The value should be between 0.0 and 1.0 and by default it is 0.0 and off.&quot;</span><span class="p">,</span>
                            <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>

    <span class="n">evaluationLogExtended</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;evaluationLogExtended&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;Choose the proportion of training dataset to be validated against the model on each Epoch. The value should be between 0.0 and 1.0 and by default it is 0.0 and off.&quot;</span><span class="p">,</span>
                                  <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">testDataset</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;testDataset&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Path to test dataset. If set used to calculate statistic on it during training.&quot;</span><span class="p">,</span>
                        <span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

    <span class="n">includeConfidence</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;includeConfidence&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;whether to include confidence scores in annotation metadata&quot;</span><span class="p">,</span>
                              <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">includeAllConfidenceScores</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;includeAllConfidenceScores&quot;</span><span class="p">,</span>
                                       <span class="s2">&quot;whether to include all confidence scores in annotation metadata or just the score of the predicted tag&quot;</span><span class="p">,</span>
                                       <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">enableOutputLogs</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;enableOutputLogs&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;Whether to use stdout in addition to Spark logs.&quot;</span><span class="p">,</span>
                             <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">outputLogsPath</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;outputLogsPath&quot;</span><span class="p">,</span> <span class="s2">&quot;Folder path to save training logs&quot;</span><span class="p">,</span>
                           <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">logPrefix</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;logPrefix&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;A prefix that will be appended to every log, default value is empty.&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">enableMemoryOptimizer</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;enableMemoryOptimizer&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;Whether to optimize for large datasets or not. Enabling this option can slow down training.&quot;</span><span class="p">,</span>
                                  <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">useBestModel</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;useBestModel&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;Whether to restore and use the model from the epoch that has achieved the best performance at the end of the training.&quot;</span><span class="p">,</span>
                         <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">pretrainedModelPath</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;pretrainedModelPath&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;Path to an already trained MedicalNerModel, which is used as a starting point for training the new model.&quot;</span><span class="p">,</span>
                                <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">overrideExistingTags</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;overrideExistingTags&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;Whether to override already learned tags when using a pretrained model to initialize the new model. Default is &#39;true&#39;.&quot;</span><span class="p">,</span>
                                 <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">tagsMapping</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;tagsMapping&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;A map specifying how old tags are mapped to new ones. It only works if setOverrideExistingTags &quot;</span>
                        <span class="o">+</span> <span class="s2">&quot;is false. The mapping is specified as a list of comma separared strings, &quot;</span>
                          <span class="s2">&quot;e.g. [</span><span class="se">\&quot;</span><span class="s2">B-PER, B-VIP</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">I-PER, I-VIP</span><span class="se">\&quot;</span><span class="s2">,...]&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

    <span class="n">earlyStoppingCriterion</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;earlyStoppingCriterion&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;If set, this param specifies the criterion to stop training if performance is not improving. &quot;</span>
                                   <span class="s2">&quot;Default value is 0 which is means that early stopping is not used.&quot;</span><span class="p">,</span>
                                   <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>

    <span class="n">earlyStoppingPatience</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;earlyStoppingPatience&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;Number of epochs with no performance improvement before training is terminated. &quot;</span>
                                  <span class="s2">&quot;Default value is 0.&quot;</span><span class="p">,</span> <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

<div class="viewcode-block" id="MedicalNerApproach.setConfigProtoBytes"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setConfigProtoBytes">[docs]</a>    <span class="k">def</span> <span class="nf">setConfigProtoBytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets configProto from tensorflow, serialized into byte array.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : List[str]</span>
<span class="sd">            ConfigProto from tensorflow, serialized into byte array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">configProtoBytes</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setGraphFolder"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setGraphFolder">[docs]</a>    <span class="k">def</span> <span class="nf">setGraphFolder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets folder path that contain external graph files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p : str</span>
<span class="sd">            Folder path that contain external graph files</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">graphFolder</span><span class="o">=</span><span class="n">p</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setGraphFile"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setGraphFile">[docs]</a>    <span class="k">def</span> <span class="nf">setGraphFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ff</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets path that contains the external graph file. When specified, the provided file will be used, and no graph search will happen.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p : str</span>
<span class="sd">            Path that contains the external graph file. When specified, the provided file will be used, and no graph search will happen.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">graphFile</span><span class="o">=</span><span class="n">ff</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setUseContrib"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setUseContrib">[docs]</a>    <span class="k">def</span> <span class="nf">setUseContrib</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to use contrib LSTM Cells. Not compatible with Windows.</span>
<span class="sd">        Might slightly improve accuracy.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v : bool</span>
<span class="sd">            Whether to use contrib LSTM Cells</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Exception</span>
<span class="sd">            Windows not supported to use contrib</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Windows not supported to use contrib&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">useContrib</span><span class="o">=</span><span class="n">v</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setLr"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setLr">[docs]</a>    <span class="k">def</span> <span class="nf">setLr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets Learning Rate, by default 0.001.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v : float</span>
<span class="sd">            Learning Rate</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setPo"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setPo">[docs]</a>    <span class="k">def</span> <span class="nf">setPo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets Learning rate decay coefficient, by default 0.005.</span>

<span class="sd">        Real Learning Rage is lr / (1 + po * epoch).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v : float</span>
<span class="sd">            Learning rate decay coefficient</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">po</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setBatchSize"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setBatchSize">[docs]</a>    <span class="k">def</span> <span class="nf">setBatchSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets batch size, by default 64.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v : int</span>
<span class="sd">            Batch size</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">batchSize</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setDropout"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setDropout">[docs]</a>    <span class="k">def</span> <span class="nf">setDropout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets dropout coefficient, by default 0.5.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v : float</span>
<span class="sd">            Dropout coefficient</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">dropout</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MedicalNerModel</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span><span class="p">)</span>

<div class="viewcode-block" id="MedicalNerApproach.setValidationSplit"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setValidationSplit">[docs]</a>    <span class="k">def</span> <span class="nf">setValidationSplit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the proportion of training dataset to be validated against the</span>
<span class="sd">        model on each Epoch, by default it is 0.0 and off. The value should be</span>
<span class="sd">        between 0.0 and 1.0.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v : float</span>
<span class="sd">            Proportion of training dataset to be validated</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">validationSplit</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setEvaluationLogExtended"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setEvaluationLogExtended">[docs]</a>    <span class="k">def</span> <span class="nf">setEvaluationLogExtended</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether logs for validation to be extended, by default False.</span>
<span class="sd">        Displays time and evaluation of each label.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v : bool</span>
<span class="sd">            Whether logs for validation to be extended</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">evaluationLogExtended</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setTestDataset"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setTestDataset">[docs]</a>    <span class="k">def</span> <span class="nf">setTestDataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">read_as</span><span class="o">=</span><span class="n">ReadAs</span><span class="o">.</span><span class="n">SPARK</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets Path to test dataset. If set used to calculate statistic on it</span>
<span class="sd">        during training.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            Path to test dataset</span>
<span class="sd">        read_as : str, optional</span>
<span class="sd">            How to read the resource, by default ReadAs.SPARK</span>
<span class="sd">        options : dict, optional</span>
<span class="sd">            Options for reading the resource, by default {&quot;format&quot;: &quot;parquet&quot;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;parquet&quot;</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">testDataset</span><span class="o">=</span><span class="n">ExternalResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">read_as</span><span class="p">,</span> <span class="n">options</span><span class="p">))</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setIncludeConfidence"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setIncludeConfidence">[docs]</a>    <span class="k">def</span> <span class="nf">setIncludeConfidence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to include confidence scores in annotation metadata, by</span>
<span class="sd">        default False.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether to include the confidence value in the output.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">includeConfidence</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setIncludeAllConfidenceScores"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setIncludeAllConfidenceScores">[docs]</a>    <span class="k">def</span> <span class="nf">setIncludeAllConfidenceScores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to include all confidence scores in annotation metadata</span>
<span class="sd">        or just the score of the predicted tag, by default False.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether to include all confidence scores in annotation metadata or</span>
<span class="sd">            just the score of the predicted tag</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">includeAllConfidenceScores</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setEnableOutputLogs"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setEnableOutputLogs">[docs]</a>    <span class="k">def</span> <span class="nf">setEnableOutputLogs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to use stdout in addition to Spark logs, by default</span>
<span class="sd">        False.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether to use stdout in addition to Spark logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">enableOutputLogs</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setEnableMemoryOptimizer"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setEnableMemoryOptimizer">[docs]</a>    <span class="k">def</span> <span class="nf">setEnableMemoryOptimizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets Whether to optimize for large datasets or not, by default False.</span>
<span class="sd">        Enabling this option can slow down training.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether to optimize for large datasets</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">enableMemoryOptimizer</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setUseBestModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setUseBestModel">[docs]</a>    <span class="k">def</span> <span class="nf">setUseBestModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to restore and use the model that has achieved the best performance at the end of the training..</span>
<span class="sd">        The metric that is being monitored is macro F1 for the following cases(highest precendence first),</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether to return the model that has achieved the best metrics across epochs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">useBestModel</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setOutputLogsPath"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setOutputLogsPath">[docs]</a>    <span class="k">def</span> <span class="nf">setOutputLogsPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets folder path to save training logs.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p : str</span>
<span class="sd">            Folder path to save training logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">outputLogsPath</span><span class="o">=</span><span class="n">p</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setLogPrefix"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setLogPrefix">[docs]</a>    <span class="k">def</span> <span class="nf">setLogPrefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets folder path to save training logs.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        p : str</span>
<span class="sd">            Folder path to save training logs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">logPrefix</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setPretrainedModelPath"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setPretrainedModelPath">[docs]</a>    <span class="k">def</span> <span class="nf">setPretrainedModelPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets folder path to save training logs.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : str</span>
<span class="sd">           Path to an already trained MedicalNerModel, which is used as a starting point for training the new model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">pretrainedModelPath</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setOverrideExistingTags"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setOverrideExistingTags">[docs]</a>    <span class="k">def</span> <span class="nf">setOverrideExistingTags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to override already learned tags when using a pretrained model to initialize the new model. Default is &#39;true&#39;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether to override already learned tags when using a pretrained model to initialize the new model. Default is &#39;true&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">overrideExistingTags</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setTagsMapping"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setTagsMapping">[docs]</a>    <span class="k">def</span> <span class="nf">setTagsMapping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets a map specifying how old tags are mapped to new ones. It only works if setOverrideExistingTags</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : list</span>
<span class="sd">            A map specifying how old tags are mapped to new ones. It only works if setOverrideExistingTags</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">tagsMapping</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setEarlyStoppingCriterion"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setEarlyStoppingCriterion">[docs]</a>    <span class="k">def</span> <span class="nf">setEarlyStoppingCriterion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">criterion</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets early stopping criterion. A value 0 means no early stopping.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        criterion : float</span>
<span class="sd">            Early stopping criterion.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">earlyStoppingCriterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerApproach.setEarlyStoppingPatience"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerApproach.html#sparknlp_jsl.annotator.MedicalNerApproach.setEarlyStoppingPatience">[docs]</a>    <span class="k">def</span> <span class="nf">setEarlyStoppingPatience</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patience</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the number of epochs with no performance improvement before training is terminated.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        patience : int</span>
<span class="sd">            Early stopping patience.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">earlyStoppingPatience</span><span class="o">=</span><span class="n">patience</span><span class="p">)</span></div>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MedicalNerApproach</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.ner.MedicalNerApproach&quot;</span><span class="p">)</span>
        <span class="n">uc</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span>
            <span class="n">minEpochs</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">maxEpochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
            <span class="n">lr</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.001</span><span class="p">),</span>
            <span class="n">po</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.005</span><span class="p">),</span>
            <span class="n">batchSize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">dropout</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
            <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">useContrib</span><span class="o">=</span><span class="n">uc</span><span class="p">,</span>
            <span class="n">validationSplit</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
            <span class="n">evaluationLogExtended</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">includeConfidence</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">includeAllConfidenceScores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">enableOutputLogs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">enableMemoryOptimizer</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">pretrainedModelPath</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">overrideExistingTags</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">earlyStoppingCriterion</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">earlyStoppingPatience</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span></div>


<span class="k">class</span> <span class="nc">_MedicalNerModelLoader</span><span class="p">(</span><span class="n">ExtendedJavaWrapper</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ner_model_path</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">jspark</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_MedicalNerModelLoader</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;com.johnsnowlabs.nlp.annotators.ner.MedicalNerModel.loadSavedModel&quot;</span><span class="p">,</span> <span class="n">ner_model_path</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">jspark</span><span class="p">)</span>


<div class="viewcode-block" id="MedicalNerModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerModel.html#sparknlp_jsl.annotator.MedicalNerModel">[docs]</a><span class="k">class</span> <span class="nc">MedicalNerModel</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">,</span> <span class="n">HasStorageRef</span><span class="p">,</span> <span class="n">HasBatchedAnnotate</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This Named Entity recognition annotator is a generic NER model based on</span>
<span class="sd">    Neural Networks.</span>

<span class="sd">    Neural Network architecture is Char CNNs - BiLSTM - CRF that achieves</span>
<span class="sd">    state-of-the-art in most datasets.</span>

<span class="sd">    This is the instantiated model of the :class:`.NerDLApproach`. For training</span>
<span class="sd">    your own model, please see the documentation of that class.</span>

<span class="sd">    Pretrained models can be loaded with :meth:`.pretrained` of the companion</span>
<span class="sd">    object:</span>

<span class="sd">    &gt;&gt;&gt; nerModel = MedicalNerDLModel.pretrained() \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;ner&quot;)</span>


<span class="sd">    The default model is ``&quot;ner_dl&quot;``, if no name is provided.</span>

<span class="sd">    For available pretrained models please see the `Models Hub</span>
<span class="sd">    &lt;https://nlp.johnsnowlabs.com/models?task=Named+Entity+Recognition&gt;`__.</span>
<span class="sd">    Additionally, pretrained pipelines are available for this module, see</span>
<span class="sd">    `Pipelines &lt;https://nlp.johnsnowlabs.com/docs/en/pipelines&gt;`__.</span>

<span class="sd">    Note that some pretrained models require specific types of embeddings,</span>
<span class="sd">    depending on which they were trained on. For example, the default model</span>
<span class="sd">    ``&quot;ner_dl&quot;`` requires the WordEmbeddings ``&quot;glove_100d&quot;``.</span>

<span class="sd">    For extended examples of usage, see the `Spark NLP Workshop</span>
<span class="sd">    &lt;https://github.com/JohnSnowLabs/spark-nlp-workshop/blob/master/tutorials/Certification_Trainings/Public/3.SparkNLP_Pretrained_Models.ipynb&gt;`__.</span>

<span class="sd">    ==================================== ======================</span>
<span class="sd">    Input Annotation types               Output Annotation type</span>
<span class="sd">    ==================================== ======================</span>
<span class="sd">    ``DOCUMENT, TOKEN, WORD_EMBEDDINGS`` ``NAMED_ENTITY``</span>
<span class="sd">    ==================================== ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    batchSize</span>
<span class="sd">        Size of every batch, by default 8</span>
<span class="sd">    configProtoBytes</span>
<span class="sd">        ConfigProto from tensorflow, serialized into byte array.</span>
<span class="sd">    includeConfidence</span>
<span class="sd">        Whether to include confidence scores in annotation metadata, by default</span>
<span class="sd">        False</span>
<span class="sd">    includeAllConfidenceScores</span>
<span class="sd">        Whether to include all confidence scores in annotation metadata or just</span>
<span class="sd">        the score of the predicted tag, by default False</span>
<span class="sd">    inferenceBatchSize</span>
<span class="sd">        Number of sentences to process in a single batch during inference</span>
<span class="sd">    classes</span>
<span class="sd">        Tags used to trained this NerDLModel</span>
<span class="sd">    labelCasing:</span>
<span class="sd">        Setting all labels of the NER models upper/lower case. values upper|lower</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \\</span>
<span class="sd">    ...     .setInputCol(&quot;text&quot;) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentence = SentenceDetector() \\</span>
<span class="sd">    ...     .setInputCols([&quot;document&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;token&quot;)</span>
<span class="sd">    &gt;&gt;&gt; embeddings = WordEmbeddingsModel.pretrained() \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;token&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;bert&quot;)</span>
<span class="sd">    &gt;&gt;&gt; nerTagger = MedicalNerDLModel.pretrained() \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;bert&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;ner&quot;)</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline().setStages([</span>
<span class="sd">    ...     documentAssembler,</span>
<span class="sd">    ...     sentence,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     embeddings,</span>
<span class="sd">    ...     nerTagger</span>
<span class="sd">    ... ])</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;U.N. official Ekeus heads for Baghdad.&quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; result = pipeline.fit(data).transform(data)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;MedicalNerModel&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.ner.MedicalNerModel&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MedicalNerModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span>
            <span class="n">includeConfidence</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">includeAllConfidenceScores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">batchSize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">inferenceBatchSize</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>

    <span class="n">configProtoBytes</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;configProtoBytes&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;ConfigProto from tensorflow, serialized into byte array. Get with config_proto.SerializeToString()&quot;</span><span class="p">,</span>
                             <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>
    <span class="n">includeConfidence</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;includeConfidence&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;whether to include confidence scores in annotation metadata&quot;</span><span class="p">,</span>
                              <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">includeAllConfidenceScores</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;includeAllConfidenceScores&quot;</span><span class="p">,</span>
                                       <span class="s2">&quot;whether to include all confidence scores in annotation metadata or just the score of the predicted tag&quot;</span><span class="p">,</span>
                                       <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
    <span class="n">inferenceBatchSize</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;inferenceBatchSize&quot;</span><span class="p">,</span>
                               <span class="s2">&quot;number of sentences to process in a single batch during inference&quot;</span><span class="p">,</span>
                               <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;classes&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;get the tags used to trained this MedicalNerModel&quot;</span><span class="p">,</span>
                    <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

    <span class="n">trainingClassDistribution</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                      <span class="s2">&quot;trainingClassDistribution&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;class counts for each of the classes during training&quot;</span><span class="p">,</span>
                                      <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

    <span class="n">labelCasing</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;labelCasing&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Setting all labels of the NER models upper/lower case. values upper|lower&quot;</span><span class="p">,</span>
                        <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

<div class="viewcode-block" id="MedicalNerModel.setConfigProtoBytes"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerModel.html#sparknlp_jsl.annotator.MedicalNerModel.setConfigProtoBytes">[docs]</a>    <span class="k">def</span> <span class="nf">setConfigProtoBytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets configProto from tensorflow, serialized into byte array.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : List[str]</span>
<span class="sd">            ConfigProto from tensorflow, serialized into byte array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">configProtoBytes</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">setIncludeConfidence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to include confidence scores in annotation metadata, by</span>
<span class="sd">        default False.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether to include the confidence value in the output.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">includeConfidence</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="MedicalNerModel.setIncludeConfidence"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerModel.html#sparknlp_jsl.annotator.MedicalNerModel.setIncludeConfidence">[docs]</a>    <span class="k">def</span> <span class="nf">setIncludeConfidence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets whether to include confidence scores in annotation metadata, by</span>
<span class="sd">        default False.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether to include the confidence value in the output.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">includeConfidence</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerModel.setInferenceBatchSize"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerModel.html#sparknlp_jsl.annotator.MedicalNerModel.setInferenceBatchSize">[docs]</a>    <span class="k">def</span> <span class="nf">setInferenceBatchSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets number of sentences to process in a single batch during inference</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">           number of sentences to process in a single batch during inference</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">inferenceBatchSize</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalNerModel.setLabelCasing"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalNerModel.html#sparknlp_jsl.annotator.MedicalNerModel.setLabelCasing">[docs]</a>    <span class="k">def</span> <span class="nf">setLabelCasing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Setting all labels of the NER models upper/lower case. values upper|lower</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : str</span>
<span class="sd">           Setting all labels of the NER models upper/lower case. values upper|lower</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">labelCasing</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">getTrainingClassDistribution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s1">&#39;getTrainingClassDistributionJava&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;ner_dl&quot;</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp.pretrained</span> <span class="kn">import</span> <span class="n">ResourceDownloader</span>
        <span class="k">return</span> <span class="n">ResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">MedicalNerModel</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">loadSavedModel</span><span class="p">(</span><span class="n">ner_model_path</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">spark_session</span><span class="p">):</span>
        <span class="n">jModel</span> <span class="o">=</span> <span class="n">_MedicalNerModelLoader</span><span class="p">(</span><span class="n">ner_model_path</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">spark_session</span><span class="o">.</span><span class="n">_jsparkSession</span><span class="p">)</span><span class="o">.</span><span class="n">_java_obj</span>
        <span class="k">return</span> <span class="n">MedicalNerModel</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">jModel</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;ner_clinical&quot;</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="s2">&quot;clinical/models&quot;</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.pretrained</span> <span class="kn">import</span> <span class="n">InternalResourceDownloader</span>
        <span class="k">return</span> <span class="n">InternalResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">MedicalNerModel</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                        <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DateNormalizer"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DateNormalizer.html#sparknlp_jsl.annotator.DateNormalizer">[docs]</a><span class="k">class</span> <span class="nc">DateNormalizer</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Try to normalize dates in chunks annotations.</span>
<span class="sd">    The expected format for the date will be YYYY/MM/DD.</span>
<span class="sd">    If the date is normalized then field normalized in metadata will be true else will be false.</span>


<span class="sd">    ====================== ======================</span>
<span class="sd">    Input Annotation types Output Annotation type</span>
<span class="sd">    ====================== ======================</span>
<span class="sd">    ``CHUNK``              ``CHUNK``</span>
<span class="sd">    ====================== ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    anchorDateYear</span>
<span class="sd">        Add an anchor year for the relative dates such as a day after tomorrow.</span>
<span class="sd">        If not set it will use the current year. Example: 2021</span>
<span class="sd">    anchorDateMonth</span>
<span class="sd">        Add an anchor month for the relative dates such as a day after tomorrow.</span>
<span class="sd">        If not set it will use the current month. Example: 1 which means January</span>
<span class="sd">    anchorDateDay</span>
<span class="sd">        Add an anchor day of the day for the relative dates such as a day after</span>
<span class="sd">        tomorrow. If not set it will use the current day. Example: 11</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt;document_assembler = DocumentAssembler().setInputCol(&#39;ner_chunk&#39;).setOutputCol(&#39;document&#39;)</span>
<span class="sd">    &gt;&gt;&gt;chunksDF = document_assembler.transform(df)</span>
<span class="sd">    &gt;&gt;&gt;aa = map_annotations_col(chunksDF.select(&quot;document&quot;),</span>
<span class="sd">    ...                    lambda x: [Annotation(&#39;chunk&#39;, a.begin, a.end, a.result, a.metadata, a.embeddings) for a in x], &quot;document&quot;,</span>
<span class="sd">    ...                    &quot;chunk_date&quot;, &quot;chunk&quot;)</span>
<span class="sd">    &gt;&gt;&gt;dateNormalizer = DateNormalizer().setInputCols(&#39;chunk_date&#39;).setOutputCol(&#39;date&#39;).setAnchorDateYear(2000).setAnchorDateMonth(3).setAnchorDateDay(15)</span>
<span class="sd">    &gt;&gt;&gt; result = dateNormalizer.transform(aa)</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;Fri, 21 Nov 1997&quot;], [&quot;next week at 7.30&quot;], [&quot;see you a day after&quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; result = pipeline.fit(data).transform(data)</span>
<span class="sd">    &gt;&gt;&gt; result.selectExpr(&quot;date.result&quot;,&quot;text&quot;)</span>
<span class="sd">    +-------------+-----------+</span>
<span class="sd">    |       result|       text|</span>
<span class="sd">    +-------------+-----------+</span>
<span class="sd">    | [08/02/2018]| 08/02/2018|</span>
<span class="sd">    |    [11/2018]|    11/2018|</span>
<span class="sd">    | [11/01/2018]| 11/01/2018|</span>
<span class="sd">    |[next monday]|next monday|</span>
<span class="sd">    |      [today]|      today|</span>
<span class="sd">    |  [next week]|  next week|</span>
<span class="sd">    +-------------+-----------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;DateNormalizer&quot;</span>

    <span class="n">anchorDateYear</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                           <span class="s2">&quot;anchorDateYear&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;Add an anchor year for the relative dates such as a day after tomorrow. If not set it &quot;</span>
                           <span class="s2">&quot;will use the current year. Example: 2021&quot;</span><span class="p">,</span>
                           <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span>
                           <span class="p">)</span>

    <span class="n">anchorDateMonth</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                            <span class="s2">&quot;anchorDateMonth&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;Add an anchor month for the relative dates such as a day after tomorrow. If not set it &quot;</span>
                            <span class="s2">&quot;will use the current month. Example: 1 which means January&quot;</span><span class="p">,</span>
                            <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span>
                            <span class="p">)</span>

    <span class="n">anchorDateDay</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                          <span class="s2">&quot;anchorDateDay&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Add an anchor day of the day for the relative dates such as a day after tomorrow. If not &quot;</span>
                          <span class="s2">&quot;set it will use the current day. Example: 11&quot;</span><span class="p">,</span>
                          <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span>
                          <span class="p">)</span>

<div class="viewcode-block" id="DateNormalizer.setAnchorDateYear"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DateNormalizer.html#sparknlp_jsl.annotator.DateNormalizer.setAnchorDateYear">[docs]</a>    <span class="k">def</span> <span class="nf">setAnchorDateYear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets an anchor year for the relative dates such as a day after</span>
<span class="sd">        tomorrow. If not set it will use the current year.</span>

<span class="sd">        Example: 2021</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">            The anchor year for relative dates</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">anchorDateYear</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="DateNormalizer.setAnchorDateMonth"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DateNormalizer.html#sparknlp_jsl.annotator.DateNormalizer.setAnchorDateMonth">[docs]</a>    <span class="k">def</span> <span class="nf">setAnchorDateMonth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets an anchor month for the relative dates such as a day after</span>
<span class="sd">        tomorrow. If not set it will use the current month.</span>

<span class="sd">        Example: 1 which means January</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">            The anchor month for relative dates</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">normalized_value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">anchorDateMonth</span><span class="o">=</span><span class="n">normalized_value</span><span class="p">)</span></div>

<div class="viewcode-block" id="DateNormalizer.setAnchorDateDay"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.DateNormalizer.html#sparknlp_jsl.annotator.DateNormalizer.setAnchorDateDay">[docs]</a>    <span class="k">def</span> <span class="nf">setAnchorDateDay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets an anchor day of the day for the relative dates such as a day</span>
<span class="sd">        after tomorrow. If not set it will use the current day.</span>

<span class="sd">        Example: 11</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">            The anchor day for relative dates</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">anchorDateDay</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.normalizer.DateNormalizer&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DateNormalizer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="AverageEmbeddings"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AverageEmbeddings.html#sparknlp_jsl.annotator.AverageEmbeddings">[docs]</a><span class="k">class</span> <span class="nc">AverageEmbeddings</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;AverageEmbeddings&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.embeddings.AverageEmbeddings&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AverageEmbeddings</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="ChunkConverter"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkConverter.html#sparknlp_jsl.annotator.ChunkConverter">[docs]</a><span class="k">class</span> <span class="nc">ChunkConverter</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert chunks from regexMatcher to chunks with a entity in the metadata.</span>
<span class="sd">    Use the identifier or field as a entity.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    ====================== ======================</span>
<span class="sd">    Input Annotation types Output Annotation type</span>
<span class="sd">    ====================== ======================</span>
<span class="sd">    ``CHUNK``               ``CHUNK``</span>
<span class="sd">    ====================== ======================</span>

<span class="sd">    &gt;&gt;&gt; test_data = spark.createDataFrame([</span>
<span class="sd">    ...    (1,&quot;My first sentence with the first rule. This is my second sentence with ceremonies rule.&quot;),</span>
<span class="sd">    ...    ]).toDF(&quot;id&quot;, &quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; document_assembler = DocumentAssembler().setInputCol(&#39;text&#39;).setOutputCol(&#39;document&#39;)</span>
<span class="sd">    &gt;&gt;&gt; sentence_detector = SentenceDetector().setInputCols([&quot;document&quot;]).setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    &gt;&gt;&gt; regex_matcher = RegexMatcher()\</span>
<span class="sd">    ...    .setInputCols(&quot;sentence&quot;)\</span>
<span class="sd">    ...    .setOutputCol(&quot;regex&quot;)\</span>
<span class="sd">    ...    .setExternalRules(path=&quot;../src/test/resources/regex-matcher/rules.txt&quot;,delimiter=&quot;,&quot;)</span>
<span class="sd">    &gt;&gt;&gt; chunkConverter = ChunkConverter().setInputCols(&quot;regex&quot;).setOutputCol(&quot;chunk&quot;)</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline(stages=[document_assembler, sentence_detector, regex_matcher, regex_matcher,chunkConverter])</span>
<span class="sd">    &gt;&gt;&gt; model = pipeline.fit(test_data)</span>
<span class="sd">    &gt;&gt;&gt; outdf = model.transform(test_data)</span>
<span class="sd">    +------------------------------------------------------------------------------------------------+</span>
<span class="sd">    |col                                                                                             |</span>
<span class="sd">    +------------------------------------------------------------------------------------------------+</span>
<span class="sd">    |[chunk, 23, 31, the first, [identifier -&gt; NAME, sentence -&gt; 0, chunk -&gt; 0, entity -&gt; NAME], []] |</span>
<span class="sd">    |[chunk, 71, 80, ceremonies, [identifier -&gt; NAME, sentence -&gt; 1, chunk -&gt; 0, entity -&gt; NAME], []]|</span>
<span class="sd">    +------------------------------------------------------------------------------------------------+</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ChunkConverter&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.chunker.ChunkConverter&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ChunkConverter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="BertSentenceChunkEmbeddings"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.BertSentenceChunkEmbeddings.html#sparknlp_jsl.annotator.BertSentenceChunkEmbeddings">[docs]</a><span class="k">class</span> <span class="nc">BertSentenceChunkEmbeddings</span><span class="p">(</span><span class="n">BertSentenceEmbeddings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    BERT Sentence embeddings for chunk annotations which take into account the context of the sentence the chunk appeared in.</span>
<span class="sd">    This is an extension of BertSentenceEmbeddings which combines the embedding of a chunk with the embedding of the</span>
<span class="sd">    surrounding sentence. For each input chunk annotation, it finds the corresponding sentence, computes</span>
<span class="sd">    the BERT sentence embedding of both the chunk and the sentence and averages them. The resulting embeddings are</span>
<span class="sd">    useful in cases, in which one needs a numerical representation of a text chunk which is sensitive to</span>
<span class="sd">    the context it appears in.</span>

<span class="sd">    ====================== ======================</span>
<span class="sd">    Input Annotation types Output Annotation type</span>
<span class="sd">    ====================== ======================</span>
<span class="sd">    ``DOCUMENT, CHUNK``    ``SENTENCE_EMBEDDINGS``</span>
<span class="sd">    ====================== ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    chunkWeight</span>
<span class="sd">        Relative weight of chunk embeddings in comparison to sentence embeddings. The value should between 0 and 1.</span>
<span class="sd">        The default is 0.5, which means the chunk and sentence embeddings are given equal weight.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>

<span class="sd">    First extract the prerequisites for the NerDLModel</span>

<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \\</span>
<span class="sd">    ...     .setInputCol(&quot;text&quot;) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentence = SentenceDetector() \\</span>
<span class="sd">    ...     .setInputCols([&quot;document&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;token&quot;)</span>
<span class="sd">    &gt;&gt;&gt; embeddings = WordEmbeddingsModel.pretrained() \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;token&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;bert&quot;)</span>
<span class="sd">    &gt;&gt;&gt; nerTagger = MedicalNerDLModel.pretrained() \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;bert&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;ner&quot;)</span>
<span class="sd">    &gt;&gt;&gt; nerConverter = NerConverter() \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;token&quot;,&quot;ner&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;ner_chunk&quot;)</span>
<span class="sd">    &gt;&gt;&gt; embeddings = BertSentenceChunkEmbeddings.pretrained(&quot;sbluebert_base_uncased_mli&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \\</span>
<span class="sd">    ...     .setInputCols([&quot;sentence&quot;, &quot;ner_chunk&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;sentence_chunk_embeddings&quot;)</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline().setStages([</span>
<span class="sd">    ...     documentAssembler,</span>
<span class="sd">    ...     sentence,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     embeddings,</span>
<span class="sd">    ...     nerTagger,</span>
<span class="sd">    ...     nerConverter</span>
<span class="sd">    ...     embeddings</span>
<span class="sd">    ... ])</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;Her Diabetes has become type 2 in the last year with her Diabetes.He complains of swelling in his right forearm.&quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; result = pipeline.fit(data).transform(data)</span>
<span class="sd">    &gt;&gt;&gt; result</span>
<span class="sd">    ...   .selectExpr(&quot;explode(sentence_chunk_embeddings) AS s&quot;)</span>
<span class="sd">    ...   .selectExpr(&quot;s.result&quot;, &quot;slice(s.embeddings, 1, 5) AS averageEmbedding&quot;)</span>
<span class="sd">    ...   .show(truncate=false)</span>
<span class="sd">    +-----------------------------+-----------------------------------------------------------------+</span>
<span class="sd">    |                       result|                                                 averageEmbedding|</span>
<span class="sd">    +-----------------------------+-----------------------------------------------------------------+</span>
<span class="sd">    |Her Diabetes                 |[-0.31995273, -0.04710883, -0.28973156, -0.1294758, 0.12481072]  |</span>
<span class="sd">    |type 2                       |[-0.027161136, -0.24613449, -0.0949309, 0.1825444, -0.2252143]   |</span>
<span class="sd">    |her Diabetes                 |[-0.31995273, -0.04710883, -0.28973156, -0.1294758, 0.12481072]  |</span>
<span class="sd">    |swelling in his right forearm|[-0.45139068, 0.12400375, -0.0075617577, -0.90806055, 0.12871636]|</span>
<span class="sd">    +-----------------------------+-----------------------------------------------------------------+</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;BertSentenceChunkEmbeddings&quot;</span>

    <span class="n">chunkWeight</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                        <span class="s2">&quot;chunkWeight&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Relative weight of chunk embeddings in comparison to sentence embeddings. The value should between 0 and 1.&quot;</span>
                        <span class="s2">&quot;The default is 0.5, which means the chunk and sentence embeddings are given equal weight.&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span>
                        <span class="p">)</span>

<div class="viewcode-block" id="BertSentenceChunkEmbeddings.setChunkWeight"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.BertSentenceChunkEmbeddings.html#sparknlp_jsl.annotator.BertSentenceChunkEmbeddings.setChunkWeight">[docs]</a>    <span class="k">def</span> <span class="nf">setChunkWeight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets  the relative weight of chunk embeddings in comparison to sentence embeddings. The value should between 0 and 1.</span>
<span class="sd">           The default is 0.5, which means the chunk and sentence embeddings are given equal weight.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">           Relative weight of chunk embeddings in comparison to sentence embeddings. The value should between 0 and 1.</span>
<span class="sd">           The default is 0.5, which means the chunk and sentence embeddings are given equal weight.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">chunkWeight</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.embeddings.BertSentenceChunkEmbeddings&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BertSentenceChunkEmbeddings</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span>
            <span class="n">dimension</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span>
            <span class="n">batchSize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">maxSentenceLength</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
            <span class="n">caseSensitive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">chunkWeight</span><span class="o">=</span><span class="mf">0.5</span>
        <span class="p">)</span>

<div class="viewcode-block" id="BertSentenceChunkEmbeddings.pretrained"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.BertSentenceChunkEmbeddings.html#sparknlp_jsl.annotator.BertSentenceChunkEmbeddings.pretrained">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;sent_small_bert_L2_768&quot;</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.pretrained</span> <span class="kn">import</span> <span class="n">InternalResourceDownloader</span>
        <span class="k">return</span> <span class="n">InternalResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">BertSentenceChunkEmbeddings</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                        <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="BertSentenceChunkEmbeddings.load"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.BertSentenceChunkEmbeddings.html#sparknlp_jsl.annotator.BertSentenceChunkEmbeddings.load">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">_BertSentenceEmbeddingsToBertSentenceChunkEmbeddingsLoader</span>
        <span class="n">jModel</span> <span class="o">=</span> <span class="n">_BertSentenceEmbeddingsToBertSentenceChunkEmbeddingsLoader</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">_java_obj</span>
        <span class="k">return</span> <span class="n">BertSentenceChunkEmbeddings</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">jModel</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="Router"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.Router.html#sparknlp_jsl.annotator.Router">[docs]</a><span class="k">class</span> <span class="nc">Router</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert chunks from regexMatcher to chunks with a entity in the metadata.</span>
<span class="sd">    Use the identifier or field as a entity.</span>

<span class="sd">    ====================== ======================</span>
<span class="sd">    Input Annotation types Output Annotation type</span>
<span class="sd">    ====================== ======================</span>
<span class="sd">    ``ANY``                ``ANY``</span>
<span class="sd">    ====================== ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    inputType</span>
<span class="sd">        The type of the entity that you want to filter by default sentence_embeddings.Possible values</span>
<span class="sd">        ``document|token|wordpiece|word_embeddings|sentence_embeddings|category|date|sentiment|pos|chunk|named_entity|regex|dependency|labeled_dependency|language|keyword``</span>
<span class="sd">    filterFieldsElements</span>
<span class="sd">        The filterfieldsElements are the allowed values for the metadata field that is being used</span>
<span class="sd">    metadataField</span>
<span class="sd">        The key in the metadata dictionary that you want to filter (by default ``entity``)</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; test_data = spark.createDataFrame(sentences).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; document = DocumentAssembler().setInputCol(&quot;text&quot;).setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentence = SentenceDetector().setInputCols(&quot;document&quot;).setOutputCol(&quot;sentence&quot;)</span>
<span class="sd">    &gt;&gt;&gt; regexMatcher = RegexMatcher().setExternalRules(&quot;../src/test/resources/regex-matcher/rules2.txt&quot;, &quot;,&quot;) \\</span>
<span class="sd">    ...     .setInputCols(&quot;sentence&quot;) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;regex&quot;) \\</span>
<span class="sd">    ...     .setStrategy(&quot;MATCH_ALL&quot;)</span>
<span class="sd">    &gt;&gt;&gt; chunk2Doc = Chunk2Doc().setInputCols(&quot;regex&quot;).setOutputCol(&quot;doc_chunk&quot;)</span>
<span class="sd">    &gt;&gt;&gt; embeddings = BertSentenceEmbeddings.pretrained(&quot;sent_small_bert_L2_128&quot;) \\</span>
<span class="sd">    ...     .setInputCols(&quot;doc_chunk&quot;) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;bert&quot;) \\</span>
<span class="sd">    ...     .setCaseSensitive(False) \\</span>
<span class="sd">    ...     .setMaxSentenceLength(32)</span>
<span class="sd">    &gt;&gt;&gt; router_name_embeddings = Router() \\</span>
<span class="sd">    ...     .setInputType(&quot;sentence_embeddings&quot;) \\</span>
<span class="sd">    ...     .setInputCols(&quot;bert&quot;) \\</span>
<span class="sd">    ...     .setMetadataField(&quot;identifier&quot;) \\</span>
<span class="sd">    ...     .setFilterFieldsElements([&quot;name&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;names_embeddings&quot;)\</span>
<span class="sd">    &gt;&gt;&gt; router_city_embeddings = Router() \\</span>
<span class="sd">    ...     .setInputType(&quot;sentence_embeddings&quot;) \\</span>
<span class="sd">    ...     .setInputCols([&quot;bert&quot;]) \\</span>
<span class="sd">    ...     .setMetadataField(&quot;identifier&quot;) \\</span>
<span class="sd">    ...     .setFilterFieldsElements([&quot;city&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;cities_embeddings&quot;)</span>
<span class="sd">    &gt;&gt;&gt; router_names = Router() \\</span>
<span class="sd">    ...     .setInputType(&quot;chunk&quot;) \\</span>
<span class="sd">    ...     .setInputCols(&quot;regex&quot;) \\</span>
<span class="sd">    ...     .setMetadataField(&quot;identifier&quot;) \\</span>
<span class="sd">    ...     .setFilterFieldsElements([&quot;name&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;names_chunks&quot;)</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline().setStages(</span>
<span class="sd">    &gt;&gt;&gt;     [document, sentence, regexMatcher, chunk2Doc, router_names, embeddings, router_name_embeddings,</span>
<span class="sd">    ...      router_city_embeddings])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Router&quot;</span>

    <span class="n">inputType</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;inputType&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;The type of the entity that you want to filter by default sentence_embeddings.Possible values document|token|wordpiece|word_embeddings|&quot;</span>
                      <span class="s2">&quot;sentence_embeddings|category|date|sentiment|pos|chunk|named_entity|regex|dependency|labeled_dependency|language|keyword &quot;</span><span class="p">,</span>
                      <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">filterFieldsElements</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;filterFieldsElements&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;The filterfieldsElements are the allowed values for the metadata field that is being used&quot;</span><span class="p">,</span>
                                 <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>
    <span class="n">metadataField</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;metadataField&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;The key in the metadata dictionary that you want to filter (by default &#39;entity&#39;)&quot;</span><span class="p">,</span>
                          <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

<div class="viewcode-block" id="Router.setInputType"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.Router.html#sparknlp_jsl.annotator.Router.setInputType">[docs]</a>    <span class="k">def</span> <span class="nf">setInputType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the type of the entity that you want to filter by default sentence_embedding</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">            The type of the entity that you want to filter by default sentence_embedding</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">inputType</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Router.setFilterFieldsElements"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.Router.html#sparknlp_jsl.annotator.Router.setFilterFieldsElements">[docs]</a>    <span class="k">def</span> <span class="nf">setFilterFieldsElements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the filterfieldsElements are the allowed values for the metadata field that is being used</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : list</span>
<span class="sd">           The filterfieldsElements are the allowed values for the metadata field that is being used</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">filterFieldsElements</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Router.setMetadataField"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.Router.html#sparknlp_jsl.annotator.Router.setMetadataField">[docs]</a>    <span class="k">def</span> <span class="nf">setMetadataField</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the key in the metadata dictionary that you want to filter (by default &#39;entity&#39;)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : str</span>
<span class="sd">           The key in the metadata dictionary that you want to filter (by default &#39;entity&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">metadataField</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.Router&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Router</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="ChunkSentenceSplitter"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkSentenceSplitter.html#sparknlp_jsl.annotator.ChunkSentenceSplitter">[docs]</a><span class="k">class</span> <span class="nc">ChunkSentenceSplitter</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split the document using the chunks that you provided,and put in the metadata the chunk entity.</span>
<span class="sd">    The first piece of documento to the first chunk will have the entity as header.</span>

<span class="sd">    Use the identifier or field as a entity.</span>

<span class="sd">    ====================== ======================</span>
<span class="sd">    Input Annotation types Output Annotation type</span>
<span class="sd">    ====================== ======================</span>
<span class="sd">    ``DOCUMENT, CHUNK``    ``DOCUMENT``</span>
<span class="sd">    ====================== ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    inputType</span>
<span class="sd">        The type of the entity that you want to filter by default sentence_embeddings.Possible values</span>
<span class="sd">        ``document|token|wordpiece|word_embeddings|sentence_embeddings|category|date|sentiment|pos|chunk|named_entity|regex|dependency|labeled_dependency|language|keyword``</span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; document = DocumentAssembler().setInputCol(&quot;text&quot;).setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; regexMatcher = RegexMatcher().setExternalRules(&quot;../src/test/resources/chunker/title_regex.txt&quot;, &quot;,&quot;) \\</span>
<span class="sd">    ...     .setInputCols(&quot;document&quot;) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;chunks&quot;) \\</span>
<span class="sd">    &gt;&gt;&gt; chunkSentenceSplitter = ChunkSentenceSplitter().setInputCols(&quot;chunks&quot;,&quot;document&quot;).setOutputCol(&quot;paragraphs&quot;)</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline().setStages([documentAssembler,regexMatcher,chunkSentenceSplitter])</span>
<span class="sd">    &gt;&gt;&gt; result = pipeline.fit(data).transform(data).select(&quot;paragraphs&quot;)</span>
<span class="sd">    &gt;&gt;&gt; result.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">groupBySentences</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;groupBySentences&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;This parameter allow split the paragraphs grouping the chunks by sentences.&quot;</span> <span class="o">+</span>
                             <span class="s2">&quot;if is false we assume that we have 1 document annotations and all chunks are for this document.&quot;</span> <span class="o">+</span>
                             <span class="s2">&quot;Use false if the input column of your chunk annotator was a sentenceDetector column.&quot;</span>
                             <span class="s2">&quot;Use true when we have a sentence detector as input column or when the document have many sentences per row&quot;</span><span class="p">,</span>
                             <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">insertChunk</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;insertChunk&quot;</span><span class="p">,</span> <span class="s2">&quot;Whether to insert the chunk in the paragraph or not&quot;</span><span class="p">,</span>
                        <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">defaultEntity</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;defaultEntity&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Add the default name for the entity that is between the init of the document and the first chunk&quot;</span><span class="p">,</span>
                          <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ChunkSentenceSplitter&quot;</span>

<div class="viewcode-block" id="ChunkSentenceSplitter.setGroupBySentences"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkSentenceSplitter.html#sparknlp_jsl.annotator.ChunkSentenceSplitter.setGroupBySentences">[docs]</a>    <span class="k">def</span> <span class="nf">setGroupBySentences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the groupBySentences that allow split the paragraphs grouping the chunks by sentences.</span>
<span class="sd">            If is false we assume that we have 1 document annotations and all chunks are for this document.</span>
<span class="sd">            Use false if the input column of your chunk annotator was a sentenceDetector column.</span>
<span class="sd">            Use true when we have a sentence detector as input column or when the document have many sentences per row</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : Boolean</span>
<span class="sd">           Allow split the paragraphs grouping the chunks by sentences</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">groupBySentences</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="ChunkSentenceSplitter.setInsertChunk"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkSentenceSplitter.html#sparknlp_jsl.annotator.ChunkSentenceSplitter.setInsertChunk">[docs]</a>    <span class="k">def</span> <span class="nf">setInsertChunk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Whether to insert the chunk in the paragraph or not.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : Boolean</span>
<span class="sd">           Whether to insert the chunk in the paragraph or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">insertChunk</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="ChunkSentenceSplitter.setDefaultEntity"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkSentenceSplitter.html#sparknlp_jsl.annotator.ChunkSentenceSplitter.setDefaultEntity">[docs]</a>    <span class="k">def</span> <span class="nf">setDefaultEntity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the key in the metadata dictionary that you want to filter (by default &#39;entity&#39;)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : str</span>
<span class="sd">           The key in the metadata dictionary that you want to filter (by default &#39;entity&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">defaultEntity</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.chunker.ChunkSentenceSplitter&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ChunkSentenceSplitter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="ChunkKeyPhraseExtraction"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkKeyPhraseExtraction.html#sparknlp_jsl.annotator.ChunkKeyPhraseExtraction">[docs]</a><span class="k">class</span> <span class="nc">ChunkKeyPhraseExtraction</span><span class="p">(</span><span class="n">BertSentenceEmbeddings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Chunk KeyPhrase Extraction uses Bert Sentence Embeddings to determine the most relevant key phrases describing a</span>
<span class="sd">    text. The input to the model consists of chunk annotations and sentence or document annotation. The model compares</span>
<span class="sd">    the chunks against the corresponding sentences/documents and selects the chunks which are most representative of</span>
<span class="sd">    the broader text context (i.e. the document or the sentence they belong to). The key phrases candidates (i.e. the</span>
<span class="sd">    input chunks) can be generated in various ways, e.g. by NGramGenerator, TextMatcher or NerConverter. The model</span>
<span class="sd">    operates either at sentence (selecting the most descriptive chunks from the sentence they belong to) or at document</span>
<span class="sd">    level. In the latter case, the key phrases are selected to represent all the input document annotations.</span>

<span class="sd">    ====================== ======================</span>
<span class="sd">    Input Annotation types Output Annotation type</span>
<span class="sd">    ====================== ======================</span>
<span class="sd">    ``DOCUMENT, CHUNK``    ``CHUNK``</span>
<span class="sd">    ====================== ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    topN</span>
<span class="sd">        The number of key phrases to select.</span>
<span class="sd">    selectMostDifferent</span>
<span class="sd">        Finds the topN * 2 key phrases and then selects topN of them, such as that they are the most different from</span>
<span class="sd">        each other</span>
<span class="sd">    divergence</span>
<span class="sd">        The divergence value determines how different from each the extracted key phrases are. Uses Maximal Marginal</span>
<span class="sd">        Relevance (MMR). MMR should not be used in conjunction with selectMostDifferent as they aim to achieve the same</span>
<span class="sd">        goal, but in different ways.</span>
<span class="sd">    documentLevelProcessing</span>
<span class="sd">        Extract key phrases from the whole document  from particular sentences which the chunks refer to.</span>
<span class="sd">    concatenateSentences</span>
<span class="sd">        Concatenate the input sentence/documentation annotations before computing their embeddings.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>


<span class="sd">    &gt;&gt;&gt; documenter = sparknlp.DocumentAssembler() \</span>
<span class="sd">    ...     .setInputCol(&quot;text&quot;) \</span>
<span class="sd">    ...     .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; sentencer = sparknlp.annotators.SentenceDetector() \</span>
<span class="sd">    ...     .setInputCols([&quot;document&quot;])\</span>
<span class="sd">    ...     .setOutputCol(&quot;sentences&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = sparknlp.annotators.Tokenizer() \</span>
<span class="sd">    ...     .setInputCols([&quot;document&quot;]) \</span>
<span class="sd">    ...     .setOutputCol(&quot;tokens&quot;) \</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt;  embeddings = sparknlp.annotators.WordEmbeddingsModel() \</span>
<span class="sd">    ...     .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \</span>
<span class="sd">    ...     .setInputCols([&quot;document&quot;, &quot;tokens&quot;]) \</span>
<span class="sd">    ...     .setOutputCol(&quot;embeddings&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; ner_tagger = MedicalNerModel() \</span>
<span class="sd">    ...     .pretrained(&quot;ner_jsl_slim&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \</span>
<span class="sd">    ...     .setInputCols([&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;]) \</span>
<span class="sd">    ...     .setOutputCol(&quot;ner_tags&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; ner_converter = NerConverter()\</span>
<span class="sd">    ...     .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;ner_tags&quot;)\</span>
<span class="sd">    ...     .setOutputCol(&quot;ner_chunks&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; key_phrase_extractor = ChunkKeyPhraseExtraction\</span>
<span class="sd">    ...     .pretrained()\</span>
<span class="sd">    ...     .setTopN(1)\</span>
<span class="sd">    ...     .setDocumentLevelProcessing(False)\</span>
<span class="sd">    ...     .setDivergence(0.4)\</span>
<span class="sd">    ...     .setInputCols([&quot;sentences&quot;, &quot;ner_chunks&quot;])\</span>
<span class="sd">    ...     .setOutputCol(&quot;ner_chunk_key_phrases&quot;)</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; pipeline = sparknlp.base.Pipeline() \</span>
<span class="sd">    ...     .setStages([documenter, sentencer, tokenizer, embeddings, ner_tagger, ner_converter, key_phrase_extractor])</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;Her Diabetes has become type 2 in the last year with her Diabetes.He complains of swelling in his right forearm.&quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; results = pipeline.fit(data).transform(data)</span>
<span class="sd">    &gt;&gt;&gt; results\</span>
<span class="sd">    ...     .selectExpr(&quot;explode(ner_chunk_key_phrases) AS key_phrase&quot;)\</span>
<span class="sd">    ...     .selectExpr(</span>
<span class="sd">    ...         &quot;key_phrase.result&quot;,</span>
<span class="sd">    ...         &quot;key_phrase.metadata.entity&quot;,</span>
<span class="sd">    ...         &quot;key_phrase.metadata.DocumentSimilarity&quot;,</span>
<span class="sd">    ...         &quot;key_phrase.metadata.MMRScore&quot;)\</span>
<span class="sd">    ...     .show(truncate=False)</span>

<span class="sd">    +-----------------------------+------------------+-------------------+</span>
<span class="sd">    |result                       |DocumentSimilarity|MMRScore           |</span>
<span class="sd">    +-----------------------------+------------------+-------------------+</span>
<span class="sd">    |gestational diabetes mellitus|0.7391447825527298|0.44348688715422274|</span>
<span class="sd">    |28-year-old                  |0.4366776288430703|0.13577881610104517|</span>
<span class="sd">    |type two diabetes mellitus   |0.7323921930094919|0.085800103824974  |</span>
<span class="sd">    +-----------------------------+------------------+-------------------+</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ChunkKeyPhraseExtraction&quot;</span>

    <span class="n">topN</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                 <span class="s2">&quot;topN&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;Number of key phrases to extract, ordered by their score&quot;</span><span class="p">,</span>
                 <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span>
                 <span class="p">)</span>

<div class="viewcode-block" id="ChunkKeyPhraseExtraction.setTopN"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkKeyPhraseExtraction.html#sparknlp_jsl.annotator.ChunkKeyPhraseExtraction.setTopN">[docs]</a>    <span class="k">def</span> <span class="nf">setTopN</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the number of key phrases to extract. The default value is 3.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : integer</span>
<span class="sd">           Number of key phrases to extract.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">topN</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="n">divergence</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                       <span class="s2">&quot;divergence&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;The divergence value determines how different from each the extracted key phrases are. &quot;</span>
                       <span class="s2">&quot;The value must be in the the interval [0, 1]. The higher the value is, &quot;</span>
                       <span class="s2">&quot;the more divergence is enforced.  The default value is 0.2.&quot;</span><span class="p">,</span>
                       <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span>
                       <span class="p">)</span>

<div class="viewcode-block" id="ChunkKeyPhraseExtraction.setDivergence"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkKeyPhraseExtraction.html#sparknlp_jsl.annotator.ChunkKeyPhraseExtraction.setDivergence">[docs]</a>    <span class="k">def</span> <span class="nf">setDivergence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the level of divergence of the extracted key phrases. The value should be in the interval [0, 1].</span>
<span class="sd">            This parameter should not be used if setSelectMostDifferent is true - the two parameters aim to achieve the</span>
<span class="sd">            same goal in different ways. The default is 0, i.e. there is no constraint on the order of key phrases</span>
<span class="sd">             extracted.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">           Divergence value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">divergence</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="n">selectMostDifferent</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                <span class="s2">&quot;selectMostDifferent&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;Find the topN * 2 key phrases and then select topN of them, such as that they are the &quot;</span>
                                <span class="s2">&quot;most different from each other&quot;</span><span class="p">,</span>
                                <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span>
                                <span class="p">)</span>

<div class="viewcode-block" id="ChunkKeyPhraseExtraction.setSelectMostDifferent"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkKeyPhraseExtraction.html#sparknlp_jsl.annotator.ChunkKeyPhraseExtraction.setSelectMostDifferent">[docs]</a>    <span class="k">def</span> <span class="nf">setSelectMostDifferent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Let the model return the top N key phrases which are the most different from each other. Using this paramter</span>
<span class="sd">        only makes sense if the divergence parameter is set to 0. The default value is &#39;false&#39;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : boolean</span>
<span class="sd">           whether to select the most different key phrases or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">selectMostDifferent</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="n">documentLevelProcessing</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                    <span class="s2">&quot;documentLevelProcessing&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;Let the model extract key phrase at the document or at the sentence level&quot;</span><span class="p">,</span>
                                    <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span>
                                    <span class="p">)</span>

<div class="viewcode-block" id="ChunkKeyPhraseExtraction.setDocumentLevelProcessing"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkKeyPhraseExtraction.html#sparknlp_jsl.annotator.ChunkKeyPhraseExtraction.setDocumentLevelProcessing">[docs]</a>    <span class="k">def</span> <span class="nf">setDocumentLevelProcessing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Extract key phrases from the whole document or from particular sentences which the chunks refer to.</span>
<span class="sd">         The default value is &#39;false&#39;.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : boolean</span>
<span class="sd">           Whether to extract key phrases from the whole document(all sentences).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">documentLevelProcessing</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="n">concatenateSentences</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                 <span class="s2">&quot;concatenateSentences&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;Concatenate input sentence annotations before computing their embedding.&quot;</span><span class="p">,</span>
                                 <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span>
                                 <span class="p">)</span>

<div class="viewcode-block" id="ChunkKeyPhraseExtraction.setConcatenateSentences"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkKeyPhraseExtraction.html#sparknlp_jsl.annotator.ChunkKeyPhraseExtraction.setConcatenateSentences">[docs]</a>    <span class="k">def</span> <span class="nf">setConcatenateSentences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Concatenate the input sentence/documentation annotations before computing their embeddings. This parameter</span>
<span class="sd">        is only used if documentLevelProcessing is true. If concatenateSentences is set to true, the model will</span>
<span class="sd">        concatenate the document/sentence input annotations and compute a single embedding. If it is false, the model</span>
<span class="sd">        will compute the embedding of each sentence separately and then average the resulting embedding vectors.</span>
<span class="sd">        The default value is &#39;false&#39;.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : boolean</span>
<span class="sd">           Whether to concatenate the input sentence/document annotations in order to compute the embedding of the</span>
<span class="sd">           whole document.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">concatenateSentences</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="n">dropPunctuation</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                            <span class="s2">&quot;dropPunctuation&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;Remove punctuation marks from input chunks.&quot;</span><span class="p">,</span>
                            <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span>
                            <span class="p">)</span>

<div class="viewcode-block" id="ChunkKeyPhraseExtraction.setDropPunctuation"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkKeyPhraseExtraction.html#sparknlp_jsl.annotator.ChunkKeyPhraseExtraction.setDropPunctuation">[docs]</a>    <span class="k">def</span> <span class="nf">setDropPunctuation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This parameter determines whether to remove punctuation marks from the input chunks. Chunks coming from NER</span>
<span class="sd">        models are not affected.</span>
<span class="sd">        The default value is &#39;true&#39;.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : boolean</span>
<span class="sd">           Whether to remove punctuation marks from input chunks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">dropPunctuation</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.embeddings.ChunkKeyPhraseExtraction&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ChunkKeyPhraseExtraction</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span>
            <span class="n">dimension</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span>
            <span class="n">batchSize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">maxSentenceLength</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
            <span class="n">caseSensitive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">divergence</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">documentLevelProcessing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">topN</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">selectMostDifferent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">concatenateSentences</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">dropPunctuation</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

<div class="viewcode-block" id="ChunkKeyPhraseExtraction.pretrained"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkKeyPhraseExtraction.html#sparknlp_jsl.annotator.ChunkKeyPhraseExtraction.pretrained">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;sbert_jsl_medium_uncased&quot;</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="s2">&quot;clinical/models&quot;</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.pretrained</span> <span class="kn">import</span> <span class="n">InternalResourceDownloader</span>
        <span class="k">return</span> <span class="n">InternalResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">ChunkKeyPhraseExtraction</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="AnnotationMerger"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AnnotationMerger.html#sparknlp_jsl.annotator.AnnotationMerger">[docs]</a><span class="k">class</span> <span class="nc">AnnotationMerger</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merges Annotations from multiple columns.</span>

<span class="sd">    ====================== ======================</span>
<span class="sd">    Input Annotation types Output Annotation type</span>
<span class="sd">    ====================== ======================</span>
<span class="sd">    ``ANY``                ``ANY``</span>
<span class="sd">    ====================== ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    inputType</span>
<span class="sd">        The type of the annotations that you want to merge. Possible values</span>
<span class="sd">        ``document|token|wordpiece|word_embeddings|sentence_embeddings|category|date|sentiment|pos|chunk|named_entity|regex|dependency|labeled_dependency|language|keyword``</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">&gt;&gt;&gt; docs = [[&quot;&quot;]]</span>
<span class="sd">&gt;&gt;&gt; test_data = spark.createDataFrame(docs).toDF(&quot;text&quot;)</span>
<span class="sd">&gt;&gt;&gt; document1 = DocumentAssembler().setInputCol(&quot;text&quot;).setOutputCol(&quot;document1&quot;)</span>
<span class="sd">&gt;&gt;&gt; document2 = DocumentAssembler().setInputCol(&quot;text&quot;).setOutputCol(&quot;document2&quot;)</span>
<span class="sd">&gt;&gt;&gt; annotation_merger = AnnotationMerger()\</span>
<span class="sd">...     .setInputCols(&quot;document1&quot;, &quot;document2&quot;)\</span>
<span class="sd">...     .setInputType(&quot;document&quot;)\</span>
<span class="sd">...     .setOutputCol(&quot;all_docs&quot;)</span>
<span class="sd">&gt;&gt;&gt;</span>
<span class="sd">&gt;&gt;&gt; pipeline = Pipeline().setStages([document1, document2, annotation_merger]).fit(docs)</span>
<span class="sd">&gt;&gt;&gt; lp = LightPipeline(pipeline)</span>
<span class="sd">&gt;&gt;&gt; lp.fullAnnotate(&quot;one doc to be replicated&quot;)</span>
<span class="sd">[{&#39;document1&#39;: [Annotation(document, 0, 23, one doc to be replicated, {})], &#39;document2&#39;: [Annotation(document, 0, 23, one doc to be replicated, {})], &#39;all_docs&#39;: [Annotation(document, 0, 23, one doc to be replicated, {}), Annotation(document, 0, 23, one doc to be replicated, {})]}]</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;AnnotationMerger&quot;</span>

    <span class="n">inputType</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;inputType&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;The type of the entity that you want to filter by default sentence_embeddings.Possible values document|token|wordpiece|word_embeddings|&quot;</span>
                      <span class="s2">&quot;sentence_embeddings|category|date|sentiment|pos|chunk|named_entity|regex|dependency|labeled_dependency|language|keyword &quot;</span><span class="p">,</span>
                      <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

<div class="viewcode-block" id="AnnotationMerger.setInputType"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.AnnotationMerger.html#sparknlp_jsl.annotator.AnnotationMerger.setInputType">[docs]</a>    <span class="k">def</span> <span class="nf">setInputType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the type of the entity that you want to filter by default sentence_embedding</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">            The type of the entity that you want to filter by default sentence_embedding</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">inputType</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.AnnotationMerger&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AnnotationMerger</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="MedicalBertForTokenClassifier"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalBertForTokenClassifier.html#sparknlp_jsl.annotator.MedicalBertForTokenClassifier">[docs]</a><span class="k">class</span> <span class="nc">MedicalBertForTokenClassifier</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">,</span>
                                    <span class="n">HasCaseSensitiveProperties</span><span class="p">,</span>
                                    <span class="n">HasBatchedAnnotate</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    MedicalBertForTokenClassifier can load Bert Models with a token</span>
<span class="sd">    classification head on top (a linear layer on top of the hidden-states</span>
<span class="sd">    output) e.g. for Named-Entity-Recognition (NER) tasks.</span>

<span class="sd">    Pretrained models can be loaded with :meth:`.pretrained` of the companion</span>
<span class="sd">    object:</span>

<span class="sd">    &gt;&gt;&gt; embeddings = MedicalBertForTokenClassifier.pretrained() \\</span>
<span class="sd">    ...     .setInputCols([&quot;token&quot;, &quot;document&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;label&quot;)</span>

<span class="sd">    The default model is ``&quot;bert_token_classifier_ner_bionlp&quot;``, if no name is</span>
<span class="sd">    provided.</span>

<span class="sd">    For available pretrained models please see the `Models Hub</span>
<span class="sd">    &lt;https://nlp.johnsnowlabs.com/models?task=Named+Entity+Recognition&gt;`__.</span>

<span class="sd">    Models from the HuggingFace 🤗 Transformers library are also compatible with</span>
<span class="sd">    Spark NLP 🚀. To see which models are compatible and how to import them see</span>
<span class="sd">    `Import Transformers into Spark NLP 🚀</span>
<span class="sd">    &lt;https://github.com/JohnSnowLabs/spark-nlp/discussions/5669&gt;`_.</span>

<span class="sd">    ====================== ======================</span>
<span class="sd">    Input Annotation types Output Annotation type</span>
<span class="sd">    ====================== ======================</span>
<span class="sd">    ``DOCUMENT, TOKEN``    ``NAMED_ENTITY``</span>
<span class="sd">    ====================== ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    batchSize</span>
<span class="sd">        Batch size. Large values allows faster processing but requires more</span>
<span class="sd">        memory, by default 8</span>
<span class="sd">    caseSensitive</span>
<span class="sd">        Whether to ignore case in tokens for embeddings matching, by default</span>
<span class="sd">        True</span>
<span class="sd">    configProtoBytes</span>
<span class="sd">        ConfigProto from tensorflow, serialized into byte array.</span>
<span class="sd">    maxSentenceLength</span>
<span class="sd">        Max sentence length to process, by default 128</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \\</span>
<span class="sd">    ...     .setInputCol(&quot;text&quot;) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \\</span>
<span class="sd">    ...     .setInputCols([&quot;document&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;token&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenClassifier = MedicalBertForTokenClassifier.pretrained() \\</span>
<span class="sd">    ...     .setInputCols([&quot;token&quot;, &quot;document&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;label&quot;) \\</span>
<span class="sd">    ...     .setCaseSensitive(True)</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline().setStages([</span>
<span class="sd">    ...     documentAssembler,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     tokenClassifier</span>
<span class="sd">    ... ])</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;Both the erbA IRES and the erbA/myb virus constructs transformed erythroid cells after infection of bone marrow or blastoderm cultures.&quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; result = pipeline.fit(data).transform(data)</span>
<span class="sd">    &gt;&gt;&gt; result.select(&quot;label.result&quot;).show(truncate=False)</span>
<span class="sd">    +------------------------------------------------------------------------------------+</span>
<span class="sd">    |result</span>
<span class="sd">    |</span>
<span class="sd">    +------------------------------------------------------------------------------------+</span>
<span class="sd">    |[O, O, B-Organism, I-Organism, O, O, B-Organism, I-Organism, O, O, B-Cell, I-Cell, O,</span>
<span class="sd">    O, O, B-Multi-tissue_structure, I-Multi-tissue_structure, O, B-Cell, I-Cell, O]|</span>
<span class="sd">    +------------------------------------------------------------------------------------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;MedicalBertForTokenClassifier&quot;</span>

    <span class="n">maxSentenceLength</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                              <span class="s2">&quot;maxSentenceLength&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;Max sentence length to process&quot;</span><span class="p">,</span>
                              <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">configProtoBytes</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                             <span class="s2">&quot;configProtoBytes&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;ConfigProto from tensorflow, serialized into byte array. Get with config_proto.SerializeToString()&quot;</span><span class="p">,</span>
                             <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

<div class="viewcode-block" id="MedicalBertForTokenClassifier.setConfigProtoBytes"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalBertForTokenClassifier.html#sparknlp_jsl.annotator.MedicalBertForTokenClassifier.setConfigProtoBytes">[docs]</a>    <span class="k">def</span> <span class="nf">setConfigProtoBytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets configProto from tensorflow, serialized into byte array.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : List[str]</span>
<span class="sd">            ConfigProto from tensorflow, serialized into byte array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">configProtoBytes</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalBertForTokenClassifier.setMaxSentenceLength"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalBertForTokenClassifier.html#sparknlp_jsl.annotator.MedicalBertForTokenClassifier.setMaxSentenceLength">[docs]</a>    <span class="k">def</span> <span class="nf">setMaxSentenceLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets max sentence length to process, by default 128.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">            Max sentence length to process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">maxSentenceLength</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalBertForTokenClassifier.getClasses"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalBertForTokenClassifier.html#sparknlp_jsl.annotator.MedicalBertForTokenClassifier.getClasses">[docs]</a>    <span class="k">def</span> <span class="nf">getClasses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns labels used to train this model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;getClasses&quot;</span><span class="p">)</span></div>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.classification.MedicalBertForTokenClassifier&quot;</span><span class="p">,</span>
                 <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MedicalBertForTokenClassifier</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span>
            <span class="n">batchSize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">maxSentenceLength</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
            <span class="n">caseSensitive</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

<div class="viewcode-block" id="MedicalBertForTokenClassifier.loadSavedModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalBertForTokenClassifier.html#sparknlp_jsl.annotator.MedicalBertForTokenClassifier.loadSavedModel">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">loadSavedModel</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">spark_session</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Loads a locally saved model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        folder : str</span>
<span class="sd">            Folder of the saved model</span>
<span class="sd">        spark_session : pyspark.sql.SparkSession</span>
<span class="sd">            The current SparkSession</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MedicalBertForTokenClassifier</span>
<span class="sd">            The restored model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">_MedicalBertTokenClassifierLoader</span>
        <span class="n">jModel</span> <span class="o">=</span> <span class="n">_MedicalBertTokenClassifierLoader</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">spark_session</span><span class="o">.</span><span class="n">_jsparkSession</span><span class="p">)</span><span class="o">.</span><span class="n">_java_obj</span>
        <span class="k">return</span> <span class="n">MedicalBertForTokenClassifier</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">jModel</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalBertForTokenClassifier.loadSavedModelOpenSource"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalBertForTokenClassifier.html#sparknlp_jsl.annotator.MedicalBertForTokenClassifier.loadSavedModelOpenSource">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">loadSavedModelOpenSource</span><span class="p">(</span><span class="n">bertForTokenClassifierPath</span><span class="p">,</span> <span class="n">tfModelPath</span><span class="p">,</span> <span class="n">spark_session</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Loads a locally saved model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bertForTokenClassifierPath : str</span>
<span class="sd">            Folder of the bertForTokenClassifier</span>
<span class="sd">        tfModelPath : str</span>
<span class="sd">            Folder taht contains the tf model</span>
<span class="sd">        spark_session : pyspark.sql.SparkSession</span>
<span class="sd">            The current SparkSession</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MedicalBertForTokenClassifier</span>
<span class="sd">            The restored model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">_MedicalBertTokenClassifierLoaderOpensource</span>
        <span class="n">jModel</span> <span class="o">=</span> <span class="n">_MedicalBertTokenClassifierLoaderOpensource</span><span class="p">(</span><span class="n">bertForTokenClassifierPath</span><span class="p">,</span> <span class="n">tfModelPath</span><span class="p">,</span>
                                                             <span class="n">spark_session</span><span class="o">.</span><span class="n">_jsparkSession</span><span class="p">)</span><span class="o">.</span><span class="n">_java_obj</span>
        <span class="k">return</span> <span class="n">MedicalBertForTokenClassifier</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">jModel</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalBertForTokenClassifier.pretrained"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalBertForTokenClassifier.html#sparknlp_jsl.annotator.MedicalBertForTokenClassifier.pretrained">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;bert_token_classifier_ner_bionlp&quot;</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="s2">&quot;clinical/models&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Downloads and loads a pretrained model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str, optional</span>
<span class="sd">            Name of the pretrained model, by default</span>
<span class="sd">            &quot;bert_base_token_classifier_conll03&quot;</span>
<span class="sd">            lang : str, optional</span>
<span class="sd">            Language of the pretrained model, by default &quot;en&quot;</span>
<span class="sd">            remote_loc : str, optional</span>
<span class="sd">            Optional remote address of the resource, by default None. Will use</span>
<span class="sd">            Spark NLPs repositories otherwise.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MedicalBertForTokenClassifier</span>
<span class="sd">            The restored model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.pretrained</span> <span class="kn">import</span> <span class="n">InternalResourceDownloader</span>
        <span class="k">return</span> <span class="n">InternalResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">MedicalBertForTokenClassifier</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="MedicalBertForSequenceClassification"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalBertForSequenceClassification.html#sparknlp_jsl.annotator.MedicalBertForSequenceClassification">[docs]</a><span class="k">class</span> <span class="nc">MedicalBertForSequenceClassification</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">,</span>
                                           <span class="n">HasCaseSensitiveProperties</span><span class="p">,</span>
                                           <span class="n">HasBatchedAnnotate</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    MedicalBertForTokenClassifier  can load Bert Models with sequence classification/regression head on top</span>
<span class="sd">    (a linear layer on top of the pooled output) e.g. for multi-class document classification tasks.</span>

<span class="sd">    Pretrained models can be loaded with :meth:`.pretrained` of the companion</span>
<span class="sd">    object:</span>

<span class="sd">    For available pretrained models please see the `Models Hub</span>
<span class="sd">    &lt;https://nlp.johnsnowlabs.com/models?task=Named+Entity+Recognition&gt;`__.</span>

<span class="sd">    Models from the HuggingFace 🤗 Transformers library are also compatible with</span>
<span class="sd">    Spark NLP 🚀. To see which models are compatible and how to import them see</span>
<span class="sd">    `Import Transformers into Spark NLP 🚀</span>
<span class="sd">    &lt;https://github.com/JohnSnowLabs/spark-nlp/discussions/5669&gt;`_.</span>

<span class="sd">    ====================== ======================</span>
<span class="sd">    Input Annotation types Output Annotation type</span>
<span class="sd">    ====================== ======================</span>
<span class="sd">    ``DOCUMENT, TOKEN``    ``CATEGORY``</span>
<span class="sd">    ====================== ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    batchSize</span>
<span class="sd">        Batch size. Large values allows faster processing but requires more</span>
<span class="sd">        memory, by default 8</span>
<span class="sd">    caseSensitive</span>
<span class="sd">        Whether to ignore case in tokens for embeddings matching, by default</span>
<span class="sd">        True</span>
<span class="sd">    configProtoBytes</span>
<span class="sd">        ConfigProto from tensorflow, serialized into byte array.</span>
<span class="sd">    maxSentenceLength</span>
<span class="sd">        Max sentence length to process, by default 128</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \\</span>
<span class="sd">    ...     .setInputCol(&quot;text&quot;) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \\</span>
<span class="sd">    ...     .setInputCols([&quot;document&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;token&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenClassifier = MedicalBertForSequenceClassification.pretrained() \\</span>
<span class="sd">    ...     .setInputCols([&quot;token&quot;, &quot;document&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;label&quot;) \\</span>
<span class="sd">    ...     .setCaseSensitive(True)</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline().setStages([</span>
<span class="sd">    ...     documentAssembler,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     tokenClassifier</span>
<span class="sd">    ... ])</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;I felt a bit drowsy and had blurred vision after taking Aspirin.&quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; result = pipeline.fit(data).transform(data)</span>
<span class="sd">    &gt;&gt;&gt; result.select(&quot;label.result&quot;).show(truncate=False)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;MedicalBertForSequenceClassification&quot;</span>

    <span class="n">maxSentenceLength</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                              <span class="s2">&quot;maxSentenceLength&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;Max sentence length to process&quot;</span><span class="p">,</span>
                              <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">configProtoBytes</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                             <span class="s2">&quot;configProtoBytes&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;ConfigProto from tensorflow, serialized into byte array. Get with config_proto.SerializeToString()&quot;</span><span class="p">,</span>
                             <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

    <span class="n">coalesceSentences</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;coalesceSentences&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;Instead of 1 class per sentence (if inputCols is &#39;&#39;&#39;sentence&#39;&#39;&#39;) output 1 class per document by averaging probabilities in all sentences.&quot;</span><span class="p">,</span>
                              <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

<div class="viewcode-block" id="MedicalBertForSequenceClassification.setConfigProtoBytes"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalBertForSequenceClassification.html#sparknlp_jsl.annotator.MedicalBertForSequenceClassification.setConfigProtoBytes">[docs]</a>    <span class="k">def</span> <span class="nf">setConfigProtoBytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets configProto from tensorflow, serialized into byte array.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : List[str]</span>
<span class="sd">            ConfigProto from tensorflow, serialized into byte array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">configProtoBytes</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalBertForSequenceClassification.setMaxSentenceLength"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalBertForSequenceClassification.html#sparknlp_jsl.annotator.MedicalBertForSequenceClassification.setMaxSentenceLength">[docs]</a>    <span class="k">def</span> <span class="nf">setMaxSentenceLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets max sentence length to process, by default 128.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">            Max sentence length to process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">maxSentenceLength</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalBertForSequenceClassification.getClasses"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalBertForSequenceClassification.html#sparknlp_jsl.annotator.MedicalBertForSequenceClassification.getClasses">[docs]</a>    <span class="k">def</span> <span class="nf">getClasses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns labels used to train this model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;getClasses&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalBertForSequenceClassification.setCoalesceSentences"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalBertForSequenceClassification.html#sparknlp_jsl.annotator.MedicalBertForSequenceClassification.setCoalesceSentences">[docs]</a>    <span class="k">def</span> <span class="nf">setCoalesceSentences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Instead of 1 class per sentence (if inputCols is &#39;&#39;&#39;sentence&#39;&#39;&#39;) output 1 class per document by averaging probabilities in all sentences.</span>
<span class="sd">        Due to max sequence length limit in almost all transformer models such as BERT (512 tokens), this parameter helps feeding all the sentences</span>
<span class="sd">        into the model and averaging all the probabilities for the entire document instead of probabilities per sentence. (Default: true)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            If the output of all sentences will be averaged to one output</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">coalesceSentences</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.classification.MedicalBertForSequenceClassification&quot;</span><span class="p">,</span>
                 <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MedicalBertForSequenceClassification</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span>
            <span class="n">batchSize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">maxSentenceLength</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
            <span class="n">caseSensitive</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

<div class="viewcode-block" id="MedicalBertForSequenceClassification.loadSavedModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalBertForSequenceClassification.html#sparknlp_jsl.annotator.MedicalBertForSequenceClassification.loadSavedModel">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">loadSavedModel</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">spark_session</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Loads a locally saved model</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        folder : str</span>
<span class="sd">            Folder of the saved model</span>
<span class="sd">        spark_session : pyspark.sql.SparkSession</span>
<span class="sd">            The current SparkSession</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MedicalBertForSequenceClassification</span>
<span class="sd">            The restored model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">_MedicalBertForSequenceClassificationLoader</span>
        <span class="n">jModel</span> <span class="o">=</span> <span class="n">_MedicalBertForSequenceClassificationLoader</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">spark_session</span><span class="o">.</span><span class="n">_jsparkSession</span><span class="p">)</span><span class="o">.</span><span class="n">_java_obj</span>
        <span class="k">return</span> <span class="n">MedicalBertForSequenceClassification</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">jModel</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalBertForSequenceClassification.loadSavedModelOpenSource"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalBertForSequenceClassification.html#sparknlp_jsl.annotator.MedicalBertForSequenceClassification.loadSavedModelOpenSource">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">loadSavedModelOpenSource</span><span class="p">(</span><span class="n">bertForTokenClassifierPath</span><span class="p">,</span> <span class="n">tfModelPath</span><span class="p">,</span> <span class="n">spark_session</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Loads a locally saved model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bertForTokenClassifierPath : str</span>
<span class="sd">            Folder of the bertForTokenClassifier</span>
<span class="sd">        tfModelPath : str</span>
<span class="sd">            Folder taht contains the tf model</span>
<span class="sd">        spark_session : pyspark.sql.SparkSession</span>
<span class="sd">            The current SparkSession</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MedicalBertForSequenceClassification</span>
<span class="sd">            The restored model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">_MedicalBertForSequenceClassificationLoaderOpensource</span>
        <span class="n">jModel</span> <span class="o">=</span> <span class="n">_MedicalBertForSequenceClassificationLoaderOpensource</span><span class="p">(</span><span class="n">bertForTokenClassifierPath</span><span class="p">,</span> <span class="n">tfModelPath</span><span class="p">,</span>
                                                                       <span class="n">spark_session</span><span class="o">.</span><span class="n">_jsparkSession</span><span class="p">)</span><span class="o">.</span><span class="n">_java_obj</span>
        <span class="k">return</span> <span class="n">MedicalBertForSequenceClassification</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">jModel</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalBertForSequenceClassification.pretrained"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalBertForSequenceClassification.html#sparknlp_jsl.annotator.MedicalBertForSequenceClassification.pretrained">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;bert_sequence_classifier_ade&quot;</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="s2">&quot;clinical/models&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Downloads and loads a pretrained model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str, optional</span>
<span class="sd">            Name of the pretrained model.</span>
<span class="sd">        lang : str, optional</span>
<span class="sd">            Language of the pretrained model, by default &quot;en&quot;</span>
<span class="sd">        remote_loc : str, optional</span>
<span class="sd">            Optional remote address of the resource, by default None. Will use</span>
<span class="sd">            Spark NLPs repositories otherwise.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MedicalBertForSequenceClassification</span>
<span class="sd">            The restored model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.pretrained</span> <span class="kn">import</span> <span class="n">InternalResourceDownloader</span>
        <span class="k">return</span> <span class="n">InternalResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">MedicalBertForSequenceClassification</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="MedicalDistilBertForSequenceClassification"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalDistilBertForSequenceClassification.html#sparknlp_jsl.annotator.MedicalDistilBertForSequenceClassification">[docs]</a><span class="k">class</span> <span class="nc">MedicalDistilBertForSequenceClassification</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">,</span>
                                                 <span class="n">HasCaseSensitiveProperties</span><span class="p">,</span>
                                                 <span class="n">HasBatchedAnnotate</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    MedicalDistilBertForSequenceClassification can load DistilBERT Models with sequence classification/regression head on</span>
<span class="sd">    top (a linear layer on top of the pooled output) e.g. for multi-class document classification tasks.</span>

<span class="sd">    Pretrained models can be loaded with :meth:`.pretrained` of the companion</span>
<span class="sd">    object:</span>

<span class="sd">    &gt;&gt;&gt; sequenceClassifier = MedicalDistilBertForSequenceClassification.pretrained() \\</span>
<span class="sd">    ...     .setInputCols([&quot;token&quot;, &quot;document&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;label&quot;)</span>



<span class="sd">    Models from the HuggingFace 🤗 Transformers library are also compatible with</span>
<span class="sd">    Spark NLP 🚀. To see which models are compatible and how to import them see</span>
<span class="sd">    `Import Transformers into Spark NLP 🚀</span>
<span class="sd">    &lt;https://github.com/JohnSnowLabs/spark-nlp/discussions/5669&gt;`_.</span>

<span class="sd">    ====================== ======================</span>
<span class="sd">    Input Annotation types Output Annotation type</span>
<span class="sd">    ====================== ======================</span>
<span class="sd">    ``DOCUMENT, TOKEN``    ``CATEGORY``</span>
<span class="sd">    ====================== ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    batchSize</span>
<span class="sd">        Batch size. Large values allows faster processing but requires more</span>
<span class="sd">        memory, by default 8</span>
<span class="sd">    caseSensitive</span>
<span class="sd">        Whether to ignore case in tokens for embeddings matching, by default</span>
<span class="sd">        True</span>
<span class="sd">    configProtoBytes</span>
<span class="sd">        ConfigProto from tensorflow, serialized into byte array.</span>
<span class="sd">    maxSentenceLength</span>
<span class="sd">        Max sentence length to process, by default 128</span>
<span class="sd">    coalesceSentences</span>
<span class="sd">        Instead of 1 class per sentence (if inputCols is sentence) output 1 class per document by averaging</span>
<span class="sd">        probabilities in all sentences.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler() \\</span>
<span class="sd">    ...     .setInputCol(&quot;text&quot;) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \\</span>
<span class="sd">    ...     .setInputCols([&quot;document&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;token&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sequenceClassifier = MedicalDistilBertForSequenceClassification.pretrained() \\</span>
<span class="sd">    ...     .setInputCols([&quot;token&quot;, &quot;document&quot;]) \\</span>
<span class="sd">    ...     .setOutputCol(&quot;label&quot;) \\</span>
<span class="sd">    ...     .setCaseSensitive(True)</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline().setStages([</span>
<span class="sd">    ...     documentAssembler,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     sequenceClassifier</span>
<span class="sd">    ... ])</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame([[&quot;I felt a bit drowsy and had blurred vision after taking Aspirin.&quot;]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; result = pipeline.fit(data).transform(data)</span>
<span class="sd">    &gt;&gt;&gt; result.select(&quot;label.result&quot;).show(truncate=False)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;MedicalDistilBertForSequenceClassification&quot;</span>

    <span class="n">maxSentenceLength</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                              <span class="s2">&quot;maxSentenceLength&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;Max sentence length to process&quot;</span><span class="p">,</span>
                              <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">configProtoBytes</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                             <span class="s2">&quot;configProtoBytes&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;ConfigProto from tensorflow, serialized into byte array. Get with config_proto.SerializeToString()&quot;</span><span class="p">,</span>
                             <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListInt</span><span class="p">)</span>

    <span class="n">coalesceSentences</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;coalesceSentences&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;Instead of 1 class per sentence (if inputCols is &#39;&#39;&#39;sentence&#39;&#39;&#39;) output 1 class per document by averaging probabilities in all sentences.&quot;</span><span class="p">,</span>
                              <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

<div class="viewcode-block" id="MedicalDistilBertForSequenceClassification.getClasses"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalDistilBertForSequenceClassification.html#sparknlp_jsl.annotator.MedicalDistilBertForSequenceClassification.getClasses">[docs]</a>    <span class="k">def</span> <span class="nf">getClasses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns labels used to train this model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_java</span><span class="p">(</span><span class="s2">&quot;getClasses&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalDistilBertForSequenceClassification.setConfigProtoBytes"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalDistilBertForSequenceClassification.html#sparknlp_jsl.annotator.MedicalDistilBertForSequenceClassification.setConfigProtoBytes">[docs]</a>    <span class="k">def</span> <span class="nf">setConfigProtoBytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets configProto from tensorflow, serialized into byte array.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : List[int]</span>
<span class="sd">            ConfigProto from tensorflow, serialized into byte array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">configProtoBytes</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalDistilBertForSequenceClassification.setMaxSentenceLength"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalDistilBertForSequenceClassification.html#sparknlp_jsl.annotator.MedicalDistilBertForSequenceClassification.setMaxSentenceLength">[docs]</a>    <span class="k">def</span> <span class="nf">setMaxSentenceLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets max sentence length to process, by default 128.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">            Max sentence length to process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">maxSentenceLength</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalDistilBertForSequenceClassification.setCoalesceSentences"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalDistilBertForSequenceClassification.html#sparknlp_jsl.annotator.MedicalDistilBertForSequenceClassification.setCoalesceSentences">[docs]</a>    <span class="k">def</span> <span class="nf">setCoalesceSentences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Instead of 1 class per sentence (if inputCols is &#39;&#39;&#39;sentence&#39;&#39;&#39;) output 1 class per document by averaging probabilities in all sentences.</span>
<span class="sd">        Due to max sequence length limit in almost all transformer models such as BERT (512 tokens), this parameter helps feeding all the sentences</span>
<span class="sd">        into the model and averaging all the probabilities for the entire document instead of probabilities per sentence. (Default: true)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            If the output of all sentences will be averaged to one output</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">coalesceSentences</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.classification.MedicalDistilBertForSequenceClassification&quot;</span><span class="p">,</span>
                 <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MedicalDistilBertForSequenceClassification</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span>
            <span class="n">batchSize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">maxSentenceLength</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
            <span class="n">caseSensitive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">coalesceSentences</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

<div class="viewcode-block" id="MedicalDistilBertForSequenceClassification.loadSavedModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalDistilBertForSequenceClassification.html#sparknlp_jsl.annotator.MedicalDistilBertForSequenceClassification.loadSavedModel">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">loadSavedModel</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">spark_session</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Loads a locally saved model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        folder : str</span>
<span class="sd">            Folder of the saved model</span>
<span class="sd">        spark_session : pyspark.sql.SparkSession</span>
<span class="sd">            The current SparkSession</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DistilBertForSequenceClassification</span>
<span class="sd">            The restored model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">_MedicalDistilBertForSequenceClassificationLoader</span>
        <span class="n">jModel</span> <span class="o">=</span> <span class="n">_MedicalDistilBertForSequenceClassificationLoader</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">spark_session</span><span class="o">.</span><span class="n">_jsparkSession</span><span class="p">)</span><span class="o">.</span><span class="n">_java_obj</span>
        <span class="k">return</span> <span class="n">DistilBertForSequenceClassification</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">jModel</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalDistilBertForSequenceClassification.loadSavedModelOpenSource"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalDistilBertForSequenceClassification.html#sparknlp_jsl.annotator.MedicalDistilBertForSequenceClassification.loadSavedModelOpenSource">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">loadSavedModelOpenSource</span><span class="p">(</span><span class="n">destilBertForTokenClassifierPath</span><span class="p">,</span> <span class="n">tfModelPath</span><span class="p">,</span> <span class="n">spark_session</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Loads a locally saved model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bertForTokenClassifierPath : str</span>
<span class="sd">            Folder of the bertForTokenClassifier</span>
<span class="sd">        tfModelPath : str</span>
<span class="sd">            Folder taht contains the tf model</span>
<span class="sd">        spark_session : pyspark.sql.SparkSession</span>
<span class="sd">            The current SparkSession</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MedicalBertForSequenceClassification</span>
<span class="sd">            The restored model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">_MedicalDistilBertForSequenceClassificationLoaderOpensource</span>
        <span class="n">jModel</span> <span class="o">=</span> <span class="n">_MedicalDistilBertForSequenceClassificationLoaderOpensource</span><span class="p">(</span><span class="n">destilBertForTokenClassifierPath</span><span class="p">,</span>
                                                                             <span class="n">tfModelPath</span><span class="p">,</span>
                                                                             <span class="n">spark_session</span><span class="o">.</span><span class="n">_jsparkSession</span><span class="p">)</span><span class="o">.</span><span class="n">_java_obj</span>
        <span class="k">return</span> <span class="n">MedicalDistilBertForSequenceClassification</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">jModel</span><span class="p">)</span></div>

<div class="viewcode-block" id="MedicalDistilBertForSequenceClassification.pretrained"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalDistilBertForSequenceClassification.html#sparknlp_jsl.annotator.MedicalDistilBertForSequenceClassification.pretrained">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;distilbert_sequence_classifier_ade&quot;</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="s2">&quot;clinical/models&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Downloads and loads a pretrained model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str, optional</span>
<span class="sd">            Name of the pretrained model, by default</span>
<span class="sd">        lang : str, optional</span>
<span class="sd">            Language of the pretrained model, by default &quot;en&quot;</span>
<span class="sd">        remote_loc : str, optional</span>
<span class="sd">            Optional remote address of the resource, by default None. Will use</span>
<span class="sd">            Spark NLPs repositories otherwise.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MedicalBertForTokenClassifier</span>
<span class="sd">            The restored model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.pretrained</span> <span class="kn">import</span> <span class="n">InternalResourceDownloader</span>
        <span class="k">return</span> <span class="n">InternalResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">MedicalDistilBertForSequenceClassification</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="EntityChunkEmbeddings"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.EntityChunkEmbeddings.html#sparknlp_jsl.annotator.EntityChunkEmbeddings">[docs]</a><span class="k">class</span> <span class="nc">EntityChunkEmbeddings</span><span class="p">(</span><span class="n">BertSentenceEmbeddings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Weighted average embeddings of multiple named entities chunk annotations</span>

<span class="sd">    ====================== =======================</span>
<span class="sd">    Input Annotation types Output Annotation type</span>
<span class="sd">    ====================== =======================</span>
<span class="sd">    ``DEPENDENCY, CHUNK``  ``SENTENCE_EMBEDDINGS``</span>
<span class="sd">    ====================== =======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    targetEntities</span>
<span class="sd">        Target entities and their related entities</span>
<span class="sd">    entityWeights</span>
<span class="sd">        Relative weights of entities.</span>
<span class="sd">    maxSyntacticDistance</span>
<span class="sd">        Maximal syntactic distance between related entities. Default value is 2.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; documenter = DocumentAssembler()\</span>
<span class="sd">    ...     .setInputCol(&quot;text&quot;)\</span>
<span class="sd">    ...     .setOutputCol(&quot;documents&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentence_detector = SentenceDetector() \</span>
<span class="sd">    ...     .setInputCols(&quot;documents&quot;) \</span>
<span class="sd">    ...     .setOutputCol(&quot;sentences&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \</span>
<span class="sd">    ...     .setInputCols(&quot;sentences&quot;) \</span>
<span class="sd">    ...     .setOutputCol(&quot;tokens&quot;)</span>
<span class="sd">    &gt;&gt;&gt; embeddings = WordEmbeddingsModel() \</span>
<span class="sd">    ...     .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\</span>
<span class="sd">    ...     .setInputCols([&quot;sentences&quot;, &quot;tokens&quot;])\</span>
<span class="sd">    ...     .setOutputCol(&quot;embeddings&quot;)</span>
<span class="sd">    &gt;&gt;&gt; ner_model = MedicalNerModel()\</span>
<span class="sd">    ...     .pretrained(&quot;ner_posology_large&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\</span>
<span class="sd">    ...     .setInputCols([&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;])\</span>
<span class="sd">    ...     .setOutputCol(&quot;ner&quot;)</span>
<span class="sd">    &gt;&gt;&gt; ner_converter = NerConverterInternal()\</span>
<span class="sd">    ...     .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;ner&quot;)\</span>
<span class="sd">    ...     .setOutputCol(&quot;ner_chunks&quot;)</span>
<span class="sd">    &gt;&gt;&gt; pos_tager = PerceptronModel()\</span>
<span class="sd">    ...     .pretrained(&quot;pos_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\</span>
<span class="sd">    ...     .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;)\</span>
<span class="sd">    ...     .setOutputCol(&quot;pos_tags&quot;)</span>
<span class="sd">    &gt;&gt;&gt; dependency_parser = DependencyParserModel()\</span>
<span class="sd">    ...     .pretrained(&quot;dependency_conllu&quot;, &quot;en&quot;)\</span>
<span class="sd">    ...     .setInputCols([&quot;sentences&quot;, &quot;pos_tags&quot;, &quot;tokens&quot;])\</span>
<span class="sd">    ...     .setOutputCol(&quot;dependencies&quot;)</span>
<span class="sd">    &gt;&gt;&gt; drug_chunk_embeddings = EntityChunkEmbeddings()\</span>
<span class="sd">    ...     .pretrained(&quot;sbiobert_base_cased_mli&quot;,&quot;en&quot;,&quot;clinical/models&quot;)\</span>
<span class="sd">    ...     .setInputCols([&quot;ner_chunks&quot;, &quot;dependencies&quot;])\</span>
<span class="sd">    ...     .setOutputCol(&quot;drug_chunk_embeddings&quot;)\</span>
<span class="sd">    ...     .setMaxSyntacticDistance(3)\</span>
<span class="sd">    ...     .setTargetEntities({&quot;DRUG&quot;: []})</span>
<span class="sd">    ...     .setEntityWeights({&quot;DRUG&quot;: 0.8, &quot;STRENGTH&quot;: 0.2, &quot;DOSAGE&quot;: 0.2, &quot;FORM&quot;: 0.5})</span>
<span class="sd">    &gt;&gt;&gt; sampleData = &quot;The parient was given metformin 125 mg, 250 mg of coumadin and then one pill paracetamol&quot;</span>
<span class="sd">    &gt;&gt;&gt; data = SparkContextForTest.spark.createDataFrame([[sampleData]]).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline().setStages([</span>
<span class="sd">    ...     documenter,</span>
<span class="sd">    ...     sentence_detector,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     embeddings,</span>
<span class="sd">    ...     ner_model,</span>
<span class="sd">    ...     ner_converter,</span>
<span class="sd">    ...     pos_tager,</span>
<span class="sd">    ...     dependency_parser,</span>
<span class="sd">    ...     drug_chunk_embeddings])</span>
<span class="sd">    &gt;&gt;&gt; results = pipeline.fit(data).transform(data)</span>
<span class="sd">    &gt;&gt;&gt; results = results \</span>
<span class="sd">    ...     .selectExpr(&quot;explode(drug_chunk_embeddings) AS drug_chunk&quot;) \</span>
<span class="sd">    ...     .selectExpr(&quot;drug_chunk.result&quot;, &quot;slice(drug_chunk.embeddings, 1, 5) AS drug_embedding&quot;) \</span>
<span class="sd">    ...     .cache()</span>
<span class="sd">    &gt;&gt;&gt; results.show(truncate=False)</span>
<span class="sd">+-----------------------------+-----------------------------------------------------------------+</span>
<span class="sd">|                       result|                                                  drug_embedding&quot;|</span>
<span class="sd">+-----------------------------+-----------------------------------------------------------------+</span>
<span class="sd">|metformin 125 mg             |[-0.267413, 0.07614058, -0.5620966, 0.83838946, 0.8911504]       |</span>
<span class="sd">|250 mg coumadin              |[0.22319649, -0.07094894, -0.6885556, 0.79176235, 0.82672405]    |</span>
<span class="sd">|one pill paracetamol         |[-0.10939768, -0.29242, -0.3574444, 0.3981813, 0.79609615]       |</span>
<span class="sd">+-----------------------------+-----------------------------------------------------------------+</span>
<span class="sd">&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;EntityChunkEmbeddings&quot;</span>

    <span class="n">entityWeights</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                          <span class="s2">&quot;entityWeights&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Relative weights of named entities.&quot;</span><span class="p">,</span>
                          <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

    <span class="n">targetEntities</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                           <span class="s2">&quot;targetEntities&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;Target entities and the entities they are related to.&quot;</span><span class="p">,</span>
                           <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

    <span class="n">maxSyntacticDistance</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;maxSyntacticDistance&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;Maximal syntactic distance between related DRUG and non-DRUG entities&quot;</span><span class="p">,</span>
                                 <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

<div class="viewcode-block" id="EntityChunkEmbeddings.setEntityWeights"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.EntityChunkEmbeddings.html#sparknlp_jsl.annotator.EntityChunkEmbeddings.setEntityWeights">[docs]</a>    <span class="k">def</span> <span class="nf">setEntityWeights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the relative weights of the embeddings of specific entities. By default the dictionary is empty and</span>
<span class="sd">         all entities have equal weights. If non-empty and some entity is not in it, then its weight is set to 0.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        weights: : dict[str, float]</span>
<span class="sd">            Dictionary with the relative weighs of entities. The notation TARGET_ENTITY:RELATED_ENTITY can be used to</span>
<span class="sd">            specify the weight of a entity which is related to specific target entity (e.g. &quot;DRUG:SYMPTOM&quot;: 0.3).</span>
<span class="sd">            Entity names are case-insensitive.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">}</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">EntityWeights</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">entityWeights</span><span class="o">=</span><span class="n">EntityWeights</span><span class="p">(</span><span class="n">weights</span><span class="p">))</span></div>

<div class="viewcode-block" id="EntityChunkEmbeddings.setTargetEntities"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.EntityChunkEmbeddings.html#sparknlp_jsl.annotator.EntityChunkEmbeddings.setTargetEntities">[docs]</a>    <span class="k">def</span> <span class="nf">setTargetEntities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entities</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the target entities and maps them to their related entities. A target entity with an empty list of</span>
<span class="sd">        related entities means all other entities are assumed to be related to it.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        entities: dict[str, list[str]]</span>
<span class="sd">            Dictionary with target and related entities (TARGET: [RELATED1, RELATED2,...]). If the list of related</span>
<span class="sd">            entities is empty, then all non-target entities are considered.</span>
<span class="sd">            Entity names are case insensitive.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">entities</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">entities</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">TargetEntities</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">targetEntities</span><span class="o">=</span><span class="n">TargetEntities</span><span class="p">(</span><span class="n">entities</span><span class="p">))</span></div>

<div class="viewcode-block" id="EntityChunkEmbeddings.setMaxSyntacticDistance"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.EntityChunkEmbeddings.html#sparknlp_jsl.annotator.EntityChunkEmbeddings.setMaxSyntacticDistance">[docs]</a>    <span class="k">def</span> <span class="nf">setMaxSyntacticDistance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the maximal syntactic distance between related entities. Default value is 2.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        distance : int</span>
<span class="sd">            Maximal syntactic distance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">maxSyntacticDistance</span><span class="o">=</span><span class="n">distance</span><span class="p">)</span></div>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.embeddings.EntityChunkEmbeddings&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EntityChunkEmbeddings</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span>
            <span class="n">dimension</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span>
            <span class="n">batchSize</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
            <span class="n">maxSentenceLength</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
            <span class="n">caseSensitive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">maxSyntacticDistance</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">)</span>

<div class="viewcode-block" id="EntityChunkEmbeddings.pretrained"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.EntityChunkEmbeddings.html#sparknlp_jsl.annotator.EntityChunkEmbeddings.pretrained">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;sbiobert_base_cased_mli&quot;</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="s2">&quot;clinical/models&quot;</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.pretrained</span> <span class="kn">import</span> <span class="n">InternalResourceDownloader</span>
        <span class="k">return</span> <span class="n">InternalResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">EntityChunkEmbeddings</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div></div>
<div class="viewcode-block" id="ChunkMapperApproach"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMapperApproach.html#sparknlp_jsl.annotator.ChunkMapperApproach">[docs]</a><span class="k">class</span> <span class="nc">ChunkMapperApproach</span><span class="p">(</span><span class="n">AnnotatorApproach</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The chunk mapper Approach load a JsonDictionary that have the relations to be mapped in the ChunkMapperModel</span>

<span class="sd">    ====================== =======================</span>
<span class="sd">    Input Annotation types Output Annotation type</span>
<span class="sd">    ====================== =======================</span>
<span class="sd">    ``CHUNK``              ``LABEL_DEPENDENCY``</span>
<span class="sd">    ====================== =======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dictionary</span>
<span class="sd">        Dictionary path where is the json that contains the mappinmgs columns</span>
<span class="sd">    rel</span>
<span class="sd">        Relation that we going to use to map the chunk</span>
<span class="sd">    lowerCase</span>
<span class="sd">        Parameter to decide if we going to use the chunk mapper or not</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; documenter = DocumentAssembler()\</span>
<span class="sd">    ...     .setInputCol(&quot;text&quot;)\</span>
<span class="sd">    ...     .setOutputCol(&quot;documents&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentence_detector = SentenceDetector() \</span>
<span class="sd">    ...     .setInputCols(&quot;documents&quot;) \</span>
<span class="sd">    ...     .setOutputCol(&quot;sentences&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \</span>
<span class="sd">    ...     .setInputCols(&quot;sentences&quot;) \</span>
<span class="sd">    ...     .setOutputCol(&quot;tokens&quot;)</span>
<span class="sd">    &gt;&gt;&gt; embeddings = WordEmbeddingsModel() \</span>
<span class="sd">    ...     .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\</span>
<span class="sd">    ...     .setInputCols([&quot;sentences&quot;, &quot;tokens&quot;])\</span>
<span class="sd">    ...     .setOutputCol(&quot;embeddings&quot;)</span>
<span class="sd">    &gt;&gt;&gt; ner_model = MedicalNerModel()\</span>
<span class="sd">    ...     .pretrained(&quot;ner_posology_large&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\</span>
<span class="sd">    ...     .setInputCols([&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;])\</span>
<span class="sd">    ...     .setOutputCol(&quot;ner&quot;)</span>
<span class="sd">    &gt;&gt;&gt; ner_converter = NerConverterInternal()\</span>
<span class="sd">    ...     .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;ner&quot;)\</span>
<span class="sd">    ...     .setOutputCol(&quot;ner_chunks&quot;)</span>
<span class="sd">    &gt;&gt;&gt; chunkerMapperapproach = ChunkMapperApproach()\</span>
<span class="sd">    ...    .setInputCols([&quot;ner_chunk&quot;])\</span>
<span class="sd">    ...    .setOutputCol(&quot;mappings&quot;)\</span>
<span class="sd">    ...    .setDictionary(&quot;/home/jsl/mappings2.json&quot;) \</span>
<span class="sd">    ...    .setRels([&quot;action&quot;]) \</span>
<span class="sd">    &gt;&gt;&gt; sampleData = &quot;The patient was given Warfarina Lusa and amlodipine 10 MG.&quot;</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline().setStages([</span>
<span class="sd">    ...     documenter,</span>
<span class="sd">    ...     sentence_detector,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     embeddings,</span>
<span class="sd">    ...     ner_model,</span>
<span class="sd">    ...     ner_converter])</span>
<span class="sd">    &gt;&gt;&gt; results = pipeline.fit(data).transform(data)</span>
<span class="sd">    &gt;&gt;&gt; results.select(&quot;mappings&quot;).show(truncate=False)</span>
<span class="sd">+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">|mappings                                                                                                                                                                                                                                                                                                                                                                                               |</span>
<span class="sd">+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">|[{labeled_dependency, 22, 35, Analgesic, {chunk -&gt; 0, relation -&gt; action, confidence -&gt; 0.56995, all_relations -&gt; Antipyretic, entity -&gt; Warfarina Lusa, sentence -&gt; 0}, []}, {labeled_dependency, 41, 50, NONE, {entity -&gt; amlodipine, sentence -&gt; 0, chunk -&gt; 1, confidence -&gt; 0.9989}, []}, {labeled_dependency, 55, 56, NONE, {entity -&gt; MG, sentence -&gt; 0, chunk -&gt; 2, confidence -&gt; 0.9123}, []}]|</span>
<span class="sd">+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>

<span class="sd">&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ChunkMapperApproach&quot;</span>

    <span class="n">dictionary</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                       <span class="s2">&quot;dictionary&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Path to dictionary file in tsv or csv format&quot;</span><span class="p">,</span>
                       <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>
    <span class="n">rel</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                <span class="s2">&quot;rel&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Relation for the model&quot;</span><span class="p">,</span>
                <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">lowerCase</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                      <span class="s2">&quot;lowerCase&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Set if we want to save the dictionary in lower case or not&quot;</span><span class="p">,</span>
                      <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">allowMultiTokenChunk</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                 <span class="s2">&quot;allowMultiTokenChunk&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;Whether   skyp relations with multitokens&quot;</span><span class="p">,</span>
                                 <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">multivaluesRelations</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                 <span class="s2">&quot;multivaluesRelations&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;Whether  to decide if we want to send multi-chunk tokens or only single token chunks&quot;</span><span class="p">,</span>
                                 <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">rels</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                    <span class="s2">&quot;rels&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;relations to be mappen in the dictionary&quot;</span><span class="p">,</span>
                    <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

<div class="viewcode-block" id="ChunkMapperApproach.setDictionary"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMapperApproach.html#sparknlp_jsl.annotator.ChunkMapperApproach.setDictionary">[docs]</a>    <span class="k">def</span> <span class="nf">setDictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets if we want to use &#39;bow&#39; for word embeddings or &#39;sentence&#39; for sentences&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            Path where is the dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">dictionary</span><span class="o">=</span><span class="n">p</span><span class="p">)</span></div>

<div class="viewcode-block" id="ChunkMapperApproach.setLowerCase"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMapperApproach.html#sparknlp_jsl.annotator.ChunkMapperApproach.setLowerCase">[docs]</a>    <span class="k">def</span> <span class="nf">setLowerCase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set if we want to save the keys of the dictionary in lower case or not</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lc : bool</span>
<span class="sd">            Parameter that select if you want to use the keys in lower case or not</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">lowerCase</span><span class="o">=</span><span class="n">lc</span><span class="p">)</span></div>

<div class="viewcode-block" id="ChunkMapperApproach.setAllowMultiTokenChunk"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMapperApproach.html#sparknlp_jsl.annotator.ChunkMapperApproach.setAllowMultiTokenChunk">[docs]</a>    <span class="k">def</span> <span class="nf">setAllowMultiTokenChunk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Whether  if we skyp relations with multitokens</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mc : bool</span>
<span class="sd">            &quot;Whether  to decide if we want to send multi-chunk tokens or only single token chunks</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">allowMultiTokenChunk</span><span class="o">=</span><span class="n">mc</span><span class="p">)</span></div>

<div class="viewcode-block" id="ChunkMapperApproach.setMultivaluesRelations"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMapperApproach.html#sparknlp_jsl.annotator.ChunkMapperApproach.setMultivaluesRelations">[docs]</a>    <span class="k">def</span> <span class="nf">setMultivaluesRelations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Whether  to decide if we want to send multi-chunk tokens or only single token chunks</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">         mc : bool</span>
<span class="sd">             &quot;Whether  to decide if we want to send multi-chunk tokens or only single token chunks</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">multivaluesRelations</span><span class="o">=</span><span class="n">mc</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">setRel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">rel</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setRels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rs</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">rels</span><span class="o">=</span><span class="n">rs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.chunker.ChunkMapperApproach&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ChunkMapperApproach</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span>
        <span class="p">)</span>
    <span class="k">def</span> <span class="nf">_create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">java_model</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ChunkMergeModel</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span><span class="p">)</span></div>


<div class="viewcode-block" id="ChunkMapperModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMapperModel.html#sparknlp_jsl.annotator.ChunkMapperModel">[docs]</a><span class="k">class</span> <span class="nc">ChunkMapperModel</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The chunk mapper Approach load a JsonDictionary that have the relations to be mapped in the ChunkMapperModel</span>

<span class="sd">    ====================== =======================</span>
<span class="sd">    Input Annotation types Output Annotation type</span>
<span class="sd">    ====================== =======================</span>
<span class="sd">    ``CHUNK``              ``LABEL_DEPENDENCY``</span>
<span class="sd">    ====================== =======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dictionary</span>
<span class="sd">        Dictionary path where is the json that contains the mappinmgs columns</span>
<span class="sd">    rel</span>
<span class="sd">        Relation that we going to use to map the chunk</span>
<span class="sd">    lowerCase</span>
<span class="sd">        Parameter to decide if we going to use the chunk mapper or not</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.common import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp.training import *</span>
<span class="sd">    &gt;&gt;&gt; import sparknlp_jsl</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.base import *</span>
<span class="sd">    &gt;&gt;&gt; from sparknlp_jsl.annotator import *</span>
<span class="sd">    &gt;&gt;&gt; from pyspark.ml import Pipeline</span>
<span class="sd">    &gt;&gt;&gt; documenter = DocumentAssembler()\</span>
<span class="sd">    ...     .setInputCol(&quot;text&quot;)\</span>
<span class="sd">    ...     .setOutputCol(&quot;documents&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentence_detector = SentenceDetector() \</span>
<span class="sd">    ...     .setInputCols(&quot;documents&quot;) \</span>
<span class="sd">    ...     .setOutputCol(&quot;sentences&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = Tokenizer() \</span>
<span class="sd">    ...     .setInputCols(&quot;sentences&quot;) \</span>
<span class="sd">    ...     .setOutputCol(&quot;tokens&quot;)</span>
<span class="sd">    &gt;&gt;&gt; embeddings = WordEmbeddingsModel() \</span>
<span class="sd">    ...     .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\</span>
<span class="sd">    ...     .setInputCols([&quot;sentences&quot;, &quot;tokens&quot;])\</span>
<span class="sd">    ...     .setOutputCol(&quot;embeddings&quot;)</span>
<span class="sd">    &gt;&gt;&gt; ner_model = MedicalNerModel()\</span>
<span class="sd">    ...     .pretrained(&quot;ner_posology_large&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\</span>
<span class="sd">    ...     .setInputCols([&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;])\</span>
<span class="sd">    ...     .setOutputCol(&quot;ner&quot;)</span>
<span class="sd">    &gt;&gt;&gt; ner_converter = NerConverterInternal()\</span>
<span class="sd">    ...     .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;ner&quot;)\</span>
<span class="sd">    ...     .setOutputCol(&quot;ner_chunks&quot;)</span>
<span class="sd">    &gt;&gt;&gt; chunkerMapperapproach = ChunkMapperModel()\</span>
<span class="sd">    ...    .pretrained()\</span>
<span class="sd">    ...    .setInputCols([&quot;ner_chunk&quot;])\</span>
<span class="sd">    ...    .setOutputCol(&quot;mappings&quot;)\</span>
<span class="sd">    ...    .setRels([&quot;action&quot;]) \</span>
<span class="sd">    &gt;&gt;&gt; sampleData = &quot;The patient was given Warfarina Lusa and amlodipine 10 MG.&quot;</span>
<span class="sd">    &gt;&gt;&gt; pipeline = Pipeline().setStages([</span>
<span class="sd">    ...     documenter,</span>
<span class="sd">    ...     sentence_detector,</span>
<span class="sd">    ...     tokenizer,</span>
<span class="sd">    ...     embeddings,</span>
<span class="sd">    ...     ner_model,</span>
<span class="sd">    ...     ner_converter])</span>
<span class="sd">    &gt;&gt;&gt; results = pipeline.fit(data).transform(data)</span>
<span class="sd">    &gt;&gt;&gt; results = results \</span>
<span class="sd">    ...     .selectExpr(&quot;explode(drug_chunk_embeddings) AS drug_chunk&quot;) \</span>
<span class="sd">    ...     .selectExpr(&quot;drug_chunk.result&quot;, &quot;slice(drug_chunk.embeddings, 1, 5) AS drug_embedding&quot;) \</span>
<span class="sd">    ...     .cache()</span>
<span class="sd">    &gt;&gt;&gt; results.show(truncate=False)</span>
<span class="sd">+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">|mappings                                                                                                                                                                                                                                                                                                                                                                                               |</span>
<span class="sd">+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">|[{labeled_dependency, 22, 35, Analgesic, {chunk -&gt; 0, relation -&gt; action, confidence -&gt; 0.56995, all_relations -&gt; Antipyretic, entity -&gt; Warfarina Lusa, sentence -&gt; 0}, []}, {labeled_dependency, 41, 50, NONE, {entity -&gt; amlodipine, sentence -&gt; 0, chunk -&gt; 1, confidence -&gt; 0.9989}, []}, {labeled_dependency, 55, 56, NONE, {entity -&gt; MG, sentence -&gt; 0, chunk -&gt; 2, confidence -&gt; 0.9123}, []}]|</span>
<span class="sd">+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="sd">&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ChunkMapperModel&quot;</span>

    <span class="n">dictionary</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                       <span class="s2">&quot;dictionary&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Dictionary with the relations of the model&quot;</span><span class="p">,</span>
                       <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

    <span class="n">rel</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                <span class="s2">&quot;rel&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Relation for the model&quot;</span><span class="p">,</span>
                <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">lowerCase</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                      <span class="s2">&quot;lowerCase&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Set if we want to save the dictionary in lower case or not&quot;</span><span class="p">,</span>
                      <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">allowMultiTokenChunk</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                 <span class="s2">&quot;allowMultiTokenChunk&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;Whether  if we skyp relations with multitokens&quot;</span><span class="p">,</span>
                                 <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">multivaluesRelations</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                 <span class="s2">&quot;multivaluesRelations&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;Whether  if we skyp relations with multitokens&quot;</span><span class="p">,</span>
                                 <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">rels</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                    <span class="s2">&quot;rels&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Relations to be mappen in the dictionary&quot;</span><span class="p">,</span>
                    <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">setRel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">rel</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setRels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">rels</span><span class="o">=</span><span class="n">rs</span><span class="p">)</span>

<div class="viewcode-block" id="ChunkMapperModel.setLowerCase"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMapperModel.html#sparknlp_jsl.annotator.ChunkMapperModel.setLowerCase">[docs]</a>    <span class="k">def</span> <span class="nf">setLowerCase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set if we want to save the keys of the dictionary in lower case or not</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lc : bool</span>
<span class="sd">            Parameter that select if you want to use the keys in lower case or not</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">lowerCase</span><span class="o">=</span><span class="n">lc</span><span class="p">)</span></div>

<div class="viewcode-block" id="ChunkMapperModel.setAllowMultiTokenChunk"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMapperModel.html#sparknlp_jsl.annotator.ChunkMapperModel.setAllowMultiTokenChunk">[docs]</a>    <span class="k">def</span> <span class="nf">setAllowMultiTokenChunk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Whether  to decide if we want to send multi-chunk tokens or only single token chunks</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mc : bool</span>
<span class="sd">            &quot;Whether  to decide if we want to send multi-chunk tokens or only single token chunks</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">allowMultiTokenChunk</span><span class="o">=</span><span class="n">mc</span><span class="p">)</span></div>

<div class="viewcode-block" id="ChunkMapperModel.setMultivaluesRelations"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMapperModel.html#sparknlp_jsl.annotator.ChunkMapperModel.setMultivaluesRelations">[docs]</a>    <span class="k">def</span> <span class="nf">setMultivaluesRelations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Whether  to decide if we want to send multi-chunk tokens or only single token chunks</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">         mc : bool</span>
<span class="sd">             &quot;Whether  to decide if we want to send multi-chunk tokens or only single token chunks</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">multivaluesRelations</span><span class="o">=</span><span class="n">mc</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.chunker.ChunkMapperModel&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ChunkMapperModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>

<div class="viewcode-block" id="ChunkMapperModel.pretrained"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMapperModel.html#sparknlp_jsl.annotator.ChunkMapperModel.pretrained">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="s2">&quot;clinical/models&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Downloads and loads a pretrained model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str, optional</span>
<span class="sd">            Name of the pretrained model.</span>
<span class="sd">        lang : str, optional</span>
<span class="sd">            Language of the pretrained model, by default &quot;en&quot;</span>
<span class="sd">        remote_loc : str, optional</span>
<span class="sd">            Optional remote address of the resource, by default None. Will use</span>
<span class="sd">            Spark NLPs repositories otherwise.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ChunkMapperModel</span>
<span class="sd">            The restored model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.pretrained</span> <span class="kn">import</span> <span class="n">InternalResourceDownloader</span>
        <span class="k">return</span> <span class="n">InternalResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">ChunkMapperModel</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                        <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="ChunkMapperFiltererModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ChunkMapperFiltererModel.html#sparknlp_jsl.annotator.ChunkMapperFiltererModel">[docs]</a><span class="k">class</span> <span class="nc">ChunkMapperFiltererModel</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter what kind of chunks must be returned, whether the chunks that are in the label dependencies or not.</span>

<span class="sd">        ==============================   =======================</span>
<span class="sd">            Input Annotation types        Output Annotation type</span>
<span class="sd">        ==============================   =======================</span>
<span class="sd">        ``CHUNK``,``LABEL_DEPENDENCY``          ``CHUNK``</span>
<span class="sd">        ==============================   =======================</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        setReturnCriteria</span>
<span class="sd">            Select what kind o chunk we will return. If is fail will return the chunk that are no in the label dependencies if is success return the labels that are label dependencies</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ChunkMapperFiltererModel&quot;</span>

    <span class="n">returnCriteria</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                <span class="s2">&quot;returnCriteria&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Select what kind o chunk we will return. If is fail will return the chunk that are no in the label depencies if is success return the labels that are label dependencies&quot;</span><span class="p">,</span>
                <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setReturnCriteria</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rc</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">returnCriteria</span><span class="o">=</span><span class="n">rc</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.chunker.ChunkMapperFilterer&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ChunkMapperFiltererModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span></div>



<div class="viewcode-block" id="ResolverMerger"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ResolverMerger.html#sparknlp_jsl.annotator.ResolverMerger">[docs]</a><span class="k">class</span> <span class="nc">ResolverMerger</span><span class="p">(</span><span class="n">AnnotatorModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merge Label dependencies entities and the Sentence enitity resolver returning the sentence entity resolver.</span>

<span class="sd">        ===============================  =======================</span>
<span class="sd">        Input Annotation types            Output Annotation type</span>
<span class="sd">        ===============================  =======================</span>
<span class="sd">        ``ENTITY``,``LABEL_DEPENDENCY``  ``ENTITY``</span>
<span class="sd">        ===============================  =======================</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ResolverMerger&quot;</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.resolution.ResolverMerger&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ResolverMerger</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ZeroShotRelationExtractionModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ZeroShotRelationExtractionModel.html#sparknlp_jsl.annotator.ZeroShotRelationExtractionModel">[docs]</a><span class="k">class</span> <span class="nc">ZeroShotRelationExtractionModel</span><span class="p">(</span><span class="n">MedicalBertForSequenceClassification</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ZeroShotRelationExtractionModel implements zero shot binary relations extraction by utilizing BERT transformer</span>
<span class="sd">    models trained on the NLI (Natural Language Inference) task. The model inputs consists of documents/sentences and</span>
<span class="sd">    paired NER chunks, usually obtained by RENerChunksFilter. The definitions of relations which are extracted is given</span>
<span class="sd">    by a dictionary structures, specifying a set of statements regarding the relationship of named entities. These</span>
<span class="sd">    statements are automatically appended to each document in the dataset and the NLI model is used to determine</span>
<span class="sd">     whether a particular relationship between entities.</span>

<span class="sd">    ==========================================  ======================</span>
<span class="sd">    Input Annotation types                      Output Annotation type</span>
<span class="sd">    ==========================================  ======================</span>
<span class="sd">    ``CHUNK, DOCUMENT``                         ``CATEGORY``</span>
<span class="sd">    ==========================================  ======================</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    relationalCategories</span>
<span class="sd">        A dictionary with definitions of relational categories. The keys of dictionary are the relation labels and the</span>
<span class="sd">        values are lists of hypothesis templates. For example:</span>
<span class="sd">              {&quot;CURE&quot;: [</span>
<span class="sd">                    &quot;{{TREATMENT, DRUG}} cures {{PROBLEM}}.&quot;</span>
<span class="sd">                    ],</span>
<span class="sd">                &quot;IMPROVE&quot;: [</span>
<span class="sd">                    &quot;{{TREATMENT}} improves {{PROBLEM}}.&quot;,</span>
<span class="sd">                    &quot;{{TREATMENT}} cures {{PROBLEM}}.&quot;</span>
<span class="sd">                    ]}</span>
<span class="sd">    predictionThreshold</span>
<span class="sd">        Minimal confidence score to encode a relation (Default: 0.5f)</span>
<span class="sd">    multiLabel</span>
<span class="sd">        Whether or not a pair of entities can be categorized by multiple relations (Default: False)</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; documentAssembler = DocumentAssembler()</span>
<span class="sd">    &gt;&gt;&gt; documenter = sparknlp.DocumentAssembler() \</span>
<span class="sd">    ...     .setInputCol(&quot;text&quot;) \</span>
<span class="sd">    ...     .setOutputCol(&quot;document&quot;)</span>
<span class="sd">    &gt;&gt;&gt; tokenizer = sparknlp.annotators.Tokenizer() \</span>
<span class="sd">    ...     .setInputCols([&quot;document&quot;]) \</span>
<span class="sd">    ...     .setOutputCol(&quot;tokens&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sentencer = sparknlp.annotators.SentenceDetector()\</span>
<span class="sd">    ...     .setInputCols([&quot;document&quot;])\</span>
<span class="sd">    ...     .setOutputCol(&quot;sentences&quot;)</span>
<span class="sd">    &gt;&gt;&gt; words_embedder = sparknlp.annotators.WordEmbeddingsModel() \</span>
<span class="sd">    ...     .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \</span>
<span class="sd">    ...     .setInputCols([&quot;sentences&quot;, &quot;tokens&quot;]) \</span>
<span class="sd">    ...     .setOutputCol(&quot;embeddings&quot;)</span>
<span class="sd">    &gt;&gt;&gt; pos_tagger = sparknlp.annotators.PerceptronModel() \</span>
<span class="sd">    ...     .pretrained(&quot;pos_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \</span>
<span class="sd">    ...     .setInputCols([&quot;sentences&quot;, &quot;tokens&quot;]) \</span>
<span class="sd">    ...     .setOutputCol(&quot;pos_tags&quot;)</span>
<span class="sd">    &gt;&gt;&gt; ner_tagger = MedicalNerModel() \</span>
<span class="sd">    ...     .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) \</span>
<span class="sd">    ...     .setInputCols([&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;]) \</span>
<span class="sd">    ...     .setOutputCol(&quot;ner_tags&quot;)</span>
<span class="sd">    &gt;&gt;&gt; ner_converter = sparknlp.annotators.NerConverter() \</span>
<span class="sd">    ...     .setInputCols([&quot;sentences&quot;, &quot;tokens&quot;, &quot;ner_tags&quot;]) \</span>
<span class="sd">    ...     .setOutputCol(&quot;ner_chunks&quot;)</span>
<span class="sd">    &gt;&gt;&gt; dependency_parser = sparknlp.annotators.DependencyParserModel() \</span>
<span class="sd">    ...     .pretrained(&quot;dependency_conllu&quot;, &quot;en&quot;) \</span>
<span class="sd">    ...     .setInputCols([&quot;document&quot;, &quot;pos_tags&quot;, &quot;tokens&quot;]) \</span>
<span class="sd">    ...     .setOutputCol(&quot;dependencies&quot;)</span>
<span class="sd">    &gt;&gt;&gt; re_ner_chunk_filter = RENerChunksFilter() \</span>
<span class="sd">    ...     .setRelationPairs([&quot;problem-test&quot;,&quot;problem-treatment&quot;]) \</span>
<span class="sd">    ...     .setMaxSyntacticDistance(4)\</span>
<span class="sd">    ...     .setDocLevelRelations(False)\</span>
<span class="sd">    ...     .setInputCols([&quot;ner_chunks&quot;, &quot;dependencies&quot;]) \</span>
<span class="sd">    ...     .setOutputCol(&quot;re_ner_chunks&quot;)</span>
<span class="sd">    &gt;&gt;&gt; re_model = ZeroShotRelationExtractionModel \</span>
<span class="sd">    ...     .load(&quot;/tmp/spark_sbert_zero_shot&quot;) \</span>
<span class="sd">    ...     .setRelationalCategories({</span>
<span class="sd">    ...         &quot;CURE&quot;: [&quot;{{TREATMENT}} cures {{PROBLEM}}.&quot;],</span>
<span class="sd">    ...         &quot;IMPROVE&quot;: [&quot;{{TREATMENT}} improves {{PROBLEM}}.&quot;, &quot;{{TREATMENT}} cures {{PROBLEM}}.&quot;],</span>
<span class="sd">    ...         &quot;REVEAL&quot;: [&quot;{{TEST}} reveals {{PROBLEM}}.&quot;]})\</span>
<span class="sd">    ...     .setMultiLabel(False)\</span>
<span class="sd">    ...     .setInputCols([&quot;re_ner_chunks&quot;, &quot;sentences&quot;]) \</span>
<span class="sd">    ...     .setOutputCol(&quot;relations&quot;)</span>
<span class="sd">    &gt;&gt;&gt; data = spark.createDataFrame(</span>
<span class="sd">    ...     [[&quot;Paracetamol can alleviate headache or sickness. An MRI test can be used to find cancer.&quot;]]</span>
<span class="sd">    ...     ).toDF(&quot;text&quot;)</span>
<span class="sd">    &gt;&gt;&gt; results = sparknlp.base.Pipeline() \</span>
<span class="sd">    ...     .setStages([documenter, tokenizer, sentencer, words_embedder, pos_tagger, ner_tagger, ner_converter,</span>
<span class="sd">    ...         dependency_parser, re_ner_chunk_filter, re_model]) \</span>
<span class="sd">    ...     .fit(data) \</span>
<span class="sd">    ...     .transform(data) \</span>
<span class="sd">    &gt;&gt;&gt; results\</span>
<span class="sd">    ...     .selectExpr(&quot;explode(relations) as relation&quot;)\</span>
<span class="sd">    ...     .selectExpr(&quot;relation.result&quot;, &quot;relation.metadata.confidence&quot;)\</span>
<span class="sd">    ...     .show(truncate=False)</span>
<span class="sd">+-------+----------+</span>
<span class="sd">|result |confidence|</span>
<span class="sd">+-------+----------+</span>
<span class="sd">|REVEAL |0.9760039 |</span>
<span class="sd">|IMPROVE|0.98819494|</span>
<span class="sd">|IMPROVE|0.9929625 |</span>
<span class="sd">+-------+----------+</span>
<span class="sd">&quot;&quot;&quot;</span>
    <span class="n">relationalCategories</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                 <span class="s2">&quot;relationalCategories&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;Definitions of relational categories&quot;</span><span class="p">,</span>
                                 <span class="n">TypeConverters</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>

    <span class="n">predictionThreshold</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                                <span class="s2">&quot;predictionThreshold&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;Minimal confidence score to encode a relation (Default: 0.5f)&quot;</span><span class="p">,</span>
                                <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toFloat</span><span class="p">)</span>

    <span class="n">multiLabel</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                       <span class="s2">&quot;multiLabel&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Whether or not a pair of entities can be categorized by multiple relations (Default: False)&quot;</span><span class="p">,</span>
                       <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

<div class="viewcode-block" id="ZeroShotRelationExtractionModel.setRelationalCategories"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ZeroShotRelationExtractionModel.html#sparknlp_jsl.annotator.ZeroShotRelationExtractionModel.setRelationalCategories">[docs]</a>    <span class="k">def</span> <span class="nf">setRelationalCategories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">categories</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set definitions of relational categories</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        categories : dict[str, list[str]]</span>
<span class="sd">            xxx</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="n">categories</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">RelationalCategories</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">relationalCategories</span><span class="o">=</span><span class="n">RelationalCategories</span><span class="p">(</span><span class="n">categories</span><span class="p">))</span></div>

    <span class="nd">@keyword_only</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="s2">&quot;com.johnsnowlabs.nlp.annotators.re.ZeroShotRelationExtractionModel&quot;</span><span class="p">,</span> <span class="n">java_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ZeroShotRelationExtractionModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">classname</span><span class="o">=</span><span class="n">classname</span><span class="p">,</span>
            <span class="n">java_model</span><span class="o">=</span><span class="n">java_model</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span>
            <span class="n">predictionThreshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">multiLabel</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

<div class="viewcode-block" id="ZeroShotRelationExtractionModel.pretrained"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ZeroShotRelationExtractionModel.html#sparknlp_jsl.annotator.ZeroShotRelationExtractionModel.pretrained">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pretrained</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">remote_loc</span><span class="o">=</span><span class="s2">&quot;clinical/models&quot;</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.pretrained</span> <span class="kn">import</span> <span class="n">InternalResourceDownloader</span>
        <span class="k">return</span> <span class="n">InternalResourceDownloader</span><span class="o">.</span><span class="n">downloadModel</span><span class="p">(</span><span class="n">ZeroShotRelationExtractionModel</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">remote_loc</span><span class="p">,</span>
                                                <span class="n">j_dwn</span><span class="o">=</span><span class="s1">&#39;InternalsPythonResourceDownloader&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ZeroShotRelationExtractionModel.loadSavedModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.ZeroShotRelationExtractionModel.html#sparknlp_jsl.annotator.ZeroShotRelationExtractionModel.loadSavedModel">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">loadSavedModel</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">spark_session</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Loads a locally saved model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        folder : str</span>
<span class="sd">            Folder of the saved model</span>
<span class="sd">        spark_session : pyspark.sql.SparkSession</span>
<span class="sd">            The current SparkSession</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ZeroShotRelationExtractionModel</span>
<span class="sd">            The restored model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">_ZeroShotRelationExtractionModelLoader</span>
        <span class="n">jModel</span> <span class="o">=</span> <span class="n">_ZeroShotRelationExtractionModelLoader</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">spark_session</span><span class="o">.</span><span class="n">_jsparkSession</span><span class="p">)</span><span class="o">.</span><span class="n">_java_obj</span>
        <span class="k">return</span> <span class="n">ZeroShotRelationExtractionModel</span><span class="p">(</span><span class="n">java_model</span><span class="o">=</span><span class="n">jModel</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="MedicalGraphBuilderModel"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.MedicalGraphBuilderModel.html#sparknlp_jsl.annotator.MedicalGraphBuilderModel">[docs]</a><span class="k">class</span> <span class="nc">MedicalGraphBuilderModel</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">DefaultParamsWritable</span><span class="p">,</span> <span class="n">DefaultParamsReadable</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dataset</span></div>

<div class="viewcode-block" id="TFGraphBuilder"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder">[docs]</a><span class="k">class</span> <span class="nc">TFGraphBuilder</span><span class="p">(</span><span class="n">Estimator</span><span class="p">,</span> <span class="n">DefaultParamsWritable</span><span class="p">,</span> <span class="n">DefaultParamsReadable</span><span class="p">):</span>

    <span class="n">modelName</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                        <span class="s2">&quot;modelName&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Model name&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">labelColumn</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                        <span class="s2">&quot;labelColumn&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Labels&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">inputCols</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                      <span class="s2">&quot;inputCols&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Input columns&quot;</span><span class="p">,</span>
                      <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListString</span><span class="p">)</span>

    <span class="n">graphFolder</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;graphFolder&quot;</span><span class="p">,</span> <span class="s2">&quot;Folder path that contain external graph files&quot;</span><span class="p">,</span>
                        <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">graphFile</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span> <span class="s2">&quot;graphFile&quot;</span><span class="p">,</span> <span class="s2">&quot;Graph file name. If empty, default name is generated.&quot;</span><span class="p">,</span>
                        <span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">hiddenUnitsNumber</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                              <span class="s2">&quot;hiddenUnitsNumber&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;Number of hidden units, used in AssertionDLApproach and MedicalNerAprroach&quot;</span><span class="p">,</span>
                              <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>
    <span class="n">hiddenLayers</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                              <span class="s2">&quot;hiddenLayers&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;A list of hidden layer sizes, used in RelationExtractionApproach&quot;</span><span class="p">,</span>
                              <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toListInt</span><span class="p">)</span>

    <span class="n">maxSequenceLength</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                              <span class="s2">&quot;maxSequenceLength&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;Maximal sequence length, used in AssertionDLApproach&quot;</span><span class="p">,</span>
                              <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toInt</span><span class="p">)</span>

    <span class="n">hiddenAct</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                              <span class="s2">&quot;hiddenAct&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;Activation function for hidden layers, used in RelationExtractionApproach. Possible value are: relu, sigmoid, tanh, linear&quot;</span><span class="p">,</span>
                              <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toString</span><span class="p">)</span>

    <span class="n">hiddenActL2</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                      <span class="s2">&quot;hiddenActL2&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;L2 regularization of hidden layer activations, used in RelationExtractionApproach.&quot;</span><span class="p">,</span>
                      <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">hiddenWeightsL2</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                        <span class="s2">&quot;hiddenWeightsL2&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;L2 regularization of hidden layer weights, used in RelationExtractionApproach.&quot;</span><span class="p">,</span>
                        <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>

    <span class="n">batchNorm</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">Params</span><span class="o">.</span><span class="n">_dummy</span><span class="p">(),</span>
                            <span class="s2">&quot;batchNorm&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;Batch normalization, used in RelationExtractionApproach.&quot;</span><span class="p">,</span>
                            <span class="n">typeConverter</span><span class="o">=</span><span class="n">TypeConverters</span><span class="o">.</span><span class="n">toBoolean</span><span class="p">)</span>
<div class="viewcode-block" id="TFGraphBuilder.setHiddenAct"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.setHiddenAct">[docs]</a>    <span class="k">def</span> <span class="nf">setHiddenAct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Activation function for hidden layers, used in RelationExtractionApproach.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : string</span>
<span class="sd">            Activation function for hidden layers, used in RelationExtractionApproach.</span>
<span class="sd">            Possible value are: relu, sigmoid, tanh, linear</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">hiddenAct</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.getHiddenAct"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.getHiddenAct">[docs]</a>    <span class="k">def</span> <span class="nf">getHiddenAct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Activation function for hidden layers, used in RelationExtractionApproach.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hiddenAct</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.setHiddenActL2"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.setHiddenActL2">[docs]</a>    <span class="k">def</span> <span class="nf">setHiddenActL2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;L2 regularization of hidden layer weights, used in RelationExtractionApproach</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : boolean</span>
<span class="sd">            L2 regularization of hidden layer activations, used in RelationExtractionApproach</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">hiddenActL2</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.getHiddenActL2"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.getHiddenActL2">[docs]</a>    <span class="k">def</span> <span class="nf">getHiddenActL2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;L2 regularization of hidden layer activations, used in RelationExtractionApproach&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hiddenActL2</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.setHiddenWeightsL2"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.setHiddenWeightsL2">[docs]</a>    <span class="k">def</span> <span class="nf">setHiddenWeightsL2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;L2 regularization of hidden layer weights, used in RelationExtractionApproach</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : boolean</span>
<span class="sd">            L2 regularization of hidden layer weights, used in RelationExtractionApproach</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">hiddenWeightsL2</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.getHiddenWeightsL2"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.getHiddenWeightsL2">[docs]</a>    <span class="k">def</span> <span class="nf">getHiddenWeightsL2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;L2 regularization of hidden layer weights, used in RelationExtractionApproach&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hiddenWeightsL2</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.setBatchNorm"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.setBatchNorm">[docs]</a>    <span class="k">def</span> <span class="nf">setBatchNorm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Batch normalization, used in RelationExtractionApproach.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : boolean</span>
<span class="sd">            Batch normalization for RelationExtractionApproach</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">batchNorm</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.getBatchNorm"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.getBatchNorm">[docs]</a>    <span class="k">def</span> <span class="nf">getBatchNorm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Batch normalization, used in RelationExtractionApproach.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batchNorm</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.setHiddenLayers"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.setHiddenLayers">[docs]</a>    <span class="k">def</span> <span class="nf">setHiddenLayers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A list of hidden layer sizes for RelationExtractionApproach</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *value : int</span>
<span class="sd">            A list of hidden layer sizes for RelationExtractionApproach</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">hiddenLayers</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.getHiddenLayers"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.getHiddenLayers">[docs]</a>    <span class="k">def</span> <span class="nf">getHiddenLayers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the list of hiudden layer sizes for RelationExtractionApproach.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hiddenLayers</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.setMaxSequenceLength"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.setMaxSequenceLength">[docs]</a>    <span class="k">def</span> <span class="nf">setMaxSequenceLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the maximum sequence length for AssertionDLApproach</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">            Maximum sequence length for AssertionDLApproach</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">maxSequenceLength</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.getMaxSequenceLength"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.getMaxSequenceLength">[docs]</a>    <span class="k">def</span> <span class="nf">getMaxSequenceLength</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the maximum sequence length for AssertionDLApproach.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxSequenceLength</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.setHiddenUnitsNumber"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.setHiddenUnitsNumber">[docs]</a>    <span class="k">def</span> <span class="nf">setHiddenUnitsNumber</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the number of hidden units for AssertionDLApproach and MedicalNerApproach</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">            Number of hidden units for AssertionDLApproach and MedicalNerApproach</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">hiddenUnitsNumber</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.getHiddenUnitsNumber"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.getHiddenUnitsNumber">[docs]</a>    <span class="k">def</span> <span class="nf">getHiddenUnitsNumber</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the number of hidden units for AssertionDLApproach and MedicalNerApproach.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hiddenUnitsNumber</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.setModelName"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.setModelName">[docs]</a>    <span class="k">def</span> <span class="nf">setModelName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the model name</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : str</span>
<span class="sd">            Model name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">modelName</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.getModelName"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.getModelName">[docs]</a>    <span class="k">def</span> <span class="nf">getModelName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the name of the model.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modelName</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.setLabelColumn"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.setLabelColumn">[docs]</a>    <span class="k">def</span> <span class="nf">setLabelColumn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the name of the column for data labels.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : str</span>
<span class="sd">            Column for data labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">labelColumn</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.getLabelColumn"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.getLabelColumn">[docs]</a>    <span class="k">def</span> <span class="nf">getLabelColumn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the name of the label column.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labelColumn</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.setInputCols"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.setInputCols">[docs]</a>    <span class="k">def</span> <span class="nf">setInputCols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets column names of input annotations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *value : str</span>
<span class="sd">            Input columns for the annotator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">inputCols</span><span class="o">=</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">inputCols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></div>

<div class="viewcode-block" id="TFGraphBuilder.getInputCols"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.getInputCols">[docs]</a>    <span class="k">def</span> <span class="nf">getInputCols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets current column names of input annotations.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputCols</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.setGraphFolder"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.setGraphFolder">[docs]</a>    <span class="k">def</span> <span class="nf">setGraphFolder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets folder path that contain external graph files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : srt</span>
<span class="sd">            Folder path that contain external graph files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">graphFolder</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.getGraphFolder"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.getGraphFolder">[docs]</a>    <span class="k">def</span> <span class="nf">getGraphFolder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the graph folder.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graphFolder</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.setGraphFile"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.setGraphFile">[docs]</a>    <span class="k">def</span> <span class="nf">setGraphFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the graph file name.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : srt</span>
<span class="sd">            Greaph file name. If set to &quot;auto&quot;, then the graph builder will use the model specific default graph</span>
<span class="sd">            file name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">graphFile</span><span class="o">=</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="TFGraphBuilder.getGraphFile"><a class="viewcode-back" href="../../reference/autosummary/sparknlp_jsl.annotator.TFGraphBuilder.html#sparknlp_jsl.annotator.TFGraphBuilder.getGraphFile">[docs]</a>    <span class="k">def</span> <span class="nf">getGraphFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the graph file name.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrDefault</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graphFile</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">.training</span> <span class="kn">import</span> <span class="n">tf_graph</span><span class="p">,</span> <span class="n">tf_graph_1x</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getModelName</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">model_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getModelName</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No model name specified in MedicalGraphBuilder. Use setModelName to select a model.&quot;</span><span class="p">)</span>
        <span class="n">model_names</span> <span class="o">=</span> <span class="n">tf_graph</span><span class="o">.</span><span class="n">get_models</span><span class="p">()</span>
        <span class="n">build_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s2">&quot;ner_dl&quot;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">_MedicalNerGraphBuilder</span>

            <span class="n">params_java</span> <span class="o">=</span> <span class="n">_MedicalNerGraphBuilder</span><span class="p">(</span>
                <span class="n">dataset</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">getInputCols</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">getLabelColumn</span><span class="p">())</span><span class="o">.</span><span class="n">_java_obj</span>
            <span class="n">params</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">params_java</span><span class="o">.</span><span class="n">toString</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)))</span>
            <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;ntags&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;embeddings_dim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;nchars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;is_medical&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenUnitsNumber</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;lstm_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenUnitsNumber</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s2">&quot;assertion_dl&quot;</span><span class="p">:</span>
            <span class="n">labels_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLabelColumn</span><span class="p">())</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
            <span class="n">embeddings_dim</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getInputCols</span><span class="p">():</span>
                    <span class="k">if</span> <span class="s2">&quot;annotatorType&quot;</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;annotatorType&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;word_embeddings&quot;</span><span class="p">:</span>
                            <span class="n">embeddings_dim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;dimension&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">embeddings_dim</span><span class="p">:</span>
                <span class="k">raise</span><span class="p">(</span><span class="s2">&quot;Can&#39;t infer embeddings dimension.&quot;</span><span class="p">)</span>
            <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;n_classes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels_count</span>
            <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;feat_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">embeddings_dim</span>
            <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;max_seq_len&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenUnitsNumber</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;n_hidden&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenUnitsNumber</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMaxSequenceLength</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;max_seq_len&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMaxSequenceLength</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s2">&quot;relation_extraction&quot;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">sparknlp_jsl.internal</span> <span class="kn">import</span> <span class="n">_RelationExtractionGraphBuilder</span>

            <span class="n">labels_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLabelColumn</span><span class="p">())</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
            <span class="n">params_java</span> <span class="o">=</span> <span class="n">_RelationExtractionGraphBuilder</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span><span class="o">.</span><span class="n">_java_obj</span>
            <span class="n">feature_vector_dim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">params_java</span><span class="p">)</span>
            <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;input_dim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">feature_vector_dim</span>
            <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;output_dim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels_count</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenLayers</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;hidden_layers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenLayers</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenAct</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;hidden_act&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenAct</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenActL2</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;hidden_act_l2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenActL2</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenWeightsL2</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;hidden_weights_l2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenWeightsL2</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBatchNorm</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;batch_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBatchNorm</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s2">&quot;generic_classifier&quot;</span><span class="p">:</span>
            <span class="n">feature_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getInputCols</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">feature_vector_annos</span> <span class="o">=</span> <span class="n">dataset</span>\
                    <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">feature_column</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>\
                    <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">feature_column</span><span class="p">)</span>\
                    <span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="n">feature_column</span><span class="p">]</span>
                <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;input_dim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_vector_annos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">embeddings</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span><span class="p">(</span><span class="s2">&quot;Can&#39;t infer the size of the Generic Clasasier input feature vector&quot;</span><span class="p">)</span>
            <span class="n">labels_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLabelColumn</span><span class="p">())</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">())</span>
            <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;output_dim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels_count</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenLayers</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;hidden_layers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenLayers</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenAct</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;hidden_act&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenAct</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenActL2</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;hidden_act_l2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenActL2</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenWeightsL2</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;hidden_weights_l2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHiddenWeightsL2</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBatchNorm</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">build_params</span><span class="p">[</span><span class="s2">&quot;batch_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBatchNorm</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No model name specified.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">models</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model_names</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported model. Support models are: </span><span class="si">{</span><span class="n">models</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">graph_file</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGraphFile</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">graph_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGraphFile</span><span class="p">()</span>

        <span class="n">graph_folder</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGraphFolder</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">graph_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGraphFolder</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Medical Graph Builder configuration:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model name: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model_name</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Graph folder: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">graph_folder</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Graph file name: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">graph_file</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Build params: &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">build_params</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">tf_graph</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">build_params</span><span class="o">=</span><span class="n">build_params</span><span class="p">,</span> <span class="n">model_location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getGraphFolder</span><span class="p">(),</span> <span class="n">model_filename</span><span class="o">=</span><span class="n">graph_file</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Can&#39;t build the tensorflow graph with TF 2 graph factory, attempting TF 1.15 factory&quot;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">tf_graph_1x</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">build_params</span><span class="o">=</span><span class="n">build_params</span><span class="p">,</span> <span class="n">model_location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getGraphFolder</span><span class="p">())</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The tensorflow graphs can&#39;t be build.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">MedicalGraphBuilderModel</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TFGraphBuilder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDefault</span><span class="p">(</span>
            <span class="n">modelName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">labelColumn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">inputCols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">graphFolder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">graphFile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">hiddenUnitsNumber</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">hiddenLayers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">maxSequenceLength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">hiddenAct</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">hiddenActL2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">hiddenWeightsL2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">batchNorm</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">)</span></div>
</pre></div>

              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2021, John Snow Labs.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.0.1.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>